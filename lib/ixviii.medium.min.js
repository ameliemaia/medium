module.exports=function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=61)}([function(t,e,n){"use strict";function r(t,n){u=t,c=n,e.webgl2=l=c===s.WEBGL2_CONTEXT}function i(){return u}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=u.createBuffer(),i=n?u.DYNAMIC_DRAW:u.STATIC_DRAW,o=t===u.ARRAY_BUFFER?Float32Array:Uint16Array;return u.bindBuffer(t,r),u instanceof WebGL2RenderingContext?u.bufferData(t,new o(e),i,0):u.bufferData(t,new o(e),i),u.bindBuffer(t,null),r}function a(t){var e=u.createBuffer();return u instanceof WebGL2RenderingContext&&(u.bindBuffer(u.UNIFORM_BUFFER,e),u.bufferData(u.UNIFORM_BUFFER,new Float32Array(t),u.DYNAMIC_DRAW),u.bindBuffer(u.UNIFORM_BUFFER,null),e)}Object.defineProperty(e,"__esModule",{value:!0}),e.createUniformBuffer=e.createBuffer=e.webgl2=void 0,e.set=r,e.get=i;var s=n(7),u=void 0,c=void 0,l=void 0;e.webgl2=l,e.createBuffer=o,e.createUniformBuffer=a},function(t,e,n){e.glMatrix=n(5),e.mat2=n(72),e.mat2d=n(73),e.mat3=n(31),e.mat4=n(74),e.quat=n(75),e.vec2=n(76),e.vec3=n(32),e.vec4=n(33)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r(this,t),this.v=new Float32Array(3),this.set(e,n,i),this}return i(t,[{key:"set",value:function(t,e,n){return o.vec3.set(this.v,t,e,n),this}},{key:"clone",value:function(){return new t(this.v[0],this.v[1],this.v[2])}},{key:"copy",value:function(t){return o.vec3.copy(this.v,t.v),this}},{key:"add",value:function(t){return o.vec3.add(this.v,this.v,t.v),this}},{key:"subtract",value:function(t){return o.vec3.subtract(this.v,this.v,t.v),this}},{key:"subtractVectors",value:function(t,e){var n=o.vec3.create();return o.vec3.subtract(n,t.v,e.v),n}},{key:"scale",value:function(t){return o.vec3.scale(this.v,this.v,t),this}},{key:"distance",value:function(t){return o.vec3.distance(this.v,t.v)}},{key:"length",value:function(){return o.vec3.length(this.v)}},{key:"negate",value:function(){return o.vec3.negate(this.v,this.v),this}},{key:"normalize",value:function(){return o.vec3.normalize(this.v,this.v),this}},{key:"dot",value:function(t){return o.vec3.dot(this.v,t.v)}},{key:"cross",value:function(t){return o.vec3.cross(this.v,this.v,t.v),this}},{key:"crossVectors",value:function(t,e){var n=o.vec3.create();return o.vec3.cross(n,t.v,e.v),this}},{key:"lerp",value:function(t,e){return o.vec3.lerp(this.v,this.v,t.v,e),this}},{key:"equals",value:function(t){return o.vec3.equals(this.v,t.v)}},{key:"x",set:function(t){this.v[0]=t},get:function(){return this.v[0]}},{key:"y",set:function(t){this.v[1]=t},get:function(){return this.v[1]}},{key:"z",set:function(t){this.v[2]=t},get:function(){return this.v[2]}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t,e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}function i(t){var e=c.PRECISION,n=r(t,e);return n!==e&&((0,l.warn)("Capabilities:",e,"not supported, using",n,"instead."),e=n),{precision:e,maxTextures:t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),maxPrecision:n,maxVertexTextures:t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:t.getParameter(t.MAX_TEXTURE_SIZE),maxCubemapSize:t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:t.getParameter(t.MAX_VERTEX_ATTRIBS),maxVertexUniforms:t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:t.getParameter(t.MAX_VARYING_VECTORS),maxFragmentUniforms:t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS)}}function o(t){var e=u.webgl2||t.getExtension("OES_vertex_array_object")||!1;return{angleInstancedArrays:t.getExtension("ANGLE_instanced_arrays")||!1,vertexArrayObject:e,textureFloat:t.getExtension("OES_texture_float")||!1}}function a(t){e.capabilities=f=i(t),e.extensions=h=o(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.extensions=e.capabilities=void 0,e.set=a;var s=n(0),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(s),c=n(7),l=n(13),f={},h={};e.capabilities=f,e.extensions=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(0),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(s),c=n(21),l=r(c),f=n(60),h=r(f),v=n(2),d=r(v),x=n(14),g=r(x),m=void 0,p=[],y=function(){function t(e,n,r,i,a){o(this,t),m=u.get(),this.bufferVertices=e,this.bufferIndices=n,this.bufferNormals=r,this.bufferUvs=i,this.bufferColors=a,this.attributes={},this.attributesInstanced={},this.bufferVertices&&(this.addAttribute("aVertexPosition",m.ARRAY_BUFFER,this.bufferVertices,3),this.generateVertices()),this.bufferIndices&&(this.addAttribute("aIndex",m.ELEMENT_ARRAY_BUFFER,this.bufferIndices,1,!1),this.generateFaces()),this.bufferNormals&&this.addAttribute("aVertexNormal",m.ARRAY_BUFFER,this.bufferNormals,3),this.bufferUvs&&(this.addAttribute("aUv",m.ARRAY_BUFFER,this.bufferUvs,2),this.generateUvs()),this.bufferColors&&this.addAttribute("aVertexColor",m.ARRAY_BUFFER,this.bufferColors,3)}return a(t,[{key:"addAttribute",value:function(t,e,n,r,i){this.attributes[t]=new l.default(e,n,r,i)}},{key:"addInstancedBufferAttribute",value:function(t,e,n){this.attributesInstanced[t]=new l.default(m.ARRAY_BUFFER,e,n)}},{key:"generateVertices",value:function(){this.vertices=[];for(var t=0;t<this.bufferVertices.length;t+=3){var e=this.bufferVertices[t],n=this.bufferVertices[t+1],r=this.bufferVertices[t+2],i=new d.default(e,n,r);this.vertices.push(i)}}},{key:"generateFaces",value:function(){this.faces=[];for(var t=0;t<this.bufferIndices.length;t+=3){var e=this.bufferIndices[t],n=this.bufferIndices[t+1],r=this.bufferIndices[t+2],i=this.vertices[e],o=this.vertices[n],a=this.vertices[r],s=new h.default(e,n,r,i,o,a);this.faces.push(s)}}},{key:"generateUvs",value:function(){this.uvs=[];for(var t=0;t<this.bufferUvs.length;t+=2){var e=this.bufferUvs[t],n=this.bufferUvs[t+1],r=new g.default(e,n);this.uvs.push(r)}}},{key:"updateVertices",value:function(){var t=this;m=u.get(),this.vertices.forEach(function(e,n){t.bufferVertices.set(e.v,n*e.v.length)}),this.attributes.aVertexPosition.update(this.bufferVertices)}},{key:"updateNormals",value:function(){var t=[];this.faces.forEach(function(e){e.updateFaceNormal(),t[e.indices[0]]=e.normal.v,t[e.indices[1]]=e.normal.v,t[e.indices[2]]=e.normal.v}),p=[],t.forEach(function(t){var e;p=(e=p).concat.apply(e,i(t))}),this.bufferNormals.set(p),this.attributes.aVertexNormal.update(this.bufferNormals)}},{key:"dispose",value:function(){var t=this;m=u.get(),Object.keys(this.attributes).forEach(function(e){t.attributes[e].dispose(m),delete t.attributes[e]}),Object.keys(this.attributesInstanced).forEach(function(e){t.attributesInstanced[e].dispose(m),delete t.attributesInstanced[e]}),delete this.attributes,delete this.attributesInstanced,this.bufferVertices=null,this.bufferIndices=null,this.bufferNormals=null,this.bufferUvs=null,this.bufferColors=null}}]),t}();e.default=y},function(t,e){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(t){n.ARRAY_TYPE=t};var r=Math.PI/180;n.toRadian=function(t){return t*r},n.equals=function(t,e){return Math.abs(t-e)<=n.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="#version 300 es"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(e.WEBGL_CONTEXT="webgl",e.WEBGL2_CONTEXT="webgl2"),i=(e.RENDERER_DEFAULT_CONTEXT=r,e.RENDERER_DEFAULT_WIDTH=1280),o=e.RENDERER_DEFAULT_HEIGHT=720;e.RENDERER_DEFAULT_RATIO=i/o,e.PRECISION="highp",e.CULL_NONE=-1,e.CULL_BACK=1029,e.CULL_FRONT=1028,e.CULL_FRONT_AND_BACK=1032,e.DRAW_POINTS=0,e.DRAW_LINES=1,e.DRAW_LINE_STRIP=2,e.DRAW_TRIANGLES=4,e.UNIFORM_PROJECTION_VIEW_LOCATION=0,e.UNIFORM_DIRECTIONAL_LIGHTS_LOCATION=1,e.UNIFORM_SPOT_LIGHTS_LOCATION=2},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="\n\tuniform ProjectionView {\n\t\tmat4 projectionMatrix;\n\t\tmat4 viewMatrix;\n\t} uProjectionView;\n"},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},c=n(0),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(c),f=n(19),h=r(f),v=n(20),d=r(v),x=n(3),g=void 0,m=function(t){function e(t,n){i(this,e);var r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.geometry=t,r.shader=n,r.vao=new d.default,r.visible=!0,r.instanceCount=0,r.shader.program.created||r.shader.create(r.geometry),r.isInstanced=!1,g=l.get(),r.vao.bind(),r.bindAttributes(),r.bindAttributesInstanced(),r.bindIndexBuffer(),r.vao.unbind(),r}return a(e,t),s(e,[{key:"setInstanceCount",value:function(t){g=l.get(),this.instanceCount=t,this.isInstanced=!0}},{key:"bindAttributes",value:function(){var t=this;Object.keys(this.geometry.attributes).forEach(function(e){"aIndex"!==e&&(t.shader.program.setAttributeLocation(e),t.geometry.attributes[e].bind(),t.shader.program.setAttributePointer(e,t.geometry.attributes[e].itemSize))})}},{key:"bindAttributesInstanced",value:function(){var t=this;Object.keys(this.geometry.attributesInstanced).forEach(function(e){"aIndex"!==e&&(t.shader.program.setAttributeLocation(e),t.geometry.attributesInstanced[e].bind(),t.shader.program.setAttributeInstancedPointer(e,t.geometry.attributesInstanced[e].itemSize),g instanceof WebGL2RenderingContext?g.vertexAttribDivisor(t.shader.program.attributeLocations[e],1):x.extensions.angleInstancedArrays.vertexAttribDivisorANGLE(t.shader.program.attributeLocations[e],1))})}},{key:"bindIndexBuffer",value:function(){this.geometry.bufferIndices&&this.geometry.attributes.aIndex.bind()}},{key:"draw",value:function(t,e,n){this.visible&&(g=l.get(),this.updateMatrix(),this.shader.program.bind(),-1!==this.shader.culling&&(g.enable(g.CULL_FACE),g.cullFace(this.shader.culling)),this.shader.setUniforms(t,e,this.modelMatrix,n),x.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),this.geometry.attributes.aIndex?g.drawElements(this.shader.drawType,this.geometry.attributes.aIndex.numItems,g.UNSIGNED_SHORT,0):g.drawArrays(this.shader.drawType,0,this.geometry.attributes.aVertexPosition.numItems),x.extensions.vertexArrayObject&&this.vao.unbind(),-1!==this.shader.culling&&g.disable(g.CULL_FACE))}},{key:"drawInstance",value:function(t,e,n){this.visible&&(g=l.get(),this.updateMatrix(),this.shader.program.bind(),this.shader.setUniforms(t,e,this.modelMatrix,n),-1!==this.shader.culling&&(g.enable(g.CULL_FACE),g.cullFace(this.shader.culling)),x.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),g instanceof WebGL2RenderingContext?g.drawElementsInstanced(this.shader.drawType,this.geometry.attributes.aIndex.numItems,g.UNSIGNED_SHORT,0,this.instanceCount):x.extensions.angleInstancedArrays.drawElementsInstancedANGLE(this.shader.drawType,this.geometry.attributes.aIndex.numItems,g.UNSIGNED_SHORT,0,this.instanceCount),x.extensions.vertexArrayObject&&this.vao.unbind(),-1!==this.shader.culling&&g.disable(g.CULL_FACE))}},{key:"dispose",value:function(){this.shader.dispose(),this.geometry.dispose(),this.vao.dispose(),this.geometry=null,this.shader=null,u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this)}}]),e}(h.default);e.default=m},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(0),u=i(s),c=n(7),l=i(c),f=n(1),h=n(63),v=n(62),d=n(71),x=r(d),g=n(11),m=r(g),p=n(3),y=n(16),M=r(y),b=n(59),w=r(b),_=void 0,E=f.mat3.create(),P=f.mat4.create(),I=f.mat4.create(),S=function(){function t(e){o(this,t);var n=u.webgl2?h.vertexShaderEs300:h.vertexShaderEs100,r=u.webgl2?v.fragmentShaderEs300:v.fragmentShaderEs100;this.name="",this.uniforms={},this.hookVertexPre="",this.hookVertexMain="",this.hookVertexEnd="",this.hookFragmentPre="",this.hookFragmentMain="",this.hookFragmentEnd="",this.vertexShader=n,this.fragmentShader=r,this.drawType=l.DRAW_TRIANGLES,this.directionalLights=void 0,this.pointLights=void 0,this.culling=l.CULL_NONE,Object.assign(this,e),this.program=new w.default}return a(t,[{key:"create",value:function(t,e){var n=this;_=u.get(),this.vertexShader=this._processShader(this.vertexShader,"vertex",t),this.fragmentShader=this._processShader(this.fragmentShader,"fragment",t),this.program.link(this.vertexShader,this.fragmentShader,e),this.customUniforms=this.uniforms||{},u.webgl2&&this.program.setUniformBlockLocation("ProjectionView",M.default.projectionView.buffer,l.UNIFORM_PROJECTION_VIEW_LOCATION),this.directionalLights&&(u.webgl2?this.program.setUniformBlockLocation("DirectionalLights",this.directionalLights.uniformBuffer.buffer,l.UNIFORM_DIRECTIONAL_LIGHTS_LOCATION):this.directionalLights.get().forEach(function(t,e){Object.keys(t.uniforms).forEach(function(r){var i=t.uniforms[r];n.customUniforms["uDirectionalLights["+e+"]."+r]=i})})),this.pointLights&&(u.webgl2?this.program.setUniformBlockLocation("PointLights",this.pointLights.uniformBuffer.buffer,l.UNIFORM_SPOT_LIGHTS_LOCATION):this.pointLights.get().forEach(function(t,e){Object.keys(t.uniforms).forEach(function(r){var i=t.uniforms[r];n.customUniforms["uPointLights["+e+"]."+r]=i})}));var r=0;Object.keys(this.uniforms).forEach(function(t){switch(n.uniforms[t].type){case"t":case"tc":n.uniforms[t].textureIndex=r,r+=1}}),void 0===this.uniforms.uCameraPosition&&this.pointLights&&(this.uniforms.uCameraPosition={type:"3f",value:[0,0,0]});var i=u.webgl2?{}:{uProjectionMatrix:{type:"4fv",value:f.mat4.create(),location:null},uViewMatrix:{type:"4fv",value:f.mat4.create(),location:null}};this.uniforms=Object.assign({uViewMatrixInverse:{type:"4fv",value:f.mat4.create(),location:null},uModelMatrix:{type:"4fv",value:f.mat4.create(),location:null},uModelMatrixInverse:{type:"4fv",value:f.mat4.create(),location:null},uNormalMatrix:{type:"4fv",value:f.mat4.create(),location:null},uDiffuse:{type:"3f",value:(new m.default).v,location:null}},this.customUniforms,i),Object.keys(this.uniforms).forEach(function(t){n.program.setUniformLocation(n.uniforms,t)})}},{key:"_processShader",value:function(t,e,n){function r(t){i+="#define "+t+" \n"}_=u.get();var i="",o="precision "+p.capabilities.precision+" float;";return n.bufferUvs&&r("uv"),n.bufferColors&&r("vertexColors"),n.bufferNormals&&r("normals"),this.directionalLights&&r("directionalLights"),this.pointLights&&r("pointLights"),t=t.replace(/#HOOK_PRECISION/g,o),t=t.replace(/#HOOK_DEFINES/g,i),t=t.replace(/#HOOK_VERTEX_PRE/g,this.hookVertexPre),t=t.replace(/#HOOK_VERTEX_MAIN/g,this.hookVertexMain),t=t.replace(/#HOOK_VERTEX_END/g,this.hookVertexEnd),t=t.replace(/#HOOK_FRAGMENT_PRE/g,this.hookFragmentPre),t=t.replace(/#HOOK_FRAGMENT_MAIN/g,this.hookFragmentMain),t=t.replace(/#HOOK_FRAGMENT_END/g,this.hookFragmentEnd),this.pointLights&&(t=t.replace(/#HOOK_POINT_LIGHTS/g,String(this.pointLights.length))),this.directionalLights&&(t=t.replace(/#HOOK_DIRECTIONAL_LIGHTS/g,String(this.directionalLights.length))),(0,x.default)(t,e)}},{key:"setUniforms",value:function(t,e,n,r){var i=this;_=u.get(),Object.keys(this.customUniforms).forEach(function(t){var e=i.uniforms[t];switch(e.type){case"t":_.uniform1i(e.location,e.textureIndex);var n=void 0;switch(e.textureIndex){case 5:n=_.TEXTURE5;break;case 4:n=_.TEXTURE4;break;case 3:n=_.TEXTURE3;break;case 2:n=_.TEXTURE2;break;case 1:n=_.TEXTURE1;break;default:n=_.TEXTURE0}_.activeTexture(n),_.bindTexture(_.TEXTURE_2D,e.value);break;case"tc":_.uniform1i(e.location,e.textureIndex);var r=void 0;switch(e.textureIndex){case 5:r=_.TEXTURE5;break;case 4:r=_.TEXTURE4;break;case 3:r=_.TEXTURE3;break;case 2:r=_.TEXTURE2;break;case 1:r=_.TEXTURE1;break;default:r=_.TEXTURE0}_.activeTexture(r),_.bindTexture(_.TEXTURE_CUBE_MAP,e.value);break;case"i":_.uniform1i(e.location,e.value);break;case"f":_.uniform1f(e.location,e.value);break;case"2f":_.uniform2f(e.location,e.value[0],e.value[1]);break;case"3f":_.uniform3f(e.location,e.value[0],e.value[1],e.value[2]);break;case"4f":_.uniform4f(e.location,e.value[0],e.value[1],e.value[2],e.value[3]);break;case"1iv":_.uniform1iv(e.location,e.value);break;case"2iv":_.uniform2iv(e.location,e.value);break;case"1fv":_.uniform1fv(e.location,e.value);break;case"2fv":_.uniform2fv(e.location,e.value);break;case"3fv":_.uniform3fv(e.location,e.value);break;case"4fv":_.uniform4fv(e.location,e.value);break;case"Matrix3fv":_.uniformMatrix3fv(e.location,!1,e.value);break;case"Matrix4fv":_.uniformMatrix4fv(e.location,!1,e.value)}}),u.webgl2||(_.uniformMatrix4fv(this.uniforms.uProjectionMatrix.location,!1,e),_.uniformMatrix4fv(this.uniforms.uViewMatrix.location,!1,t)),f.mat4.identity(P),f.mat4.invert(P,t),_.uniformMatrix4fv(this.uniforms.uViewMatrixInverse.location,!1,P),_.uniformMatrix4fv(this.uniforms.uModelMatrix.location,!1,n),f.mat4.identity(I),f.mat4.invert(I,n),_.uniformMatrix4fv(this.uniforms.uModelMatrixInverse.location,!1,I),f.vec3.set(E,0,0,0),f.mat3.fromMat4(E,I),f.mat3.transpose(E,E),_.uniformMatrix3fv(this.uniforms.uNormalMatrix.location,!1,E),_.uniform3f(this.uniforms.uDiffuse.location,this.uniforms.uDiffuse.value[0],this.uniforms.uDiffuse.value[1],this.uniforms.uDiffuse.value[2]),r&&this.uniforms.uCameraPosition&&_.uniform3f(this.uniforms.uCameraPosition.location,r.position.v[0],r.position.v[1],r.position.v[2])}},{key:"dispose",value:function(){var t=this;Object.keys(this.customUniforms).forEach(function(e){var n=t.uniforms[e];switch(n.type){case"t":case"tc":_.deleteTexture(n.value)}}),this.program.dispose()}}]),t}();e.default=S},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16777215;return r(this,t),this.v=new Float32Array(3),this.convert(e),this}return i(t,[{key:"set",value:function(t,e,n){return o.vec3.set(this.v,t,e,n),this}},{key:"copy",value:function(t){return o.vec3.copy(this.v,t),this}},{key:"convert",value:function(t){var e="number"==typeof t?this.hexIntToRgb(t):this.hexStringToRgb(t);return o.vec3.copy(this.v,this.normalize(e)),this}},{key:"normalize",value:function(t){return o.vec3.fromValues(t[0]/255,t[1]/255,t[2]/255)}},{key:"fromArray",value:function(t){this.set(t[0],t[1],t[2])}},{key:"componentToHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"rgbToHex",value:function(t,e,n){return"#"+this.componentToHex(t)+this.componentToHex(e)+this.componentToHex(n)}},{key:"hexIntToRgb",value:function(t){var e=t>>16,n=t>>8&255,r=255&t;return o.vec3.fromValues(e,n,r)}},{key:"hexStringToRgb",value:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?o.vec3.fromValues(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)):null}},{key:"r",set:function(t){this.v[0]=t},get:function(){return this.v[0]}},{key:"g",set:function(t){this.v[1]=t},get:function(){return this.v[1]}},{key:"b",set:function(t){this.v[2]=t},get:function(){return this.v[2]}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return t*(Math.PI/180)}function o(t){return t*(180/Math.PI)}function a(t,e,n){return Math.max(Math.min(t,n),e)}function s(t,e,n){return t+(e-t)*n}function u(t,e,n,r){var i=f.vec3.create(),o=f.vec3.create(),a=f.vec3.create();f.vec3.sub(i,r,e),f.vec3.sub(o,n,e),f.vec3.sub(a,t,e);var s=f.vec3.dot(i,i),u=f.vec3.dot(i,o),c=f.vec3.dot(i,a),l=f.vec3.dot(o,o),h=f.vec3.dot(o,a),v=s*l-u*u,d=new x.default;if(0===v)return d.set(-2,-1,-1);var g=1/v,m=(l*c-u*h)*g,p=(s*h-u*c)*g;return d.set(1-m-p,p,m)}function c(t,e,n,r){var i=Math.random(),o=Math.random(),a=2*Math.PI*i,s=Math.acos(2*o-1);return[t+r*Math.sin(s)*Math.cos(a),e+r*Math.sin(s)*Math.sin(a),n+r*Math.cos(s)]}function l(t,e){var n=t.x,r=t.y,i=t.z,o=e[0]*n+e[4]*r+e[8]*i+e[12],a=e[1]*n+e[5]*r+e[9]*i+e[13],s=e[3]*n+e[7]*r+e[11]*i+e[15],u=new v.default;return u.x=(o/s+1)/2,u.y=1-(a/s+1)/2,u}Object.defineProperty(e,"__esModule",{value:!0}),e.degToRad=i,e.radToDeg=o,e.clamp=a,e.lerp=s,e.barycoordFromPoint=u,e.randomSpherePoint=c,e.from3DTo2D=l;var f=n(1),h=n(14),v=r(h),d=n(2),x=r(d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.log=function(){return window.console&&console.log?Function.prototype.bind.call(console.log,console):function(){}}(),e.clear=function(){return window.console&&console.clear?Function.prototype.bind.call(console.clear,console):function(){}}(),e.debug=function(){return window.console&&console.debug?Function.prototype.bind.call(console.debug,console):function(){}}(),e.info=function(){return window.console&&console.info?Function.prototype.bind.call(console.info,console):function(){}}(),e.warn=function(){return window.console&&console.warn?Function.prototype.bind.call(console.warn,console):function(){}}(),e.error=function(){return window.console&&console.error?Function.prototype.bind.call(console.error,console):function(){}}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r(this,t),this.v=new Float32Array(2),this.set(e,n),this}return i(t,[{key:"set",value:function(t,e){return o.vec2.set(this.v,t,e),this}},{key:"clone",value:function(){return new t(this.v[0],this.v[1])}},{key:"copy",value:function(t){return o.vec2.copy(this.v,t.v),this}},{key:"add",value:function(t){return o.vec2.add(this.v,this.v,t.v),this}},{key:"subtract",value:function(t){return o.vec2.subtract(this.v,this.v,t.v),this}},{key:"subtractVectors",value:function(t,e){var n=o.vec2.create();return o.vec2.subtract(n,t.v,e.v),n}},{key:"scale",value:function(t){return o.vec2.scale(this.v,this.v,t),this}},{key:"distance",value:function(t){return o.vec2.distance(this.v,t.v)}},{key:"length",value:function(){return o.vec2.length(this.v)}},{key:"negate",value:function(){return o.vec2.negate(this.v,this.v),this}},{key:"normalize",value:function(){return o.vec2.normalize(this.v,this.v),this}},{key:"lerp",value:function(t,e){return o.vec2.lerp(this.v,this.v,t.v,e),this}},{key:"equals",value:function(t){return o.vec2.equals(this.v,t.v)}},{key:"x",set:function(t){this.v[0]=t},get:function(){return this.v[0]}},{key:"y",set:function(t){this.v[1]=t},get:function(){return this.v[1]}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function t(e,n,i){r(this,t),this.width=e,this.height=n,this.data=i};e.default=i},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function i(){var t=new Float32Array([].concat(r(a.mat4.create()),r(a.mat4.create())));c.projectionView=new u.default(t)}function o(t,e,n){t.bindBufferBase(t.UNIFORM_BUFFER,0,c.projectionView.buffer),t.bindBuffer(t.UNIFORM_BUFFER,c.projectionView.buffer),l=[].concat(r(e),r(n)),c.projectionView.data.set(l,0),t.bufferSubData(t.UNIFORM_BUFFER,0,c.projectionView.data),t.bindBuffer(t.UNIFORM_BUFFER,null)}Object.defineProperty(e,"__esModule",{value:!0}),e.setup=i,e.updateProjectionView=o;var a=n(1),s=n(24),u=function(t){return t&&t.__esModule?t:{default:t}}(s),c={},l=void 0;e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="\n\tstruct PointLight {\n\t\tvec4 position;\n\t\tvec4 color;\n\t\tvec4 specularColor;\n\t\tvec4 shininess;\n\t\tvec4 intensity;\n\t};\n\tuniform PointLights {\n\t\tPointLight uPointLights[#HOOK_POINT_LIGHTS];\n\t};\n";e.pointLightsOutEs300="\n\t"+r+"\n\tout vec3 vPointLightSurfaceToLightDirection[#HOOK_POINT_LIGHTS];\n\tout vec3 vPointLightSurfaceToCameraDirection[#HOOK_POINT_LIGHTS];\n",e.pointLightsInEs300="\n\t"+r+"\n\tin vec3 vPointLightSurfaceToLightDirection[#HOOK_POINT_LIGHTS];\n\tin vec3 vPointLightSurfaceToCameraDirection[#HOOK_POINT_LIGHTS];\n",e.pointLightsEs100="\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tvec3 specularColor;\n\t\tfloat shininess;\n\t\tfloat intensity;\n\t};\n\tuniform PointLight uPointLights[#HOOK_POINT_LIGHTS];\n\tvarying vec3 vPointLightSurfaceToLightDirection[#HOOK_POINT_LIGHTS];\n\tvarying vec3 vPointLightSurfaceToCameraDirection[#HOOK_POINT_LIGHTS];\n"},function(t,e,n){!function(e,n){t.exports=n()}(0,function(){"use strict";function t(e){var n=this instanceof t;if(e){if(n)throw new Error("You can't pass a target when instantiating with the `new` keyword");for(var r in t.prototype)e[r]=t.prototype[r]}else if(!n)return new t}function e(t){if(!(t&&t instanceof Function))throw new Error(t+" is not a Function")}return t.prototype.__init=function(t){var e=this.__listeners||(this.__listeners=[]);return e[t]||(e[t]=[])},t.prototype.on=function(t,n){e(n),this.__init(t).push(n)},t.prototype.off=function(t,e){var n=this.__init(t);n.splice(n.indexOf(e),1)},t.prototype.once=function(t,n){e(n);var r=this,i=function(){r.off(t,i),n.apply(this,arguments)};this.on(t,i)},t.prototype.emit=function(t){var e,n=this.__init(t).slice(0);for(e in n)n[e].apply(this,[].slice.call(arguments,1))},t})},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=n(2),s=function(t){return t&&t.__esModule?t:{default:t}}(a),u=0,c=o.vec3.create(),l=function(){function t(){r(this,t),this.children=[],this.localMatrix=o.mat4.create(),this.modelMatrix=o.mat4.create(),this.position=new s.default,this.rotation=new s.default,this.scale=new s.default(1,1,1),this._quaternion=o.quat.create(),this.isObject3D=!0}return i(t,[{key:"updateMatrix",value:function(){o.mat4.identity(this.localMatrix),o.mat4.identity(this.modelMatrix),o.quat.identity(this._quaternion),this.parent&&(o.mat4.copy(this.localMatrix,this.parent.modelMatrix),o.mat4.multiply(this.modelMatrix,this.modelMatrix,this.localMatrix)),o.mat4.translate(this.modelMatrix,this.modelMatrix,this.position.v),o.quat.rotateX(this._quaternion,this._quaternion,this.rotation.x),o.quat.rotateY(this._quaternion,this._quaternion,this.rotation.y),o.quat.rotateZ(this._quaternion,this._quaternion,this.rotation.z),u=o.quat.getAxisAngle(c,this._quaternion),o.mat4.rotate(this.modelMatrix,this.modelMatrix,u,c),o.mat4.scale(this.modelMatrix,this.modelMatrix,this.scale.v)}},{key:"setParent",value:function(t){this.unParent(),t.isObject3D&&(t.children.push(this),this.parent=t)}},{key:"unParent",value:function(){if(void 0!==this.parent){var t=this.parent.children.indexOf(this);-1!==t&&(this.parent.children.splice(t,1),this.parent=null)}}},{key:"dispose",value:function(){this.unParent(),this.children=[],this.localMatrix=null,this.modelMatrix=null,this.position=null,this.rotation=null,this.scale=null,this._quaternion=null,this.isObject3D=null}}]),t}();e.default=l},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o),s=n(3),u=void 0,c=function(){function t(){r(this,t),u=a.get(),u instanceof WebGL2RenderingContext?this.vao=u.createVertexArray():s.extensions.vertexArrayObject&&(this.vao=s.extensions.vertexArrayObject.createVertexArrayOES())}return i(t,[{key:"bind",value:function(){u instanceof WebGL2RenderingContext?u.bindVertexArray(this.vao):s.extensions.vertexArrayObject&&s.extensions.vertexArrayObject.bindVertexArrayOES(this.vao)}},{key:"unbind",value:function(){u instanceof WebGL2RenderingContext?u.bindVertexArray(null):s.extensions.vertexArrayObject&&s.extensions.vertexArrayObject.bindVertexArrayOES(null)}},{key:"dispose",value:function(){u instanceof WebGL2RenderingContext?u.deleteVertexArray(this.vao):s.extensions.vertexArrayObject&&s.extensions.vertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null}}]),t}();e.default=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o),s=void 0,u=function(){function t(e,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];r(this,t),this.type=e,this.itemSize=i,this.numItems=n.length/i,this.buffer=a.createBuffer(e,n),this.shaderAttribute=o}return i(t,[{key:"bind",value:function(){s=a.get(),s.bindBuffer(this.type,this.buffer)}},{key:"unbind",value:function(){s=a.get(),s.bindBuffer(this.type,null)}},{key:"update",value:function(t){this.bind(),s=a.get(),s.bufferSubData(this.type,0,t),this.unbind()}},{key:"dispose",value:function(){s=a.get(),s.deleteBuffer(this.buffer),this.buffer=null}}]),t}();e.default=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(2),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s=n(1),u=s.vec3.create(),c=s.vec3.create(),l=s.vec3.create(),f=s.vec3.create(),h=function(){function t(){r(this,t),this.origin=new a.default,this.direction=new a.default}return i(t,[{key:"set",value:function(t,e){this.origin.copy(t),this.direction.copy(e)}},{key:"intersectTriangle",value:function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];s.vec3.sub(c,e.v,t.v),s.vec3.sub(l,n.v,t.v),s.vec3.cross(f,c,l);var i=s.vec3.dot(this.direction.v,f),o=void 0;if(i>0){if(r)return null;o=1}else{if(!(i<0))return null;o=-1,i=-i}s.vec3.sub(u,this.origin.v,t.v),s.vec3.cross(l,u,l);var h=o*s.vec3.dot(this.direction.v,l);if(h<0)return null;s.vec3.cross(c,c,u);var v=o*s.vec3.dot(this.direction.v,c);if(v<0)return null;if(h+v>i)return null;var d=-o*s.vec3.dot(u,f);if(d<0)return null;var x=new a.default;return x.copy(this.direction).scale(d/i).add(this.origin),x}}]),t}();e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){try{var t=WebGLRenderingContext,e=document.createElement("canvas"),n=document.createElement("canvas"),r=n.getContext("webgl2"),i=e.getContext("webgl")||e.getContext("experimental-webgl");return void 0!==t&&{webgl:!!i,webgl2:!!r}}catch(t){return!1}}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),a=function(){function t(e){r(this,t),this.data=e,this.buffer=(0,o.createUniformBuffer)(e)}return i(t,[{key:"setValues",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.data.set(t,e)}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(){r(this,t)}return i(t,[{key:"update",value:function(){}},{key:"setValues",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.data.set(t,e)}}]),t}();e.default=o},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return new Promise(function(e,n){var r=new XMLHttpRequest;r.responseType="arraybuffer",r.onreadystatechange=function(){if(4===r.readyState)if(4===r.readyState&&200===r.status){var t=(0,a.default)(r.response),i=new u.default(t.shape[0],t.shape[1],t.data);e(i)}else n(r.status)},r.open("GET",t,!0),r.send()})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var o=n(78),a=r(o),s=n(15),u=r(s)},function(t,e,n){"use strict";function r(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){e(r)},r.onerror=function(){n("Failed to load "+t)},r.src=t})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=e.whenEquals="\nfloat whenEquals(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n};\n",i=e.whenEqualsInt="\nint whenEqualsInt(int x, int y) {\n  return 1 - abs(sign(x - y));\n}\n",o=e.whenLessThan="\nfloat whenLessThan(float x, float y) {\n  return max(sign(y - x), 0.0);\n}\n",a=e.whenGreaterThan="\nfloat whenGreaterThan(float x, float y) {\n  return max(sign(x - y), 0.0);\n}\n";e.default={whenEquals:r,whenEqualsInt:i,whenLessThan:o,whenGreaterThan:a}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.directionalLightsEs300="\n\tstruct DirectionalLight {\n\t\tvec4 position;\n\t\tvec4 color;\n\t\tvec4 intensity;\n\t};\n\tuniform DirectionalLights {\n\t\tDirectionalLight uDirectionalLights[#HOOK_DIRECTIONAL_LIGHTS];\n\t};\n",e.directionalLightsEs100="\n\tstruct DirectionalLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat intensity;\n\t};\n\tuniform DirectionalLight uDirectionalLights[#HOOK_DIRECTIONAL_LIGHTS];\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=e.definePI="\n#define PI 3.141592653589793\n",i=e.definePITwo="\n#define TWO_PI 6.283185307179586\n",o=e.mapLinear="\nfloat mapLinear(float value, float in_min, float in_max, float out_min, float out_max) {\n\treturn (value - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n}\n";e.default={definePI:r,definePITwo:i,mapLinear:o}},function(t,e,n){var r=n(5),i={};i.create=function(){var t=new r.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},i.clone=function(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.fromValues=function(t,e,n,i,o,a,s,u,c){var l=new r.ARRAY_TYPE(9);return l[0]=t,l[1]=e,l[2]=n,l[3]=i,l[4]=o,l[5]=a,l[6]=s,l[7]=u,l[8]=c,l},i.set=function(t,e,n,r,i,o,a,s,u,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=l*a-s*c,h=-l*o+s*u,v=c*o-a*u,d=n*f+r*h+i*v;return d?(d=1/d,t[0]=f*d,t[1]=(-l*r+i*c)*d,t[2]=(s*r-i*a)*d,t[3]=h*d,t[4]=(l*n-i*u)*d,t[5]=(-s*n+i*o)*d,t[6]=v*d,t[7]=(-c*n+r*u)*d,t[8]=(a*n-r*o)*d,t):null},i.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8];return t[0]=a*l-s*c,t[1]=i*c-r*l,t[2]=r*s-i*a,t[3]=s*u-o*l,t[4]=n*l-i*u,t[5]=i*o-n*s,t[6]=o*c-a*u,t[7]=r*u-n*c,t[8]=n*a-r*o,t},i.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],v=n[1],d=n[2],x=n[3],g=n[4],m=n[5],p=n[6],y=n[7],M=n[8];return t[0]=h*r+v*a+d*c,t[1]=h*i+v*s+d*l,t[2]=h*o+v*u+d*f,t[3]=x*r+g*a+m*c,t[4]=x*i+g*s+m*l,t[5]=x*o+g*u+m*f,t[6]=p*r+y*a+M*c,t[7]=p*i+y*s+M*l,t[8]=p*o+y*u+M*f,t},i.mul=i.multiply,i.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],v=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=h*r+v*a+c,t[7]=h*i+v*s+l,t[8]=h*o+v*u+f,t},i.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=Math.sin(n),v=Math.cos(n);return t[0]=v*r+h*a,t[1]=v*i+h*s,t[2]=v*o+h*u,t[3]=v*a-h*r,t[4]=v*s-h*i,t[5]=v*u-h*o,t[6]=c,t[7]=l,t[8]=f,t},i.scale=function(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},i.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},i.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,v=i*s,d=i*u,x=o*a,g=o*s,m=o*u;return t[0]=1-f-d,t[3]=l-m,t[6]=h+g,t[1]=l+m,t[4]=1-c-d,t[7]=v-x,t[2]=h-g,t[5]=v+x,t[8]=1-c-f,t},i.normalFromMat4=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],v=e[11],d=e[12],x=e[13],g=e[14],m=e[15],p=n*s-r*a,y=n*u-i*a,M=n*c-o*a,b=r*u-i*s,w=r*c-o*s,_=i*c-o*u,E=l*x-f*d,P=l*g-h*d,I=l*m-v*d,S=f*g-h*x,D=f*m-v*x,T=h*m-v*g,O=p*T-y*D+M*S+b*I-w*P+_*E;return O?(O=1/O,t[0]=(s*T-u*D+c*S)*O,t[1]=(u*I-a*T-c*P)*O,t[2]=(a*D-s*I+c*E)*O,t[3]=(i*D-r*T-o*S)*O,t[4]=(n*T-i*I+o*P)*O,t[5]=(r*I-n*D-o*E)*O,t[6]=(x*_-g*w+m*b)*O,t[7]=(g*M-d*_-m*y)*O,t[8]=(d*w-x*M+m*p)*O,t):null},i.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},i.sub=i.subtract,i.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},i.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=e[0],v=e[1],d=e[2],x=e[3],g=e[4],m=e[5],p=t[6],y=e[7],M=e[8];return Math.abs(n-h)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-v)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-d)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-x)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(s-g)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-m)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(c-p)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(l-y)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(f-M)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(M))},t.exports=i},function(t,e,n){var r=n(5),i={};i.create=function(){var t=new r.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.fromValues=function(t,e,n){var i=new r.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},i.div=i.divide,i.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},i.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},i.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},i.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},i.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t},i.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t},i.hermite=function(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*l,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*l,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*l,t},i.bezier=function(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,f=3*u*a,h=u*o;return t[0]=e[0]*c+n[0]*l+r[0]*f+i[0]*h,t[1]=e[1]*c+n[1]*l+r[1]*f+i[1]*h,t[2]=e[2]*c+n[2]*l+r[2]*f+i[2]*h,t},i.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI,i=2*r.RANDOM()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=i*e,t},i.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t},i.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},i.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,h=c*o+a*i-s*r,v=-a*r-s*i-u*o;return t[0]=l*c+v*-a+f*-u-h*-s,t[1]=f*c+v*-s+h*-a-l*-u,t[2]=h*c+v*-u+l*-s-f*-a,t},i.rotateX=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},i.rotateY=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},i.rotateZ=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},i.forEach=function(){var t=i.create();return function(e,n,r,i,o,a){var s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),i.angle=function(t,e){var n=i.fromValues(t[0],t[1],t[2]),r=i.fromValues(e[0],e[1],e[2]);i.normalize(n,n),i.normalize(r,r);var o=i.dot(n,r);return o>1?0:Math.acos(o)},i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=e[0],s=e[1],u=e[2];return Math.abs(n-a)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-u)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},t.exports=i},function(t,e,n){var r=n(5),i={};i.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.fromValues=function(t,e,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},i.div=i.divide,i.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},i.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},i.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},i.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},i.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},i.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t},i.random=function(t,e){return e=e||1,t[0]=r.RANDOM(),t[1]=r.RANDOM(),t[2]=r.RANDOM(),t[3]=r.RANDOM(),i.normalize(t,t),i.scale(t,t,e),t},i.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t},i.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,h=c*o+a*i-s*r,v=-a*r-s*i-u*o;return t[0]=l*c+v*-a+f*-u-h*-s,t[1]=f*c+v*-s+h*-a-l*-u,t[2]=h*c+v*-u+l*-s-f*-a,t[3]=e[3],t},i.forEach=function(){var t=i.create();return function(e,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),i.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-l)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))},t.exports=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(12),a=n(2),s=function(t){return t&&t.__esModule?t:{default:t}}(a),u="MODE_DRAG",c="MODE_PAN",l="MODE_ZOOM",f=new s.default(0,1,0),h=function(){function t(e,n){var i=this;r(this,t),this._onTouchStart=function(t){if(t.preventDefault(),t.touches)switch(t.touches.length){case 1:i._mode=u,i._offsetY=i._rotationY,i._offsetX=i._rotationX;break;case 2:i._mode=l,i._radiusOffset=i._radius;break;default:i._mode=c,i._offsetY=i.target.y,i._offsetX=i.target.x}else switch(t.which){case 3:i._mode=c,i._offsetY=i.target.y,i._offsetX=i.target.x;break;default:i._mode=u,i._offsetY=i._rotationY,i._offsetX=i._rotationX}i._startY=t.pageX/i._width,i._startX=t.pageY/i._height,i._targetOffset.copy(i.target),i._radiusOffset=i._radius,i.isDown=!0},this._onTouchMove=function(t){if(i.isDown){switch(i._mode){case c:var e=t.pageX/i._width,n=t.pageY/i._height;i._direction.copy(i._camera.position).subtract(i.target).normalize();var r=i._direction.cross(f),a=i._targetOffset.x+-(i._startY-e)*i.panSpeed*r.x,s=i._targetOffset.y+-(i._startX-n)*i.panSpeed,u=i._targetOffset.z+-(i._startY-e)*i.panSpeed*r.z;i.target.set(a,s,u);break;case l:var h=t.touches[0].pageX-t.touches[1].pageX,v=t.touches[0].pageY-t.touches[1].pageY,d=Math.sqrt(h*h+v*v),x=i._lastZoomDistance>d?1:-1;i._zoomConstraint(100*x),i._lastZoomDistance=d;break;default:var g=t.pageX/i._width,m=t.pageY/i._height;i._rotationX=i._offsetX+-(i._startX-m)*i.rotationSpeed,i._rotationY=i._offsetY+(i._startY-g)*i.rotationSpeed,i._rotationX=(0,o.clamp)(i._rotationX,-Math.PI/2,Math.PI/2)}i.update()}},this._onTouchEnd=function(){i.isDown=!1},this._onContextMenu=function(t){t.preventDefault()},this._onMouseWheel=function(t){var e=0;t.wheelDelta?e=t.wheelDelta:t.detail&&(e=t.detail),i._zoomConstraint(-e)},this._onKeypress=function(t){switch(t.keyCode){case 114:i.reset()}},this.rotationSpeed=5,this.panSpeed=10,this._camera=e,this._element=n,this._zoomMin=.1,this._zoomMax=1/0,this._radius=Math.max(e.position.x,e.position.z),this._radiusOffset=0,this._defaultRadius=Math.max(e.position.x,e.position.z),this._rotationX=Math.atan2(e.position.y-0,+this._radius-0),this._rotationY=Math.atan2(e.position.z-0,e.position.x-0),this._defaultRotationX=Math.atan2(e.position.y-0,+this._radius-0),this._defaultRotationY=Math.atan2(e.position.z-0,e.position.x-0),this._offsetX=0,this._offsetY=0,this._offsetPanX=0,this._offsetPanY=0,this.target=new s.default,this._targetOffset=new s.default,this._direction=new s.default,this._lastZoomDistance=0,this._width=window.innerWidth,this._height=window.innerHeight,this._element.addEventListener("mousedown",this._onTouchStart,!1),this._element.addEventListener("mousemove",this._onTouchMove,!1),this._element.addEventListener("mouseup",this._onTouchEnd,!1),this._element.addEventListener("touchstart",this._onTouchStart,!1),this._element.addEventListener("touchmove",this._onTouchMove,!1),this._element.addEventListener("touchend",this._onTouchEnd,!1),this._element.addEventListener("contextmenu",this._onContextMenu,!1),window.addEventListener("mousewheel",this._onMouseWheel,!1),window.addEventListener("keypress",this._onKeypress,!1)}return i(t,[{key:"_zoomConstraint",value:function(t){var e=t/1e3;this._radius+=3*e,this._radius=(0,o.clamp)(this._radius,this._zoomMin,this._zoomMax),this.update()}},{key:"update",value:function(){var t=this._radius*Math.sin(this._rotationX),e=this._radius*Math.cos(this._rotationX),n=Math.sin(this._rotationY)*e,r=Math.cos(this._rotationY)*e;this._camera.position.set(n,t,r).add(this.target),this._camera.lookAt(this.target.x,this.target.y,this.target.z)}},{key:"reset",value:function(){this.target.set(0,0,0),this._rotationY=this._defaultRotationY,this._rotationX=this._defaultRotationX,this._radius=this._defaultRadius,this.update()}},{key:"dispose",value:function(){this._element.removeEventListener("mousedown",this._onTouchStart),this._element.removeEventListener("mousemove",this._onTouchMove),this._element.removeEventListener("mouseup",this._onTouchEnd),this._element.removeEventListener("touchstart",this._onTouchStart),this._element.removeEventListener("touchmove",this._onTouchMove),this._element.removeEventListener("touchend",this._onTouchEnd),this._element.removeEventListener("contextmenu",this._onContextMenu),window.removeEventListener("mousewheel",this._onMouseWheel),window.removeEventListener("keypress",this._onKeypress),this._camera=null,this._element=null}}]),t}();e.default=h},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=n(2),s=function(t){return t&&t.__esModule?t:{default:t}}(a),u=function(){function t(e){r(this,t),this.projectionMatrix=o.mat4.create(),this.isOrthographicCamera=!0,this.isPespectiveCamera=!1,this.near=.1,this.far=100,this.fov=65,this.position=new s.default,this.center=new s.default,this.up=new s.default(0,1,0),Object.assign(this,e)}return i(t,[{key:"lookAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.center.set(t,e,n)}},{key:"updateProjectionMatrix",value:function(){o.mat4.ortho(this.projectionMatrix,-1,1,-1,1,this.near,this.far)}}]),t}();e.default=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=n(7),s=n(2),u=function(t){return t&&t.__esModule?t:{default:t}}(s),c=function(){function t(e){r(this,t),this.projectionMatrix=o.mat4.create(),this.isPespectiveCamera=!0,this.isOrthographicCamera=!1,this.near=.1,this.far=100,this.fov=70,this.ratio=a.RENDERER_DEFAULT_RATIO,this.position=new u.default,this.center=new u.default,this.up=new u.default(0,1,0),Object.assign(this,e)}return i(t,[{key:"lookAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.center.set(t,e,n)}},{key:"updateProjectionMatrix",value:function(){o.mat4.perspective(this.projectionMatrix,this.fov,this.ratio,this.near,this.far)}}]),t}();e.default=c},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(1),s=n(2),u=r(s),c=n(22),l=r(c),f=n(12),h=a.mat4.create(),v=a.vec3.create(),d=new u.default,x=void 0,g=void 0,m=new u.default,p=new u.default,y=new u.default,M=new u.default,b=new u.default,w=new u.default,_=function(){function t(e,n,r,o){i(this,t),this.ray=new l.default,this.near=r||0,this.far=o||1/0}return o(t,[{key:"setFromCamera",value:function(t,e,n){n&&n.isPespectiveCamera&&(this.ray.origin.copy(n.position),a.vec3.copy(v,[t.x,t.y,.5]),a.mat4.multiply(h,n.projectionMatrix,e.modelViewMatrix),a.mat4.invert(h,h),a.vec3.transformMat4(v,v,h),a.vec3.sub(v,v,n.position.v),a.vec3.normalize(v,v),d.set(v[0],v[1],v[2]),this.ray.direction.copy(d))}},{key:"uvIntersection",value:function(t,e,n,r){return g=(0,f.barycoordFromPoint)(t.v,e.v,n.v,r.v),M.scale(g.x),b.scale(g.y),w.scale(g.z),M.add(b).add(w),M.clone()}},{key:"intersectObject",value:function(t){for(var e=void 0,n=void 0,r=0;r<t.geometry.faces.length;r+=1)if(x=t.geometry.faces[r],a.vec3.copy(m.v,x.vertices[0].v),a.vec3.copy(p.v,x.vertices[1].v),a.vec3.copy(y.v,x.vertices[2].v),a.vec3.transformMat4(m.v,m.v,t.modelMatrix),a.vec3.transformMat4(p.v,p.v,t.modelMatrix),a.vec3.transformMat4(y.v,y.v,t.modelMatrix),e=this.ray.intersectTriangle(m,p,y)){a.vec3.copy(M.v,t.geometry.uvs[x.uvs[0]].v),a.vec3.copy(b.v,t.geometry.uvs[x.uvs[1]].v),a.vec3.copy(w.v,t.geometry.uvs[x.uvs[2]].v),n=this.uvIntersection(e,m,p,y);break}return e?{point:e,uv:n}:null}}]),t}();e.default=_},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),s=r(a),u=n(1),c=n(16),l=r(c),f=void 0,h=function(){function t(e){i(this,t),this.width=window.innerWidth,this.height=window.innerHeight,this.ratio=this.width/this.height,this.pixelRatio=1,Object.assign(this,e),f=s.get(),this._frameBuffer=f.createFramebuffer(),f.bindFramebuffer(f.FRAMEBUFFER,this._frameBuffer),this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR_MIPMAP_NEAREST),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,this.width,this.height,0,f.RGBA,f.UNSIGNED_BYTE,null),this._renderBuffer=f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,this._renderBuffer),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,this.width,this.height),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,this.texture,0),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,this._renderBuffer),f.bindTexture(f.TEXTURE_2D,null),f.bindRenderbuffer(f.RENDERBUFFER,null),f.bindFramebuffer(f.FRAMEBUFFER,null)}return o(t,[{key:"setSize",value:function(t,e){var n=t*this.pixelRatio,r=e*this.pixelRatio;n===this.width&&r===this.height||(this.width=t*this.pixelRatio,this.height=e*this.pixelRatio,this.ratio=this.width/this.height,f.bindTexture(f.TEXTURE_2D,this.texture),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,this.width,this.height,0,f.RGBA,f.UNSIGNED_BYTE,null),f.bindTexture(f.TEXTURE_2D,null),f.bindRenderbuffer(f.RENDERBUFFER,this._renderBuffer),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,this.width,this.height),f.bindRenderbuffer(f.RENDERBUFFER,null))}},{key:"render",value:function(t,e){if(f=s.get(),f.viewport(0,0,this.width,this.height),f.bindFramebuffer(f.FRAMEBUFFER,this._frameBuffer),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT),f.clearColor(0,0,0,1),e.isPespectiveCamera)u.mat4.perspective(e.projectionMatrix,e.fov,this.ratio,e.near,e.far);else{if(!e.isOrthographicCamera)throw new Error("Camera type not supported");u.mat4.ortho(e.projectionMatrix,-1,1,-1,1,e.near,e.far)}u.mat4.identity(t.modelViewMatrix),u.mat4.lookAt(t.modelViewMatrix,e.position.v,e.center.v,e.up.v),t.update(),f instanceof WebGL2RenderingContext&&l.updateProjectionView(f,e.projectionMatrix,t.modelViewMatrix),t.objects.forEach(function(n){n.isInstanced?n.drawInstance(t.modelViewMatrix,e.projectionMatrix,e):n.draw(t.modelViewMatrix,e.projectionMatrix,e)}),f.bindTexture(f.TEXTURE_2D,this.texture),f.generateMipmap(f.TEXTURE_2D),f.bindTexture(f.TEXTURE_2D,null),f.bindFramebuffer(f.FRAMEBUFFER,null)}}]),t}();e.default=h},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),s=r(a),u=n(1),c=n(13),l=n(7),f=n(3),h=r(f),v=n(16),d=r(v),x=n(23),g=function(t){return t&&t.__esModule?t:{default:t}}(x),m=n(77),p=void 0,y=function(){function t(e){i(this,t),this.width=l.RENDERER_DEFAULT_WIDTH,this.height=l.RENDERER_DEFAULT_HEIGHT,this.ratio=l.RENDERER_DEFAULT_WIDTH/l.RENDERER_DEFAULT_HEIGHT,this.preserveDrawingBuffer=!1,this.pixelRatio=1,this.prefferedContext=l.RENDERER_DEFAULT_CONTEXT,Object.assign(this,e),this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height;var n={preserveDrawingBuffer:this.preserveDrawingBuffer},r=(0,g.default)();if(!r)return void(0,c.warn)("Webgl not supported");var o=void 0;if(r.webgl2&&this.prefferedContext===l.WEBGL2_CONTEXT){o=l.WEBGL2_CONTEXT;var a=this.canvas.getContext("webgl2",n);s.set(a,o)}else{o=l.WEBGL_CONTEXT;var u=this.canvas.getContext("webgl",n)||this.canvas.getContext("experimental-webgl",n);s.set(u,o)}(0,c.log)("%c"+m.name+" "+m.version+" webgl"+(s.webgl2?2:""),"padding: 1px; background: #222; color: #ff00ff"),p=s.get(),h.set(p),s.webgl2&&d.setup(),p.clearColor(0,0,0,1),p.enable(p.DEPTH_TEST)}return o(t,[{key:"setSize",value:function(t,e){var n=t*this.pixelRatio,r=e*this.pixelRatio;n===this.width&&r===this.height||(this.width=t*this.pixelRatio,this.height=e*this.pixelRatio,this.ratio=this.width/this.height,this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px")}},{key:"setDevicePixelRatio",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.pixelRatio=t||1,this.setSize(this.width,this.height)}},{key:"_drawObjects",value:function(t,e,n,r){p instanceof WebGL2RenderingContext&&d.updateProjectionView(p,e,n),t.objects.forEach(function(t){t.isInstanced?t.drawInstance(n,e,r):t.draw(n,e,r)})}},{key:"render",value:function(t,e){p=s.get(),p.viewport(0,0,p.drawingBufferWidth,p.drawingBufferHeight),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),u.mat4.identity(t.modelViewMatrix),u.mat4.lookAt(t.modelViewMatrix,e.position.v,e.center.v,e.up.v),t.update(),this._drawObjects(t,e.projectionMatrix,t.modelViewMatrix,e)}}]),t}();e.default=y},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=function(){function t(){r(this,t),this.objects=[],this.pointLights=void 0,this.directionalLights=void 0,this.modelViewMatrix=o.mat4.create()}return i(t,[{key:"add",value:function(t){this.objects.push(t)}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.objects.indexOf(t);-1!==n&&(this.objects.splice(n,1),e&&(t.dispose(),t=void 0))}},{key:"update",value:function(){this.directionalLights&&(this.directionalLights.update(),this.directionalLights.bind()),this.pointLights&&(this.pointLights.update(),this.pointLights.bind())}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a),u=n(18),c=r(u),l=n(27),f=r(l),h=n(26),v=r(h),d=n(15),x=r(d),g=n(13),m=void 0,p=function(){function t(e){var n=this;i(this,t),this.onTextureLoaded=function(t){n.image=t,n.update(n.image),n.emit("loaded")},this.onTextureError=function(t){(0,g.warn)(t)},(0,c.default)(this),m=s.get(),this.src="",this.magFilter=m.NEAREST,this.minFilter=m.NEAREST,this.wrapS=m.CLAMP_TO_EDGE,this.wrapT=m.CLAMP_TO_EDGE,this.resizeToPow2=!1,Object.assign(this,e),this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,this.placeholder()),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,this.magFilter),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.minFilter),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,this.wrapS),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,this.wrapT),m.bindTexture(m.TEXTURE_2D,null),this._isHdr="hdr"===this.src.split(".").pop(),this.load(this.src)}return o(t,[{key:"load",value:function(t){this._isHdr?(0,v.default)(t).then(this.onTextureLoaded).catch(this.onTextureError):(0,f.default)(t).then(this.onTextureLoaded).catch(this.onTextureError)}},{key:"updateImage",value:function(t){this.src=t||this.src,this.load(this.src)}},{key:"update",value:function(t){m=s.get(),m.bindTexture(m.TEXTURE_2D,this.texture),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!0),t instanceof x.default&&m instanceof WebGL2RenderingContext?m.texImage2D(m.TEXTURE_2D,0,m.RGBA16F,t.width,t.height,0,m.RGBA,m.FLOAT,t.data):m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,this._resizeImage()),m.bindTexture(m.TEXTURE_2D,null)}},{key:"placeholder",value:function(){var t=document.createElement("canvas");return t.width=1,t.height=1,t}},{key:"_resizeImage",value:function(){var t=this;if(!this.resizeToPow2||this.image instanceof x.default)return this.image;var e=Array(12).fill(0).map(function(t,e){return Math.pow(2,e+1)});e.forEach(function(e){return t.image.width===e&&t.image.height===e&&t.image});var n=Math.max(this.image.width,this.image.height),r=e.reduce(function(t,e){return Math.abs(e-n)<Math.abs(t-n)?e:t}),i=document.createElement("canvas"),o=i.getContext("2d");return i.width=r,i.height=r,o.drawImage(this.image,0,0,r,r),i}},{key:"dispose",value:function(){m=s.get(),m.deleteTexture(this.texture),this.texture=null}}]),t}();e.default=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a),u=n(18),c=r(u),l=n(27),f=r(l),h=n(26),v=r(h),d=n(15),x=r(d),g=n(13),m=void 0,p=function(){function t(e){var n=this;i(this,t),this.onTextureLoaded=function(t){n.images=t,n.update(n.images),n.emit("loaded")},this.onTextureError=function(t){(0,g.warn)(t)},(0,c.default)(this),m=s.get(),this.src=Array(6).fill(""),this.magFilter=m.LINEAR,this.minFilter=m.LINEAR,this.wrapS=m.CLAMP_TO_EDGE,this.wrapT=m.CLAMP_TO_EDGE,this.resizeToPow2=!1,Object.assign(this,e),this.texture=m.createTexture(),this.images=[],this.loaders=[],this.update(this.placeholder()),this._isHdr="hdr"===this.src[0].split(".").pop(),this.src.forEach(function(t,e){n.loaders[e]=n.load(n.src[e])}),Promise.all(this.loaders).then(this.onTextureLoaded).catch(this.onTextureError)}return o(t,[{key:"load",value:function(t){return this._isHdr?(0,v.default)(t):(0,f.default)(t)}},{key:"update",value:function(t){m=s.get(),m.bindTexture(m.TEXTURE_CUBE_MAP,this.texture);for(var e=[m.TEXTURE_CUBE_MAP_POSITIVE_X,m.TEXTURE_CUBE_MAP_NEGATIVE_X,m.TEXTURE_CUBE_MAP_POSITIVE_Y,m.TEXTURE_CUBE_MAP_NEGATIVE_Y,m.TEXTURE_CUBE_MAP_POSITIVE_Z,m.TEXTURE_CUBE_MAP_NEGATIVE_Z],n=0;n<6;n+=1){var r=this._isHdr?t[n]:this._resizeImage(t[n]);m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!1),r instanceof x.default?m instanceof WebGL2RenderingContext&&m.texImage2D(e[n],0,m.RGBA16F,r.width,r.height,0,m.RGBA,m.FLOAT,r.data):m.texImage2D(e[n],0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,r),m.texParameteri(m.TEXTURE_CUBE_MAP,m.TEXTURE_MAG_FILTER,this.magFilter),m.texParameteri(m.TEXTURE_CUBE_MAP,m.TEXTURE_MIN_FILTER,this.minFilter),m.texParameteri(m.TEXTURE_CUBE_MAP,m.TEXTURE_WRAP_S,this.wrapS),m.texParameteri(m.TEXTURE_CUBE_MAP,m.TEXTURE_WRAP_T,this.wrapT)}m.bindTexture(m.TEXTURE_CUBE_MAP,null)}},{key:"placeholder",value:function(){for(var t=[],e=0;e<6;e+=1){var n=document.createElement("canvas");n.width=128,n.height=128,t.push(n)}return t}},{key:"_resizeImage",value:function(t){if(!this.resizeToPow2||t instanceof x.default)return t;var e=Array(12).fill(0).map(function(t,e){return Math.pow(2,e+1)});e.forEach(function(e){return t.width===e&&t.height===e&&t});var n=Math.max(t.width,t.height),r=e.reduce(function(t,e){return Math.abs(e-n)<Math.abs(t-n)?e:t}),i=document.createElement("canvas"),o=i.getContext("2d");return i.width=r,i.height=r,o.drawImage(t,0,0,r,r),i}}]),t}();e.default=p},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o),s=n(18),u=function(t){return t&&t.__esModule?t:{default:t}}(s),c=void 0,l=function(){function t(e){var n=this;r(this,t),this._onCanPlayThrough=function(){n.emit("canplaythrough")},this._onEnded=function(){n.emit("ended")},(0,u.default)(this),c=a.get(),this.src="",this.magFilter=c.NEAREST,this.minFilter=c.NEAREST,this.wrapS=c.CLAMP_TO_EDGE,this.wrapT=c.CLAMP_TO_EDGE,this.loop=!1,this.autoplay=!0,Object.assign(this,e),this.video=document.createElement("video"),this.video.src=this.src,this.video.loop=this.loop,this.video.autoplay=this.autoplay,this.video.setAttribute("webkitplaysinline","webkitplaysinline"),this.video.setAttribute("playsinline","playsinline"),this.video.addEventListener("canplaythrough",this._onCanPlayThrough,!0),this.video.addEventListener("ended",this._onEnded,!0),this._currentTime=0,this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,this.placeholder()),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,this.magFilter),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.minFilter),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,this.wrapS),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,this.wrapT),c.bindTexture(c.TEXTURE_2D,null)}return i(t,[{key:"update",value:function(){c=a.get(),this.video.readyState>=this.video.HAVE_CURRENT_DATA&&(this.video.currentTime!==this._currentTime&&(c.bindTexture(c.TEXTURE_2D,this.texture),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!0),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,this.video),c.bindTexture(c.TEXTURE_2D,null)),this._currentTime=this.video.currentTime)}},{key:"placeholder",value:function(){var t=document.createElement("canvas");return t.width=1,t.height=1,t}}]),t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(4),s=function(t){return t&&t.__esModule?t:{default:t}}(a),u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments[3];r(this,e);for(var s=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],u=0;u<s.length;u+=3)s[u]*=t,s[u+1]*=n,s[u+2]*=o;var c=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],l=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],f=[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1];return i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new Float32Array(s),new Uint16Array(c),new Float32Array(l),new Float32Array(f),a))}return o(e,t),e}(s.default);e.default=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(4),s=function(t){return t&&t.__esModule?t:{default:t}}(a),u=function(t){function e(t){r(this,e);for(var n=[],o=0,a=0,s=t.length/3,u=0;u<s;u+=1)o=3*u,a=6*u,u<s-1&&(n[a]=t[o],n[a+1]=t[o+1],n[a+2]=t[o+2],n[a+3]=t[o+3],n[a+4]=t[o+4],n[a+5]=t[o+5]);return i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new Float32Array(n)))}return o(e,t),e}(s.default);e.default=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(4),s=function(t){return t&&t.__esModule?t:{default:t}}(a),u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"XY",u=arguments[5];r(this,e);for(var c=[],l=[],f=[],h=[],v=0,d=t/o,x=n/a,g=.5*-t,m=.5*-n,p=1/o,y=1/a,M=0;M<a;M+=1)for(var b=0;b<o;b+=1){var w=d*b+g,_=x*M+m,E=b/o,P=M/a;switch(s){case"XZ":c=c.concat([w,0,_]),c=c.concat([w+d,0,_]),c=c.concat([w+d,0,_+x]),c=c.concat([w,0,_+x]),f=f.concat([0,1,0]),f=f.concat([0,1,0]),f=f.concat([0,1,0]),f=f.concat([0,1,0]),h=h.concat([E,1-P]),h=h.concat([E+p,1-P]),h=h.concat([E+p,1-(P+y)]),h=h.concat([E,1-(P+y)]);break;case"YZ":c=c.concat([0,_,w]),c=c.concat([0,_,w+d]),c=c.concat([0,_+x,w+d]),c=c.concat([0,_+x,w]),f=f.concat([1,0,0]),f=f.concat([1,0,0]),f=f.concat([1,0,0]),f=f.concat([1,0,0]),h=h.concat([1-E,P]),h=h.concat([1-(E+p),P]),h=h.concat([1-(E+p),P+y]),h=h.concat([1-E,P+y]);break;default:c=c.concat([w,_,0]),c=c.concat([w+d,_,0]),c=c.concat([w+d,_+x,0]),c=c.concat([w,_+x,0]),f=f.concat([0,0,1]),f=f.concat([0,0,1]),f=f.concat([0,0,1]),f=f.concat([0,0,1]),h=h.concat([E,P]),h=h.concat([E+p,P]),h=h.concat([E+p,P+y]),h=h.concat([E,P+y])}l.push(4*v+0),l.push(4*v+1),l.push(4*v+2),l.push(4*v+0),l.push(4*v+2),l.push(4*v+3),v+=1}return i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new Float32Array(c),new Uint16Array(l),new Float32Array(f),new Float32Array(h),u))}return o(e,t),e}(s.default);e.default=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(4),s=function(t){return t&&t.__esModule?t:{default:t}}(a),u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a=arguments[3];r(this,e);for(var s=[],u=[],c=[],l=0;l<=n;l+=1)for(var f=l*Math.PI/n,h=Math.sin(f),v=Math.cos(f),d=0;d<=o;d+=1){var x=2*d*Math.PI/o,g=Math.sin(x),m=Math.cos(x),p=m*h,y=v,M=g*h,b=1-d/o,w=1-l/n;u.push(p),u.push(y),u.push(M),c.push(b),c.push(w),s.push(t*p),s.push(t*y),s.push(t*M)}for(var _=[],E=0;E<n;E+=1)for(var P=0;P<o;P+=1){var I=E*(o+1)+P,S=I+o+1;_.push(I),_.push(S),_.push(I+1),_.push(S),_.push(S+1),_.push(I+1)}return i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new Float32Array(s),new Uint16Array(_),new Float32Array(u),new Float32Array(c),a))}return o(e,t),e}(s.default);e.default=u},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(){return M.default+"\n\tprecision "+g.capabilities.precision+" float;\n\tin vec3 vColor;\n\tout vec4 outgoingColor;\n\n\tvoid main(void){\n\t\toutgoingColor = vec4(vColor, 1.0);\n\t}\n\t"}function u(){return"\n\tprecision "+g.capabilities.precision+" float;\n\tvarying vec3 vColor;\n\n\tvoid main(void){\n\t\tgl_FragColor = vec4(vColor, 1.0);\n\t}\n\t"}Object.defineProperty(e,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(9),f=r(l),h=n(10),v=r(h),d=n(0),x=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(d),g=n(3),m=n(4),p=r(m),y=n(6),M=r(y),b=n(8),w=r(b),_=M.default+"\n\tlayout (location = 0) in vec3 aVertexPosition;\n\tlayout (location = 1) in vec3 aVertexColor;\n\n\t"+w.default+"\n\n\tuniform mat4 uModelMatrix;\n\n\tout vec3 vColor;\n\n\tvoid main(void){\n\t\tvColor = aVertexColor;\n\t\tgl_Position = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n\t}\n",E="\n\tattribute vec3 aVertexPosition;\n\tattribute vec3 aVertexColor;\n\n\tuniform mat4 uProjectionMatrix;\n\tuniform mat4 uViewMatrix;\n\tuniform mat4 uModelMatrix;\n\n\tvarying vec3 vColor;\n\n\tvoid main(void){\n\t\tvColor = aVertexColor;\n\t\tgl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n\t}\n",P=function(t){function e(t){i(this,e);var n=[];n=n.concat([0,0,0,t,0,0]),n=n.concat([0,0,0,0,t,0]),n=n.concat([0,0,0,0,0,t]);var r=new Float32Array([1,0,0,1,0,0,0,1,0,0,1,0,0,0,1,0,0,1]);return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new Float32Array(n),null,null,null,r))}return a(e,t),e}(p.default),I=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;i(this,e);var n=x.webgl2?_:E,r=x.webgl2?s():u();return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new P(t),new v.default({name:"AxisHelper",vertexShader:n,fragmentShader:r})))}return a(e,t),c(e,[{key:"draw",value:function(t,e){var n=x.get();this.updateMatrix(),this.shader.program.bind(),this.shader.setUniforms(t,e,this.modelMatrix),g.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),n.drawArrays(n.LINES,0,this.geometry.attributes.aVertexPosition.numItems),g.extensions.vertexArrayObject&&this.vao.unbind()}}]),e}(f.default);e.default=I},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(){return b.default+"\n\tprecision "+m.capabilities.precision+" float;\n\tout vec4 outgoingColor;\n\n\tvoid main(void){\n\t\toutgoingColor = vec4(vec3(0.5), 1.0);\n\t}\n\t"}function u(){return"\n\tprecision "+m.capabilities.precision+" float;\n\n\tvoid main(void){\n\t\tgl_FragColor = vec4(vec3(0.5), 1.0);\n\t}\n\t"}Object.defineProperty(e,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(12),f=n(9),h=r(f),v=n(10),d=r(v),x=n(0),g=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(x),m=n(3),p=n(4),y=r(p),M=n(6),b=r(M),w=n(8),_=r(w),E=b.default+"\n\t"+_.default+"\n\n\tin vec3 aVertexPosition;\n\n\tuniform mat4 uModelMatrix;\n\n\tvoid main(void){\n\t\tgl_Position = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n\t}\n",P="\n\tattribute vec3 aVertexPosition;\n\n\tuniform mat4 uProjectionMatrix;\n\tuniform mat4 uViewMatrix;\n\tuniform mat4 uModelMatrix;\n\n\tvoid main(void){\n\t\tgl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n\t}\n",I=function(t){function e(t,n){i(this,e);for(var r=[],a=.5*t,s=0;s<n+1;s+=1){var u=(0,l.lerp)(-a,a,s/n),c=-a,f=(0,l.lerp)(-a,a,s/n),h=a;r=r.concat([u,0,c,f,0,h])}for(var v=0;v<n+1;v+=1){var d=-a,x=(0,l.lerp)(-a,a,v/n),g=a,m=(0,l.lerp)(-a,a,v/n);r=r.concat([d,0,x,g,0,m])}return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new Float32Array(r)))}return a(e,t),e}(y.default),S=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;i(this,e);var r=g.webgl2?E:P,a=g.webgl2?s():u();return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new I(t,n),new d.default({name:"GridHelper",vertexShader:r,fragmentShader:a})))}return a(e,t),c(e,[{key:"draw",value:function(t,e){var n=g.get();this.updateMatrix(),this.shader.program.bind(),this.shader.setUniforms(t,e,this.modelMatrix),m.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),n.drawArrays(n.LINES,0,this.geometry.attributes.aVertexPosition.numItems),m.extensions.vertexArrayObject&&this.vao.unbind()}}]),e}(h.default);e.default=S},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(){return M.default+"\n\tprecision "+g.capabilities.precision+" float;\n\tout vec4 outgoingColor;\n\n\tvoid main(void){\n\t\toutgoingColor = vec4(1.0);\n\t}\n\t"}function u(){return"\n\tprecision "+g.capabilities.precision+" float;\n\n\tvoid main(void){\n\t\tgl_FragColor = vec4(1.0);\n\t}\n\t"}Object.defineProperty(e,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(9),f=r(l),h=n(10),v=r(h),d=n(0),x=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(d),g=n(3),m=n(4),p=r(m),y=n(6),M=r(y),b=n(8),w=r(b),_=M.default+"\n\t"+w.default+"\n\n\tin vec3 aVertexPosition;\n\n\tuniform mat4 uModelMatrix;\n\tuniform mat3 uNormalMatrix;\n\n\tvoid main(void){\n\t\tgl_Position = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n\t}\n",E="\n\tattribute vec3 aVertexPosition;\n\n\tuniform mat4 uProjectionMatrix;\n\tuniform mat4 uViewMatrix;\n\tuniform mat4 uModelMatrix;\n\tuniform mat3 uNormalMatrix;\n\n\tvoid main(void){\n\t\tgl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n\t}\n",P=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;i(this,e);for(var r=[],a=t.scale.x,s=t.scale.y,u=t.scale.z,c=t.geometry.bufferNormals.length/3,l=0;l<c;l+=1){var f=3*l,h=a*t.geometry.bufferVertices[f],v=s*t.geometry.bufferVertices[f+1],d=u*t.geometry.bufferVertices[f+2],x=t.geometry.bufferNormals[f],g=t.geometry.bufferNormals[f+1],m=t.geometry.bufferNormals[f+2],p=h+n*x,y=v+n*g,M=d+n*m;r=r.concat([h,v,d,p,y,M])}return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new Float32Array(r)))}return a(e,t),e}(p.default),I=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;i(this,e);var r=x.webgl2?_:E,a=x.webgl2?s():u();return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new P(t,n),new v.default({name:"NormalsHelper",vertexShader:r,fragmentShader:a})))}return a(e,t),c(e,[{key:"draw",value:function(t,e){var n=x.get();this.updateMatrix(),this.shader.program.bind(),this.shader.setUniforms(t,e,this.modelMatrix),g.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),n.drawArrays(n.LINES,0,this.geometry.attributes.aVertexPosition.numItems),g.extensions.vertexArrayObject&&this.vao.unbind()}}]),e}(f.default);e.default=I},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(){return b.default+"\n\tprecision "+m.capabilities.precision+" float;\n\tuniform vec3 uColor;\n\tout vec4 outgoingColor;\n\n\tvoid main(void){\n\t\tif(length(gl_PointCoord - 0.5) > 0.5) {\n\t\t\tdiscard;\n\t\t}\n\t\toutgoingColor = vec4(uColor, 1.0);\n\t}\n\t"}function u(){return"\n\tprecision "+m.capabilities.precision+" float;\n\tuniform vec3 uColor;\n\n\tvoid main(void){\n\t\tif(length(gl_PointCoord - 0.5) > 0.5) {\n\t\t\tdiscard;\n\t\t}\n\t\tgl_FragColor = vec4(uColor, 1.0);\n\t}\n\t"}Object.defineProperty(e,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(1),f=n(9),h=r(f),v=n(10),d=r(v),x=n(0),g=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(x),m=n(3),p=n(4),y=r(p),M=n(6),b=r(M),w=n(8),_=r(w),E=n(11),P=r(E),I=n(12),S=b.default+"\n\t"+_.default+"\n\n\tin vec3 aVertexPosition;\n\n\tuniform mat4 uModelMatrix;\n\tuniform float uSize;\n\n\tvoid main(void){\n\t\tvec4 mvPosition = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n\t\tgl_PointSize = uSize * (100.0 / length(mvPosition.xyz));\n\t\tgl_Position = mvPosition;\n\t}\n",D="\n\tattribute vec3 aVertexPosition;\n\n\tuniform mat4 uProjectionMatrix;\n\tuniform mat4 uViewMatrix;\n\tuniform mat4 uModelMatrix;\n\tuniform float uSize;\n\n\tvoid main(void){\n\t\tvec4 mvPosition = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n\t\tgl_PointSize = uSize * (100.0 / length(mvPosition.xyz));\n\t\tgl_Position = mvPosition;\n\t}\n",T=function(t){function e(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];i(this,e);for(var n=[],r=t.geometry.bufferVertices.length,a=0;a<r;a+=1)n[a]=t.geometry.bufferVertices[a];return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new Float32Array(n)))}return a(e,t),e}(y.default),O=l.mat4.create(),F=l.mat4.create(),z=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:65280,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#ffffff";i(this,e);var c=g.webgl2?S:D,l=g.webgl2?s():u(),f=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new T(t,n),new d.default({name:"VerticesHelper",vertexShader:c,fragmentShader:l,uniforms:{uSize:{type:"f",value:n},uColor:{type:"3f",value:new P.default(r).v}}})));f._labels=[],f._parentMesh=t;var h=void 0,v=function(t){h=document.createElement("div"),h.style.position="absolute",h.style.pointerEvents="none",h.style.color=a,h.style.fontSize="16px",f._labels.push({indice:t,element:h}),document.body.appendChild(h)};return f._parentMesh.geometry.faces.forEach(function(t,e){v(t.indices[0]),v(t.indices[1]),v(t.indices[2])}),f}return a(e,t),c(e,[{key:"draw",value:function(t,e){var n=this,r=g.get();this.updateMatrix(),l.mat4.identity(O),l.mat4.identity(F),l.mat4.mul(F,t,this.modelMatrix),l.mat4.mul(O,e,F);var i=void 0,o=void 0;this._labels.forEach(function(t,e){o=n._parentMesh.geometry.vertices[t.indice],i=(0,I.from3DTo2D)(o,O),t.element.style.left=i.x*window.innerWidth+"px",t.element.style.top=i.y*window.innerHeight+"px",t.element.innerHTML=""+t.indice}),this.shader.program.bind(),this.shader.setUniforms(t,e,this.modelMatrix),m.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),r.drawArrays(r.POINTS,0,this.geometry.attributes.aVertexPosition.numItems),m.extensions.vertexArrayObject&&this.vao.unbind()}}]),e}(h.default);e.default=z},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(0),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(c),f=n(25),h=r(f),v=n(2),d=r(v),x=n(11),g=r(x),m=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var n=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.uniforms={position:{type:"3f",value:new d.default(0,0,0).v},color:{type:"3f",value:new g.default(16777215).v},intensity:{type:"f",value:1}},Object.assign(n.uniforms,t),n.position=new d.default,l.webgl2&&(n.data=new Float32Array([].concat(i(n.uniforms.position.value),[0],i(n.uniforms.color.value),[0,n.uniforms.intensity.value,0,0,0]))),n}return s(e,t),u(e,[{key:"update",value:function(){l.webgl2?(this.setValues(this.position.v),this.setValues(this.uniforms.color,4),this.setValues([this.uniforms.intensity.value],8)):this.uniforms.position.value.set(this.position.v)}}]),e}(h.default);e.default=m},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o),s=n(24),u=function(t){return t&&t.__esModule?t:{default:t}}(s),c=void 0,l=function(){function t(e){if(r(this,t),this.lights=e,a.webgl2){var n=this.lights[0].data.length,i=Array(e.length*n),o=new Float32Array(i);this.uniformBuffer=new u.default(o),this._lightsData=new Float32Array(e[0].data.length*e.length)}}return i(t,[{key:"get",value:function(){return this.lights}},{key:"update",value:function(){var t=this;a.webgl2?(this.lights.forEach(function(e,n){e.update(),t._lightsData.set(e.data,n*e.data.length)}),this.uniformBuffer.setValues(this._lightsData,0)):this.lights.forEach(function(t){t.update()})}},{key:"bind",value:function(){a.webgl2&&(c=a.get(),c.bindBufferBase(c.UNIFORM_BUFFER,1,this.uniformBuffer.buffer),c.bindBuffer(c.UNIFORM_BUFFER,this.uniformBuffer.buffer),c.bufferSubData(c.UNIFORM_BUFFER,0,this.uniformBuffer.data),c.bindBuffer(c.UNIFORM_BUFFER,null))}},{key:"length",get:function(){return this.lights.length}}]),t}();e.default=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(0),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(c),f=n(25),h=r(f),v=n(2),d=r(v),x=n(11),g=r(x),m=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var n=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.uniforms={position:{type:"3f",value:new d.default(0,0,0).v},color:{type:"3f",value:new g.default(16777215).v},specularColor:{type:"3f",value:new g.default(16777215).v},shininess:{type:"f",value:100},intensity:{type:"f",value:1}},Object.assign(n.uniforms,t),n.position=new d.default,l.webgl2&&(n.data=new Float32Array([].concat(i(n.uniforms.position.value),[0],i(n.uniforms.color.value),[0],i(n.uniforms.specularColor.value),[0,n.uniforms.shininess.value,0,0,0,n.uniforms.intensity.value,0,0,0]))),n}return s(e,t),u(e,[{key:"update",value:function(){l.webgl2?(this.setValues(this.position.v),this.setValues(this.uniforms.color,4),this.setValues(this.uniforms.specularColor,8),this.setValues([this.uniforms.shininess.value],12),this.setValues([this.uniforms.intensity.value],16)):this.uniforms.position.value.set(this.position.v)}}]),e}(h.default);e.default=m},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=n(79),o=function(t){return t&&t.__esModule?t:{default:t}}(i),a=function t(e){return r(this,t),new Promise(function(t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState)if(4===r.readyState&&200===r.status){var e=new o.default.Mesh(r.responseText);t(e,r.status)}else n("error",r.status)},r.open("GET",e,!0),r.send()})};e.default=a},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(28),a=i(o),s=n(29),u=r(s),c=n(64),l=i(c),f=n(6),h=i(f),v=n(65),d=i(v),x=n(66),g=i(x),m=n(30),p=i(m),y=n(67),M=r(y),b=n(68),w=i(b),_=n(17),E=r(_),P=n(8),I=i(P),S=n(69),D=r(S),T=n(70),O=i(T);e.default={Conditionals:a.default,DirectionalLights:u,EnvMapCube:l.default,EsVersion:h.default,Fog:d.default,Gamma:g.default,Math:p.default,Noise:M,Packing:w.default,PointLights:E,ProjectionView:I.default,Tonemap:D,Transpose:O.default}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=void 0,a=void 0,s=window.performance||Date,u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r(this,t),this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.isRunning=e}return i(t,[{key:"start",value:function(){this.startTime=s.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.isRunning=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.isRunning=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){return o=0,this.autoStart&&!this.isRunning&&this.start(),this.isRunning&&(a=s.now(),o=(a-this.oldTime)/1e3,this.oldTime=a,this.elapsedTime+=o),o}}]),t}();e.default=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o),s=n(13),u=void 0,c=function(){function t(){r(this,t),u=a.get(),this.program=u.createProgram(),this.created=!1,this.uniformBlocks={},this.attributeLocations={}}return i(t,[{key:"link",value:function(t,e,n){if(this.compiledVertexShader=this.compile("vs",t),this.compiledFragmentShader=this.compile("fs",e),this.compiledVertexShader&&this.compiledFragmentShader){if(u.attachShader(this.program,this.compiledVertexShader),u.attachShader(this.program,this.compiledFragmentShader),n instanceof Array&&u instanceof WebGL2RenderingContext&&u.transformFeedbackVaryings(this.program,n,u.SEPARATE_ATTRIBS),u.linkProgram(this.program),u.validateProgram(this.program),!u.getProgramParameter(this.program,u.LINK_STATUS)){var r=u.getProgramInfoLog(this.program);(0,s.warn)("Failed to initialise shaders",r)}this.created=!0}}},{key:"compile",value:function(t,e){u=a.get();var n=void 0;switch(t){case"vs":n=u.createShader(u.VERTEX_SHADER);break;default:n=u.createShader(u.FRAGMENT_SHADER)}return u.shaderSource(n,e),u.compileShader(n),u.getShaderParameter(n,u.COMPILE_STATUS)?n:((0,s.warn)("Failed to compile shader:",u.getShaderInfoLog(n)),!1)}},{key:"setAttributeLocation",value:function(t){u=a.get(),this.attributeLocations[t]=u.getAttribLocation(this.program,t),u.enableVertexAttribArray(this.attributeLocations[t])}},{key:"setAttributePointer",value:function(t,e){u=a.get(),u.vertexAttribPointer(this.attributeLocations[t],e,u.FLOAT,!1,0,0)}},{key:"setAttributeInstancedPointer",value:function(t,e){u=a.get(),u.vertexAttribPointer(this.attributeLocations[t],e,u.FLOAT,!1,0,0)}},{key:"setUniformLocation",value:function(t,e){u=a.get(),t[e].location=u.getUniformLocation(this.program,e)}},{key:"setUniformBlockLocation",value:function(t,e,n){(u=a.get())instanceof WebGL2RenderingContext&&(this.uniformBlocks[t]=u.getUniformBlockIndex(this.program,t),u.uniformBlockBinding(this.program,this.uniformBlocks[t],this.uniformBlocks[t]),u.bindBufferBase(u.UNIFORM_BUFFER,n,e))}},{key:"bind",value:function(){u=a.get(),u.useProgram(this.program)}},{key:"dispose",value:function(){var t=this;u=a.get();var e=void 0;Object.keys(this.attributeLocations).forEach(function(n){e=t.attributeLocations[n],u.disableVertexAttribArray(e)}),u.detachShader(this.program,this.compiledVertexShader),u.detachShader(this.program,this.compiledFragmentShader),u.deleteProgram(this.program)}}]),t}();e.default=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=n(2),s=function(t){return t&&t.__esModule?t:{default:t}}(a),u=o.vec3.create(),c=o.vec3.create(),l=function(){function t(e,n,i,o,a,u){r(this,t),this.indices=[e,n,i],this.vertices=[o,a,u],this.uvs=[e,n,i],this.normal=new s.default,this.updateFaceNormal()}return i(t,[{key:"updateFaceNormal",value:function(){o.vec3.set(u,0,0,0),o.vec3.set(c,0,0,0),o.vec3.subtract(u,this.vertices[2].v,this.vertices[1].v),o.vec3.subtract(c,this.vertices[0].v,this.vertices[1].v),o.vec3.cross(u,u,c),o.vec3.normalize(u,u),this.normal.set(u[0],u[1],u[2])}}]),t}();e.default=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.ObjLoader=e.OrbitControls=e.ShaderChunks=e.MathUtils=e.Ray=e.Vector2=e.Vector3=e.Color=e.PointLight=e.DirectionalLight=e.Lights=e.VerticesHelper=e.NormalsHelper=e.GridHelper=e.AxisHelper=e.SphereGeometry=e.PlaneGeometry=e.Geometry=e.BufferAttribute=e.LineGeometry=e.BoxGeometry=e.WebVRVive=e.Detect=e.Clock=e.Vao=e.TextureVideo=e.TextureCube=e.Texture=e.Shader=e.Scene=e.RenderTarget=e.Renderer=e.RayCaster=e.PerspectiveCamera=e.OrthographicCamera=e.Object3D=e.Mesh=e.GL=e.Constants=e.Capabilities=void 0;var o=n(3),a=i(o),s=n(7),u=i(s),c=n(0),l=i(c),f=n(9),h=r(f),v=n(19),d=r(v),x=n(35),g=r(x),m=n(36),p=r(m),y=n(37),M=r(y),b=n(39),w=r(b),_=n(38),E=r(_),P=n(40),I=r(P),S=n(10),D=r(S),T=n(41),O=r(T),F=n(42),z=r(F),A=n(43),R=r(A),L=n(20),C=r(L),j=n(44),N=r(j),k=n(45),U=r(k),V=n(21),B=r(V),G=n(4),X=r(G),q=n(46),H=r(q),Y=n(47),W=r(Y),K=n(48),Z=r(K),Q=n(49),J=r(Q),$=n(50),tt=r($),et=n(51),nt=r(et),rt=n(52),it=r(rt),ot=n(54),at=r(ot),st=n(53),ut=r(st),ct=n(55),lt=r(ct),ft=n(11),ht=r(ft),vt=n(2),dt=r(vt),xt=n(14),gt=r(xt),mt=n(22),pt=r(mt),yt=n(12),Mt=i(yt),bt=n(57),wt=r(bt),_t=n(58),Et=r(_t),Pt=n(23),It=r(Pt),St=n(34),Dt=r(St),Tt=n(56),Ot=r(Tt);e.Capabilities=a,e.Constants=u,e.GL=l,e.Mesh=h.default,e.Object3D=d.default,e.OrthographicCamera=g.default,e.PerspectiveCamera=p.default,e.RayCaster=M.default,e.Renderer=w.default,e.RenderTarget=E.default,e.Scene=I.default,e.Shader=D.default,e.Texture=O.default,e.TextureCube=z.default,e.TextureVideo=R.default,e.Vao=C.default,e.Clock=Et.default,e.Detect=It.default,e.WebVRVive=N.default,e.BoxGeometry=U.default,e.LineGeometry=H.default,e.BufferAttribute=B.default,e.Geometry=X.default,e.PlaneGeometry=W.default,e.SphereGeometry=Z.default,e.AxisHelper=J.default,e.GridHelper=tt.default,e.NormalsHelper=nt.default,e.VerticesHelper=it.default,e.Lights=at.default,e.DirectionalLight=ut.default,e.PointLight=lt.default,e.Color=ht.default,e.Vector3=dt.default,e.Vector2=gt.default,e.Ray=pt.default,e.MathUtils=Mt,e.ShaderChunks=wt.default,e.OrbitControls=Dt.default,e.ObjLoader=Ot.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fragmentShaderEs100=e.fragmentShaderEs300=void 0;var r=n(6),i=function(t){return t&&t.__esModule?t:{default:t}}(r),o=n(17),a=n(29),s=n(28),u=i.default+"\n\t#HOOK_PRECISION\n\t#HOOK_DEFINES\n\n\tlayout(std140) uniform;\n\n\tin vec3 vDiffuse;\n\tin vec3 vPosition;\n\n\t#ifdef normals\n\tin vec3 vNormal;\n\t#endif\n\n\t#ifdef uv\n\tin vec2 vUv;\n\t#endif\n\n\t#ifdef directionalLights\n\t"+a.directionalLightsEs300+"\n\t#endif\n\n\t// Lighting\n\t#ifdef pointLights\n\t"+o.pointLightsInEs300+"\n\t#endif\n\n\tout vec4 outgoingColor;\n\n\t"+s.whenGreaterThan+"\n\n\t#HOOK_FRAGMENT_PRE\n\n\tvoid main(void){\n\n\t\tvec3 color = vDiffuse;\n\n\t\t#ifdef normals\n\t\tvec3 normal = normalize(vNormal);\n\t\t#endif\n\n\t\t#HOOK_FRAGMENT_MAIN\n\n\t\t#ifdef directionalLights\n\t\tfor (int i = 0; i < #HOOK_DIRECTIONAL_LIGHTS; i++) {\n\t\t\tfloat directionalLight = dot(normal, normalize(uDirectionalLights[i].position.xyz));\n\t\t\tvec3 directionalColor = uDirectionalLights[i].color.rgb * directionalLight;\n\t\t\tcolor += whenGreaterThan(directionalLight, 0.0) * (directionalColor * uDirectionalLights[i].intensity.x);\n\t\t}\n\t\t#endif\n\n\t\t#ifdef pointLights\n\t\tfor (int i = 0; i < #HOOK_POINT_LIGHTS; i++) {\n\t\t\tvec3 pointLightSurfaceToLightDirection = normalize(vPointLightSurfaceToLightDirection[i]);\n\t\t\tvec3 pointLightSurfaceToCameraDirection = normalize(vPointLightSurfaceToCameraDirection[i]);\n\t\t\tvec3 halfVector = normalize(pointLightSurfaceToLightDirection + pointLightSurfaceToCameraDirection);\n\n\t\t\tfloat pointLight = max(dot(normal, pointLightSurfaceToLightDirection), 0.0);\n\t\t\tvec3 pointLightColor = uPointLights[i].color.rgb * pointLight;\n\t\t\tcolor += pointLight * pointLightColor;\n\t\t\tfloat specular = max(pow(dot(normal, halfVector), uPointLights[i].shininess.x), 0.0);\n\t\t\tcolor += specular * uPointLights[i].specularColor.rgb;\n\t\t}\n\t\t#endif\n\n\t\toutgoingColor = vec4(color.rgb, 1.0);\n\n\t\t#HOOK_FRAGMENT_END\n\t}\n",c="\n\t#HOOK_PRECISION\n\t#HOOK_DEFINES\n\n\tvarying vec3 vDiffuse;\n\tvarying vec3 vPosition;\n\n\t#ifdef normals\n\tvarying vec3 vNormal;\n\t#endif\n\n\t#ifdef uv\n\tvarying vec2 vUv;\n\t#endif\n\n\t#ifdef directionalLights\n\t"+a.directionalLightsEs100+"\n\t#endif\n\n\t// Lighting\n\t#ifdef pointLights\n\t"+o.pointLightsEs100+"\n\t#endif\n\n\t"+s.whenGreaterThan+"\n\n\t#HOOK_FRAGMENT_PRE\n\n\tvoid main(void){\n\n\t\tvec3 color = vDiffuse;\n\n\t\t#ifdef normals\n\t\tvec3 normal = normalize(vNormal);\n\t\t#endif\n\n\t\t#HOOK_FRAGMENT_MAIN\n\n\t\t#ifdef directionalLights\n\t\tfor (int i = 0; i < #HOOK_DIRECTIONAL_LIGHTS; i++) {\n\t\t\tfloat directionalLight = dot(normal, normalize(uDirectionalLights[i].position));\n\t\t\tvec3 directionalColor = uDirectionalLights[i].color * directionalLight;\n\t\t\tcolor += whenGreaterThan(directionalLight, 0.0) * (directionalColor * uDirectionalLights[i].intensity);\n\t\t}\n\t\t#endif\n\n\t\t#ifdef pointLights\n\t\tfor (int i = 0; i < #HOOK_POINT_LIGHTS; i++) {\n\t\t\tvec3 pointLightSurfaceToLightDirection = normalize(vPointLightSurfaceToLightDirection[i]);\n\t\t\tvec3 pointLightSurfaceToCameraDirection = normalize(vPointLightSurfaceToCameraDirection[i]);\n\t\t\tvec3 halfVector = normalize(pointLightSurfaceToLightDirection + pointLightSurfaceToCameraDirection);\n\n\t\t\tfloat pointLight = max(dot(normal, pointLightSurfaceToLightDirection), 0.0);\n\t\t\tvec3 pointLightColor = uPointLights[i].color * pointLight;\n\t\t\tcolor += pointLight * pointLightColor;\n\t\t\tfloat specular = max(pow(dot(normal, halfVector), uPointLights[i].shininess), 0.0);\n\t\t\tcolor += specular * uPointLights[i].specularColor;\n\t\t}\n\t\t#endif\n\n\t\tgl_FragColor = vec4(color.rgb, 1.0);\n\n\t\t#HOOK_FRAGMENT_END\n\t}\n";e.fragmentShaderEs300=u,e.fragmentShaderEs100=c},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.vertexShaderEs100=e.vertexShaderEs300=void 0;var i=n(6),o=r(i),a=n(17),s=n(30),u=n(8),c=r(u),l=o.default+"\n\t"+s.definePI+"\n\t"+s.definePITwo+"\n\t#HOOK_DEFINES\n\n\tlayout(std140) uniform;\n\n\t"+c.default+"\n\n\tuniform mat4 uProjectionMatrix;\n\tuniform mat4 uViewMatrix;\n\tuniform mat4 uViewMatrixInverse;\n\tuniform mat4 uModelMatrix;\n\tuniform mat4 uModelMatrixInverse;\n\tuniform mat3 uNormalMatrix;\n\n\tin vec3 aVertexPosition;\n\tout vec3 vPosition;\n\tout vec4 vWorldPosition;\n\n\t// Camera\n\tuniform vec3 uCameraPosition;\n\n\t#ifdef vertexColors\n\tin vec3 aVertexColor;\n\t#endif\n\n\t// Color\n\tuniform vec3 uDiffuse;\n\tout vec3 vDiffuse;\n\n\t// Normal\n\t#ifdef normals\n\tin vec3 aVertexNormal;\n\tout vec3 vNormal;\n\t#endif\n\n\t// Uv\n\t#ifdef uv\n\tin vec2 aUv;\n\tout vec2 vUv;\n\t#endif\n\n\t// Lighting\n\t#ifdef pointLights\n\t"+a.pointLightsOutEs300+"\n\t#endif\n\n\t#HOOK_VERTEX_PRE\n\n\tvoid main(void){\n\n\t\tvDiffuse = uDiffuse;\n\n\t\t// Override for custom positioning\n\t\tvec3 transformed = vec3(0.0);\n\n\t\t#ifdef vertexColors\n\t\tvDiffuse = aVertexColor;\n\t\t#endif\n\n\t\t#ifdef uv\n\t\tvUv = aUv;\n\t\t#endif\n\n\t\t#HOOK_VERTEX_MAIN\n\n\t\t#ifdef normals\n\t\tvNormal = uNormalMatrix * aVertexNormal;\n\t\t#endif\n\n\t\t// Vertex position + offset\n\t\tvPosition = aVertexPosition + transformed;\n\n\t\t// Calculate world position of vertex with transformed\n\t\tvWorldPosition = uModelMatrix * vec4(aVertexPosition + transformed, 1.0);\n\n\t\t#ifdef pointLights\n\t\tfor (int i = 0; i < #HOOK_POINT_LIGHTS; i++) {\n\t\t\t// Calculate directional vector of surface to the light\n\t\t\tvPointLightSurfaceToLightDirection[i] = uPointLights[i].position.xyz - vWorldPosition.xyz;\n\t\t\t// Calculate directional vector of camera to the surface\n\t\t\tvPointLightSurfaceToCameraDirection[i] = uCameraPosition - vWorldPosition.xyz;\n\t\t}\n\t\t#endif\n\n\t\tgl_Position = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(vPosition, 1.0);\n\n\t\t#HOOK_VERTEX_END\n\t}\n",f="\n\n\t"+s.definePI+"\n\t"+s.definePITwo+"\n\t#HOOK_DEFINES\n\n\t// Position\n\tuniform mat4 uProjectionMatrix;\n\tuniform mat4 uViewMatrix;\n\tuniform mat4 uViewMatrixInverse;\n\tuniform mat4 uModelMatrix;\n\tuniform mat4 uModelMatrixInverse;\n\tuniform mat3 uNormalMatrix;\n\tattribute vec3 aVertexPosition;\n\tvarying vec3 vPosition;\n\tvarying vec4 vWorldPosition;\n\n\t// Camera\n\tuniform vec3 uCameraPosition;\n\n\t#ifdef vertexColors\n\tattribute vec3 aVertexColor;\n\t#endif\n\n\t// Color\n\tuniform vec3 uDiffuse;\n\tvarying vec3 vDiffuse;\n\n\t// Normal\n\t#ifdef normals\n\tattribute vec3 aVertexNormal;\n\tvarying vec3 vNormal;\n\t#endif\n\n\t// Uv\n\t#ifdef uv\n\tattribute vec2 aUv;\n\tvarying vec2 vUv;\n\t#endif\n\n\t// Lighting\n\t#ifdef pointLights\n\t"+a.pointLightsEs100+"\n\t#endif\n\n\t#HOOK_VERTEX_PRE\n\n\tvoid main(void){\n\n\t\tvDiffuse = uDiffuse;\n\n\t\t// Override for custom positioning\n\t\tvec3 transformed = vec3(0.0);\n\n\t\t#ifdef vertexColors\n\t\tvDiffuse = aVertexColor;\n\t\t#endif\n\n\t\t#ifdef uv\n\t\tvUv = aUv;\n\t\t#endif\n\n\t\t#HOOK_VERTEX_MAIN\n\n\t\t#ifdef normals\n\t\tvNormal = uNormalMatrix * aVertexNormal;\n\t\t#endif\n\n\t\t// Vertex position + offset\n\t\tvPosition = aVertexPosition + transformed;\n\n\t\t// Calculate world position of vertex with transformed\n\t\tvWorldPosition = uModelMatrix * vec4(aVertexPosition + transformed, 1.0);\n\n\t\t#ifdef pointLights\n\t\tfor (int i = 0; i < #HOOK_POINT_LIGHTS; i++) {\n\t\t\t// Calculate word position of vertex\n\t\t\tvec3 surfaceWorldPosition = (uModelMatrix * vec4(aVertexPosition, 1.0)).xyz;\n\t\t\t// Calculate directional vector of surface to the light\n\t\t\tvPointLightSurfaceToLightDirection[i] = uPointLights[i].position - vPosition;\n\t\t\t// Calculate directional vector of camera to the surface\n\t\t\tvPointLightSurfaceToCameraDirection[i] = uCameraPosition - vPosition;\n\t\t}\n\t\t#endif\n\n\t\tgl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(vPosition, 1.0);\n\n\t\t#HOOK_VERTEX_END\n\t}\n";e.vertexShaderEs300=l,e.vertexShaderEs100=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="\n/**\n * Samples cubemap environment map\n * @param  {vec3} wcNormal - normal in the world coordinate space\n * @param  {float} - flipEnvMap    -1.0 for left handed coorinate system oriented texture (usual case)\n *                                  1.0 for right handed coorinate system oriented texture\n * @return {vec4} - cubemap texture coordinate\n */\nvec3 envMapCube(vec3 wcNormal, float flipEnvMap) {\n\treturn vec3(flipEnvMap * wcNormal.x, wcNormal.y, wcNormal.z);\n}\n\nvec3 envMapCube(vec3 wcNormal) {\n //-1.0 for left handed coorinate system oriented texture (usual case)\n return envMapCube(wcNormal, -1.0);\n}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=e.linear="\nfloat fogLinear(const float dist, const float start, const float end) {\n  return 1.0 - clamp((end - dist) / (end - start), 0.0, 1.0);\n}\n",i=e.exp="\nfloat fogExp(\n  const float dist,\n  const float density\n) {\n  return 1.0 - clamp(exp(-density * dist), 0.0, 1.0);\n}\n",o=e.exp2="\nfloat fogExp2(\n  const float dist,\n  const float density\n) {\n  const float LOG2 = -1.442695;\n  float d = density * dist;\n  return 1.0 - clamp(exp2(d * d * LOG2), 0.0, 1.0);\n}\n";e.default={linear:r,exp:i,exp2:o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="\n\tconst float gamma = 2.2;\n\n\tfloat toGamma(float v) {\n\t  return pow(v, 1.0 / gamma);\n\t}\n\n\tvec2 toGamma(vec2 v) {\n\t  return pow(v, vec2(1.0 / gamma));\n\t}\n\n\tvec3 toGamma(vec3 v) {\n\t  return pow(v, vec3(1.0 / gamma));\n\t}\n\n\tvec4 toGamma(vec4 v) {\n\t  return vec4(toGamma(v.rgb), v.a);\n\t}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.classicNoise2D='\n//\n// GLSL textureless classic 2D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-08-22\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec2 fade(vec2 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat classicNoise2D(vec2 P)\n{\n  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n  Pi = mod289(Pi); // To avoid truncation effects in permutation\n  vec4 ix = Pi.xzxz;\n  vec4 iy = Pi.yyww;\n  vec4 fx = Pf.xzxz;\n  vec4 fy = Pf.yyww;\n\n  vec4 i = permute(permute(ix) + iy);\n\n  vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;\n  vec4 gy = abs(gx) - 0.5 ;\n  vec4 tx = floor(gx + 0.5);\n  gx = gx - tx;\n\n  vec2 g00 = vec2(gx.x,gy.x);\n  vec2 g10 = vec2(gx.y,gy.y);\n  vec2 g01 = vec2(gx.z,gy.z);\n  vec2 g11 = vec2(gx.w,gy.w);\n\n  vec4 norm = taylorInvSqrt(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\n  g00 *= norm.x;\n  g01 *= norm.y;\n  g10 *= norm.z;\n  g11 *= norm.w;\n\n  float n00 = dot(g00, vec2(fx.x, fy.x));\n  float n10 = dot(g10, vec2(fx.y, fy.y));\n  float n01 = dot(g01, vec2(fx.z, fy.z));\n  float n11 = dot(g11, vec2(fx.w, fy.w));\n\n  vec2 fade_xy = fade(Pf.xy);\n  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n  return 2.3 * n_xy;\n}\n',e.classicNoise3D='\n//\n// GLSL textureless classic 3D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-10-11\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat classicNoise3D(vec3 P)\n{\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n  return 2.2 * n_xyz;\n}\n',e.classicNoise4D='\n//\n// GLSL textureless classic 4D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-08-22\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 fade(vec4 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat classicNoise4D(vec4 P)\n{\n  vec4 Pi0 = floor(P); // Integer part for indexing\n  vec4 Pi1 = Pi0 + 1.0; // Integer part + 1\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec4 Pf0 = fract(P); // Fractional part for interpolation\n  vec4 Pf1 = Pf0 - 1.0; // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = vec4(Pi0.zzzz);\n  vec4 iz1 = vec4(Pi1.zzzz);\n  vec4 iw0 = vec4(Pi0.wwww);\n  vec4 iw1 = vec4(Pi1.wwww);\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n  vec4 ixy00 = permute(ixy0 + iw0);\n  vec4 ixy01 = permute(ixy0 + iw1);\n  vec4 ixy10 = permute(ixy1 + iw0);\n  vec4 ixy11 = permute(ixy1 + iw1);\n\n  vec4 gx00 = ixy00 * (1.0 / 7.0);\n  vec4 gy00 = floor(gx00) * (1.0 / 7.0);\n  vec4 gz00 = floor(gy00) * (1.0 / 6.0);\n  gx00 = fract(gx00) - 0.5;\n  gy00 = fract(gy00) - 0.5;\n  gz00 = fract(gz00) - 0.5;\n  vec4 gw00 = vec4(0.75) - abs(gx00) - abs(gy00) - abs(gz00);\n  vec4 sw00 = step(gw00, vec4(0.0));\n  gx00 -= sw00 * (step(0.0, gx00) - 0.5);\n  gy00 -= sw00 * (step(0.0, gy00) - 0.5);\n\n  vec4 gx01 = ixy01 * (1.0 / 7.0);\n  vec4 gy01 = floor(gx01) * (1.0 / 7.0);\n  vec4 gz01 = floor(gy01) * (1.0 / 6.0);\n  gx01 = fract(gx01) - 0.5;\n  gy01 = fract(gy01) - 0.5;\n  gz01 = fract(gz01) - 0.5;\n  vec4 gw01 = vec4(0.75) - abs(gx01) - abs(gy01) - abs(gz01);\n  vec4 sw01 = step(gw01, vec4(0.0));\n  gx01 -= sw01 * (step(0.0, gx01) - 0.5);\n  gy01 -= sw01 * (step(0.0, gy01) - 0.5);\n\n  vec4 gx10 = ixy10 * (1.0 / 7.0);\n  vec4 gy10 = floor(gx10) * (1.0 / 7.0);\n  vec4 gz10 = floor(gy10) * (1.0 / 6.0);\n  gx10 = fract(gx10) - 0.5;\n  gy10 = fract(gy10) - 0.5;\n  gz10 = fract(gz10) - 0.5;\n  vec4 gw10 = vec4(0.75) - abs(gx10) - abs(gy10) - abs(gz10);\n  vec4 sw10 = step(gw10, vec4(0.0));\n  gx10 -= sw10 * (step(0.0, gx10) - 0.5);\n  gy10 -= sw10 * (step(0.0, gy10) - 0.5);\n\n  vec4 gx11 = ixy11 * (1.0 / 7.0);\n  vec4 gy11 = floor(gx11) * (1.0 / 7.0);\n  vec4 gz11 = floor(gy11) * (1.0 / 6.0);\n  gx11 = fract(gx11) - 0.5;\n  gy11 = fract(gy11) - 0.5;\n  gz11 = fract(gz11) - 0.5;\n  vec4 gw11 = vec4(0.75) - abs(gx11) - abs(gy11) - abs(gz11);\n  vec4 sw11 = step(gw11, vec4(0.0));\n  gx11 -= sw11 * (step(0.0, gx11) - 0.5);\n  gy11 -= sw11 * (step(0.0, gy11) - 0.5);\n\n  vec4 g0000 = vec4(gx00.x,gy00.x,gz00.x,gw00.x);\n  vec4 g1000 = vec4(gx00.y,gy00.y,gz00.y,gw00.y);\n  vec4 g0100 = vec4(gx00.z,gy00.z,gz00.z,gw00.z);\n  vec4 g1100 = vec4(gx00.w,gy00.w,gz00.w,gw00.w);\n  vec4 g0010 = vec4(gx10.x,gy10.x,gz10.x,gw10.x);\n  vec4 g1010 = vec4(gx10.y,gy10.y,gz10.y,gw10.y);\n  vec4 g0110 = vec4(gx10.z,gy10.z,gz10.z,gw10.z);\n  vec4 g1110 = vec4(gx10.w,gy10.w,gz10.w,gw10.w);\n  vec4 g0001 = vec4(gx01.x,gy01.x,gz01.x,gw01.x);\n  vec4 g1001 = vec4(gx01.y,gy01.y,gz01.y,gw01.y);\n  vec4 g0101 = vec4(gx01.z,gy01.z,gz01.z,gw01.z);\n  vec4 g1101 = vec4(gx01.w,gy01.w,gz01.w,gw01.w);\n  vec4 g0011 = vec4(gx11.x,gy11.x,gz11.x,gw11.x);\n  vec4 g1011 = vec4(gx11.y,gy11.y,gz11.y,gw11.y);\n  vec4 g0111 = vec4(gx11.z,gy11.z,gz11.z,gw11.z);\n  vec4 g1111 = vec4(gx11.w,gy11.w,gz11.w,gw11.w);\n\n  vec4 norm00 = taylorInvSqrt(vec4(dot(g0000, g0000), dot(g0100, g0100), dot(g1000, g1000), dot(g1100, g1100)));\n  g0000 *= norm00.x;\n  g0100 *= norm00.y;\n  g1000 *= norm00.z;\n  g1100 *= norm00.w;\n\n  vec4 norm01 = taylorInvSqrt(vec4(dot(g0001, g0001), dot(g0101, g0101), dot(g1001, g1001), dot(g1101, g1101)));\n  g0001 *= norm01.x;\n  g0101 *= norm01.y;\n  g1001 *= norm01.z;\n  g1101 *= norm01.w;\n\n  vec4 norm10 = taylorInvSqrt(vec4(dot(g0010, g0010), dot(g0110, g0110), dot(g1010, g1010), dot(g1110, g1110)));\n  g0010 *= norm10.x;\n  g0110 *= norm10.y;\n  g1010 *= norm10.z;\n  g1110 *= norm10.w;\n\n  vec4 norm11 = taylorInvSqrt(vec4(dot(g0011, g0011), dot(g0111, g0111), dot(g1011, g1011), dot(g1111, g1111)));\n  g0011 *= norm11.x;\n  g0111 *= norm11.y;\n  g1011 *= norm11.z;\n  g1111 *= norm11.w;\n\n  float n0000 = dot(g0000, Pf0);\n  float n1000 = dot(g1000, vec4(Pf1.x, Pf0.yzw));\n  float n0100 = dot(g0100, vec4(Pf0.x, Pf1.y, Pf0.zw));\n  float n1100 = dot(g1100, vec4(Pf1.xy, Pf0.zw));\n  float n0010 = dot(g0010, vec4(Pf0.xy, Pf1.z, Pf0.w));\n  float n1010 = dot(g1010, vec4(Pf1.x, Pf0.y, Pf1.z, Pf0.w));\n  float n0110 = dot(g0110, vec4(Pf0.x, Pf1.yz, Pf0.w));\n  float n1110 = dot(g1110, vec4(Pf1.xyz, Pf0.w));\n  float n0001 = dot(g0001, vec4(Pf0.xyz, Pf1.w));\n  float n1001 = dot(g1001, vec4(Pf1.x, Pf0.yz, Pf1.w));\n  float n0101 = dot(g0101, vec4(Pf0.x, Pf1.y, Pf0.z, Pf1.w));\n  float n1101 = dot(g1101, vec4(Pf1.xy, Pf0.z, Pf1.w));\n  float n0011 = dot(g0011, vec4(Pf0.xy, Pf1.zw));\n  float n1011 = dot(g1011, vec4(Pf1.x, Pf0.y, Pf1.zw));\n  float n0111 = dot(g0111, vec4(Pf0.x, Pf1.yzw));\n  float n1111 = dot(g1111, Pf1);\n\n  vec4 fade_xyzw = fade(Pf0);\n  vec4 n_0w = mix(vec4(n0000, n1000, n0100, n1100), vec4(n0001, n1001, n0101, n1101), fade_xyzw.w);\n  vec4 n_1w = mix(vec4(n0010, n1010, n0110, n1110), vec4(n0011, n1011, n0111, n1111), fade_xyzw.w);\n  vec4 n_zw = mix(n_0w, n_1w, fade_xyzw.z);\n  vec2 n_yzw = mix(n_zw.xy, n_zw.zw, fade_xyzw.y);\n  float n_xyzw = mix(n_yzw.x, n_yzw.y, fade_xyzw.x);\n  return 2.2 * n_xyzw;\n}\n',e.periodicNoise2D='\n//\n// GLSL textureless classic 2D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-08-22\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec2 fade(vec2 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise, periodic variant\nfloat periodicNoise2D(vec2 P, vec2 rep)\n{\n  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n  Pi = mod(Pi, rep.xyxy); // To create noise with explicit period\n  Pi = mod289(Pi);        // To avoid truncation effects in permutation\n  vec4 ix = Pi.xzxz;\n  vec4 iy = Pi.yyww;\n  vec4 fx = Pf.xzxz;\n  vec4 fy = Pf.yyww;\n\n  vec4 i = permute(permute(ix) + iy);\n\n  vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;\n  vec4 gy = abs(gx) - 0.5 ;\n  vec4 tx = floor(gx + 0.5);\n  gx = gx - tx;\n\n  vec2 g00 = vec2(gx.x,gy.x);\n  vec2 g10 = vec2(gx.y,gy.y);\n  vec2 g01 = vec2(gx.z,gy.z);\n  vec2 g11 = vec2(gx.w,gy.w);\n\n  vec4 norm = taylorInvSqrt(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\n  g00 *= norm.x;\n  g01 *= norm.y;\n  g10 *= norm.z;\n  g11 *= norm.w;\n\n  float n00 = dot(g00, vec2(fx.x, fy.x));\n  float n10 = dot(g10, vec2(fx.y, fy.y));\n  float n01 = dot(g01, vec2(fx.z, fy.z));\n  float n11 = dot(g11, vec2(fx.w, fy.w));\n\n  vec2 fade_xy = fade(Pf.xy);\n  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n  return 2.3 * n_xy;\n}\n',e.periodicNoise3D='\n//\n// GLSL textureless classic 3D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-10-11\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise, periodic variant\nfloat periodicNoise3D(vec3 P, vec3 rep)\n{\n  vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n  vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n  return 2.2 * n_xyz;\n}\n',e.periodicNoise4D='\n//\n// GLSL textureless classic 4D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-08-22\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 fade(vec4 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise, periodic version\nfloat periodicNoise4D(vec4 P, vec4 rep)\n{\n  vec4 Pi0 = mod(floor(P), rep); // Integer part modulo rep\n  vec4 Pi1 = mod(Pi0 + 1.0, rep); // Integer part + 1 mod rep\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec4 Pf0 = fract(P); // Fractional part for interpolation\n  vec4 Pf1 = Pf0 - 1.0; // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = vec4(Pi0.zzzz);\n  vec4 iz1 = vec4(Pi1.zzzz);\n  vec4 iw0 = vec4(Pi0.wwww);\n  vec4 iw1 = vec4(Pi1.wwww);\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n  vec4 ixy00 = permute(ixy0 + iw0);\n  vec4 ixy01 = permute(ixy0 + iw1);\n  vec4 ixy10 = permute(ixy1 + iw0);\n  vec4 ixy11 = permute(ixy1 + iw1);\n\n  vec4 gx00 = ixy00 * (1.0 / 7.0);\n  vec4 gy00 = floor(gx00) * (1.0 / 7.0);\n  vec4 gz00 = floor(gy00) * (1.0 / 6.0);\n  gx00 = fract(gx00) - 0.5;\n  gy00 = fract(gy00) - 0.5;\n  gz00 = fract(gz00) - 0.5;\n  vec4 gw00 = vec4(0.75) - abs(gx00) - abs(gy00) - abs(gz00);\n  vec4 sw00 = step(gw00, vec4(0.0));\n  gx00 -= sw00 * (step(0.0, gx00) - 0.5);\n  gy00 -= sw00 * (step(0.0, gy00) - 0.5);\n\n  vec4 gx01 = ixy01 * (1.0 / 7.0);\n  vec4 gy01 = floor(gx01) * (1.0 / 7.0);\n  vec4 gz01 = floor(gy01) * (1.0 / 6.0);\n  gx01 = fract(gx01) - 0.5;\n  gy01 = fract(gy01) - 0.5;\n  gz01 = fract(gz01) - 0.5;\n  vec4 gw01 = vec4(0.75) - abs(gx01) - abs(gy01) - abs(gz01);\n  vec4 sw01 = step(gw01, vec4(0.0));\n  gx01 -= sw01 * (step(0.0, gx01) - 0.5);\n  gy01 -= sw01 * (step(0.0, gy01) - 0.5);\n\n  vec4 gx10 = ixy10 * (1.0 / 7.0);\n  vec4 gy10 = floor(gx10) * (1.0 / 7.0);\n  vec4 gz10 = floor(gy10) * (1.0 / 6.0);\n  gx10 = fract(gx10) - 0.5;\n  gy10 = fract(gy10) - 0.5;\n  gz10 = fract(gz10) - 0.5;\n  vec4 gw10 = vec4(0.75) - abs(gx10) - abs(gy10) - abs(gz10);\n  vec4 sw10 = step(gw10, vec4(0.0));\n  gx10 -= sw10 * (step(0.0, gx10) - 0.5);\n  gy10 -= sw10 * (step(0.0, gy10) - 0.5);\n\n  vec4 gx11 = ixy11 * (1.0 / 7.0);\n  vec4 gy11 = floor(gx11) * (1.0 / 7.0);\n  vec4 gz11 = floor(gy11) * (1.0 / 6.0);\n  gx11 = fract(gx11) - 0.5;\n  gy11 = fract(gy11) - 0.5;\n  gz11 = fract(gz11) - 0.5;\n  vec4 gw11 = vec4(0.75) - abs(gx11) - abs(gy11) - abs(gz11);\n  vec4 sw11 = step(gw11, vec4(0.0));\n  gx11 -= sw11 * (step(0.0, gx11) - 0.5);\n  gy11 -= sw11 * (step(0.0, gy11) - 0.5);\n\n  vec4 g0000 = vec4(gx00.x,gy00.x,gz00.x,gw00.x);\n  vec4 g1000 = vec4(gx00.y,gy00.y,gz00.y,gw00.y);\n  vec4 g0100 = vec4(gx00.z,gy00.z,gz00.z,gw00.z);\n  vec4 g1100 = vec4(gx00.w,gy00.w,gz00.w,gw00.w);\n  vec4 g0010 = vec4(gx10.x,gy10.x,gz10.x,gw10.x);\n  vec4 g1010 = vec4(gx10.y,gy10.y,gz10.y,gw10.y);\n  vec4 g0110 = vec4(gx10.z,gy10.z,gz10.z,gw10.z);\n  vec4 g1110 = vec4(gx10.w,gy10.w,gz10.w,gw10.w);\n  vec4 g0001 = vec4(gx01.x,gy01.x,gz01.x,gw01.x);\n  vec4 g1001 = vec4(gx01.y,gy01.y,gz01.y,gw01.y);\n  vec4 g0101 = vec4(gx01.z,gy01.z,gz01.z,gw01.z);\n  vec4 g1101 = vec4(gx01.w,gy01.w,gz01.w,gw01.w);\n  vec4 g0011 = vec4(gx11.x,gy11.x,gz11.x,gw11.x);\n  vec4 g1011 = vec4(gx11.y,gy11.y,gz11.y,gw11.y);\n  vec4 g0111 = vec4(gx11.z,gy11.z,gz11.z,gw11.z);\n  vec4 g1111 = vec4(gx11.w,gy11.w,gz11.w,gw11.w);\n\n  vec4 norm00 = taylorInvSqrt(vec4(dot(g0000, g0000), dot(g0100, g0100), dot(g1000, g1000), dot(g1100, g1100)));\n  g0000 *= norm00.x;\n  g0100 *= norm00.y;\n  g1000 *= norm00.z;\n  g1100 *= norm00.w;\n\n  vec4 norm01 = taylorInvSqrt(vec4(dot(g0001, g0001), dot(g0101, g0101), dot(g1001, g1001), dot(g1101, g1101)));\n  g0001 *= norm01.x;\n  g0101 *= norm01.y;\n  g1001 *= norm01.z;\n  g1101 *= norm01.w;\n\n  vec4 norm10 = taylorInvSqrt(vec4(dot(g0010, g0010), dot(g0110, g0110), dot(g1010, g1010), dot(g1110, g1110)));\n  g0010 *= norm10.x;\n  g0110 *= norm10.y;\n  g1010 *= norm10.z;\n  g1110 *= norm10.w;\n\n  vec4 norm11 = taylorInvSqrt(vec4(dot(g0011, g0011), dot(g0111, g0111), dot(g1011, g1011), dot(g1111, g1111)));\n  g0011 *= norm11.x;\n  g0111 *= norm11.y;\n  g1011 *= norm11.z;\n  g1111 *= norm11.w;\n\n  float n0000 = dot(g0000, Pf0);\n  float n1000 = dot(g1000, vec4(Pf1.x, Pf0.yzw));\n  float n0100 = dot(g0100, vec4(Pf0.x, Pf1.y, Pf0.zw));\n  float n1100 = dot(g1100, vec4(Pf1.xy, Pf0.zw));\n  float n0010 = dot(g0010, vec4(Pf0.xy, Pf1.z, Pf0.w));\n  float n1010 = dot(g1010, vec4(Pf1.x, Pf0.y, Pf1.z, Pf0.w));\n  float n0110 = dot(g0110, vec4(Pf0.x, Pf1.yz, Pf0.w));\n  float n1110 = dot(g1110, vec4(Pf1.xyz, Pf0.w));\n  float n0001 = dot(g0001, vec4(Pf0.xyz, Pf1.w));\n  float n1001 = dot(g1001, vec4(Pf1.x, Pf0.yz, Pf1.w));\n  float n0101 = dot(g0101, vec4(Pf0.x, Pf1.y, Pf0.z, Pf1.w));\n  float n1101 = dot(g1101, vec4(Pf1.xy, Pf0.z, Pf1.w));\n  float n0011 = dot(g0011, vec4(Pf0.xy, Pf1.zw));\n  float n1011 = dot(g1011, vec4(Pf1.x, Pf0.y, Pf1.zw));\n  float n0111 = dot(g0111, vec4(Pf0.x, Pf1.yzw));\n  float n1111 = dot(g1111, Pf1);\n\n  vec4 fade_xyzw = fade(Pf0);\n  vec4 n_0w = mix(vec4(n0000, n1000, n0100, n1100), vec4(n0001, n1001, n0101, n1101), fade_xyzw.w);\n  vec4 n_1w = mix(vec4(n0010, n1010, n0110, n1110), vec4(n0011, n1011, n0111, n1111), fade_xyzw.w);\n  vec4 n_zw = mix(n_0w, n_1w, fade_xyzw.z);\n  vec2 n_yzw = mix(n_zw.xy, n_zw.zw, fade_xyzw.y);\n  float n_xyzw = mix(n_yzw.x, n_yzw.y, fade_xyzw.x);\n  return 2.2 * n_xyzw;\n}\n',e.simplexNoise2D="\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat simplexNoise2D(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n    + i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n",e.simplexNoise3D="\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat simplexNoise3D(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n",e.simplexNoise4D="\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nfloat mod289(float x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0; }\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat permute(float x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt(float r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4(float j, vec4 ip)\n  {\n  const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n  vec4 p,s;\n\n  p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n  p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n  s = vec4(lessThan(p, vec4(0.0)));\n  p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n  return p;\n  }\n\n// (sqrt(5) - 1)/4 = F4, used once below\n#define F4 0.309016994374947451\n\nfloat simplexNoise4D(vec4 v)\n  {\n  const vec4  C = vec4( 0.138196601125011,  // (5 - sqrt(5))/20  G4\n                        0.276393202250021,  // 2 * G4\n                        0.414589803375032,  // 3 * G4\n                       -0.447213595499958); // -1 + 4 * G4\n\n// First corner\n  vec4 i  = floor(v + dot(v, vec4(F4)) );\n  vec4 x0 = v -   i + dot(i, C.xxxx);\n\n// Other corners\n\n// Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)\n  vec4 i0;\n  vec3 isX = step( x0.yzw, x0.xxx );\n  vec3 isYZ = step( x0.zww, x0.yyz );\n//  i0.x = dot( isX, vec3( 1.0 ) );\n  i0.x = isX.x + isX.y + isX.z;\n  i0.yzw = 1.0 - isX;\n//  i0.y += dot( isYZ.xy, vec2( 1.0 ) );\n  i0.y += isYZ.x + isYZ.y;\n  i0.zw += 1.0 - isYZ.xy;\n  i0.z += isYZ.z;\n  i0.w += 1.0 - isYZ.z;\n\n  // i0 now contains the unique values 0,1,2,3 in each channel\n  vec4 i3 = clamp( i0, 0.0, 1.0 );\n  vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n  vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n  //  x0 = x0 - 0.0 + 0.0 * C.xxxx\n  //  x1 = x0 - i1  + 1.0 * C.xxxx\n  //  x2 = x0 - i2  + 2.0 * C.xxxx\n  //  x3 = x0 - i3  + 3.0 * C.xxxx\n  //  x4 = x0 - 1.0 + 4.0 * C.xxxx\n  vec4 x1 = x0 - i1 + C.xxxx;\n  vec4 x2 = x0 - i2 + C.yyyy;\n  vec4 x3 = x0 - i3 + C.zzzz;\n  vec4 x4 = x0 + C.wwww;\n\n// Permutations\n  i = mod289(i);\n  float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n  vec4 j1 = permute( permute( permute( permute (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n// Gradients: 7x7x6 points over a cube, mapped onto a 4-cross polytope\n// 7*7*6 = 294, which is close to the ring size 17*17 = 289.\n  vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n  vec4 p0 = grad4(j0,   ip);\n  vec4 p1 = grad4(j1.x, ip);\n  vec4 p2 = grad4(j1.y, ip);\n  vec4 p3 = grad4(j1.z, ip);\n  vec4 p4 = grad4(j1.w, ip);\n\n// Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n  p4 *= taylorInvSqrt(dot(p4,p4));\n\n// Mix contributions from the five corners\n  vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);\n  vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);\n  m0 = m0 * m0;\n  m1 = m1 * m1;\n  return 49.0 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 )))\n               + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;\n\n  }\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=e.packNormalToRGB="\n\tvec3 packNormalToRGB(const in vec3 normal) {\n\t  return normalize(normal) * 0.5 + 0.5;\n\t}\n";e.default={packNormalToRGB:r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.tonemapReinhard="\n\tvec3 tonemapReinhard(vec3 color) {\n\t  return color / (color + vec3(1.0));\n\t}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="\n\tfloat transpose(float m) {\n\t  return m;\n\t}\n\n\tmat2 transpose(mat2 m) {\n\t  return mat2(m[0][0], m[1][0],\n\t              m[0][1], m[1][1]);\n\t}\n\n\tmat3 transpose(mat3 m) {\n\t  return mat3(m[0][0], m[1][0], m[2][0],\n\t              m[0][1], m[1][1], m[2][1],\n\t              m[0][2], m[1][2], m[2][2]);\n\t}\n\n\tmat4 transpose(mat4 m) {\n\t  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\n\t              m[0][1], m[1][1], m[2][1], m[3][1],\n\t              m[0][2], m[1][2], m[2][2], m[3][2],\n\t              m[0][3], m[1][3], m[2][3], m[3][3]);\n\t}\n"},function(t,e,n){"use strict";function r(t,e){return o.webgl2?t:(("vertex"===e?v:d).forEach(function(e){t="function"==typeof e.replace?e.replace(t):t.replace(e.match,e.replace)}),t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;var i=n(0),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(6),s=function(t){return t&&t.__esModule?t:{default:t}}(a),u=function(t){return new RegExp("\\b"+t+"\\b","gi")},c=function(t){return new RegExp(""+t,"gi")},l=[{match:u("in"),replace:"attribute"},{match:u("out"),replace:"varying"}],f=[{match:u("in"),replace:"varying"},{match:c("out vec4 outgoingColor;"),replace:""},{match:u("outgoingColor"),replace:"gl_FragColor"},{match:u("texture"),replace:function(t){var e=new RegExp("\\btexture\\b","gi"),n=new RegExp("\\btexture\\b","i"),r=new RegExp(/texture\(([^)]+)\)/,"i"),i=t.match(e),o="";if(null===i)return t;for(var a=0;a<i.length;a++){var s=t.match(r)[0];if(s){var u=s.replace("texture(","").split(",")[0],c=t.match("(.*?) "+u,"i")[1];switch(c=c.split(" ")[1]){case"sampler2D":o="texture2D";break;case"samplerCube":o="textureCube"}}t=t.replace(n,o)}return t}}],h=[{match:c(s.default),replace:""}],v=[].concat(h,l),d=[].concat(h,f)},function(t,e,n){var r=n(5),i={};i.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.fromValues=function(t,e,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},i.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},i.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=n*a,t):null},i.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},i.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*c+o*l,t[3]=i*c+a*l,t},i.mul=i.multiply,i.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t},i.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=i*s,t[2]=o*u,t[3]=a*u,t},i.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},i.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},i.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},i.sub=i.subtract,i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-l)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))},i.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},i.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},t.exports=i},function(t,e,n){var r=n(5),i={};i.create=function(){var t=new r.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.fromValues=function(t,e,n,i,o,a){var s=new r.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s[4]=o,s[5]=a,s},i.set=function(t,e,n,r,i,o,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=n*o-r*i;return u?(u=1/u,t[0]=o*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*s-o*a)*u,t[5]=(r*a-n*s)*u,t):null},i.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=n[0],l=n[1],f=n[2],h=n[3],v=n[4],d=n[5];return t[0]=r*c+o*l,t[1]=i*c+a*l,t[2]=r*f+o*h,t[3]=i*f+a*h,t[4]=r*v+o*d+s,t[5]=i*v+a*d+u,t},i.mul=i.multiply,i.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=Math.sin(n),l=Math.cos(n);return t[0]=r*l+o*c,t[1]=i*l+a*c,t[2]=r*-c+o*l,t[3]=i*-c+a*l,t[4]=s,t[5]=u,t},i.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=n[0],l=n[1];return t[0]=r*c,t[1]=i*c,t[2]=o*l,t[3]=a*l,t[4]=s,t[5]=u,t},i.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=n[0],l=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*c+o*l+s,t[5]=i*c+a*l+u,t},i.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},i.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t},i.sub=i.subtract,i.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},i.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=e[0],l=e[1],f=e[2],h=e[3],v=e[4],d=e[5];return Math.abs(n-c)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-l)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-f)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-h)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(s-v)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-d)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))},t.exports=i},function(t,e,n){var r=n(5),i={scalar:{},SIMD:{}};i.create=function(){var t=new r.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.clone=function(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.fromValues=function(t,e,n,i,o,a,s,u,c,l,f,h,v,d,x,g){var m=new r.ARRAY_TYPE(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=i,m[4]=o,m[5]=a,m[6]=s,m[7]=u,m[8]=c,m[9]=l,m[10]=f,m[11]=h,m[12]=v,m[13]=d,m[14]=x,m[15]=g,m},i.set=function(t,e,n,r,i,o,a,s,u,c,l,f,h,v,d,x,g){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=f,t[11]=h,t[12]=v,t[13]=d,t[14]=x,t[15]=g,t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.scalar.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},i.SIMD.transpose=function(t,e){var n,r,i,o,a,s,u,c,l,f;return n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),a=SIMD.Float32x4.shuffle(n,r,0,1,4,5),s=SIMD.Float32x4.shuffle(i,o,0,1,4,5),u=SIMD.Float32x4.shuffle(a,s,0,2,4,6),c=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,c),a=SIMD.Float32x4.shuffle(n,r,2,3,6,7),s=SIMD.Float32x4.shuffle(i,o,2,3,6,7),l=SIMD.Float32x4.shuffle(a,s,0,2,4,6),f=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(t,8,l),SIMD.Float32x4.store(t,12,f),t},i.transpose=r.USE_SIMD?i.SIMD.transpose:i.scalar.transpose,i.scalar.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],v=e[11],d=e[12],x=e[13],g=e[14],m=e[15],p=n*s-r*a,y=n*u-i*a,M=n*c-o*a,b=r*u-i*s,w=r*c-o*s,_=i*c-o*u,E=l*x-f*d,P=l*g-h*d,I=l*m-v*d,S=f*g-h*x,D=f*m-v*x,T=h*m-v*g,O=p*T-y*D+M*S+b*I-w*P+_*E;return O?(O=1/O,t[0]=(s*T-u*D+c*S)*O,t[1]=(i*D-r*T-o*S)*O,t[2]=(x*_-g*w+m*b)*O,t[3]=(h*w-f*_-v*b)*O,t[4]=(u*I-a*T-c*P)*O,t[5]=(n*T-i*I+o*P)*O,t[6]=(g*M-d*_-m*y)*O,t[7]=(l*_-h*M+v*y)*O,t[8]=(a*D-s*I+c*E)*O,t[9]=(r*I-n*D-o*E)*O,t[10]=(d*w-x*M+m*p)*O,t[11]=(f*M-l*w-v*p)*O,t[12]=(s*P-a*S-u*E)*O,t[13]=(n*S-r*P+i*E)*O,t[14]=(x*y-d*b-g*p)*O,t[15]=(l*b-f*y+h*p)*O,t):null},i.SIMD.invert=function(t,e){var n,r,i,o,a,s,u,c,l,f,h=SIMD.Float32x4.load(e,0),v=SIMD.Float32x4.load(e,4),d=SIMD.Float32x4.load(e,8),x=SIMD.Float32x4.load(e,12);return a=SIMD.Float32x4.shuffle(h,v,0,1,4,5),r=SIMD.Float32x4.shuffle(d,x,0,1,4,5),n=SIMD.Float32x4.shuffle(a,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,a,1,3,5,7),a=SIMD.Float32x4.shuffle(h,v,2,3,6,7),o=SIMD.Float32x4.shuffle(d,x,2,3,6,7),i=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.mul(i,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.mul(r,a),u=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),a=SIMD.Float32x4.mul(r,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),s),l=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,a)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),s),c=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,a)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),a=SIMD.Float32x4.mul(n,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),c),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),l),a=SIMD.Float32x4.swizzle(a,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),c),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(i,a)),a=SIMD.Float32x4.mul(n,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,a)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),c),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.mul(n,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,a)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),l),f=SIMD.Float32x4.mul(n,s),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),a=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(a,a),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(a,a))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,c)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,l)),t):null},i.invert=r.USE_SIMD?i.SIMD.invert:i.scalar.invert,i.scalar.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],v=e[11],d=e[12],x=e[13],g=e[14],m=e[15];return t[0]=s*(h*m-v*g)-f*(u*m-c*g)+x*(u*v-c*h),t[1]=-(r*(h*m-v*g)-f*(i*m-o*g)+x*(i*v-o*h)),t[2]=r*(u*m-c*g)-s*(i*m-o*g)+x*(i*c-o*u),t[3]=-(r*(u*v-c*h)-s*(i*v-o*h)+f*(i*c-o*u)),t[4]=-(a*(h*m-v*g)-l*(u*m-c*g)+d*(u*v-c*h)),t[5]=n*(h*m-v*g)-l*(i*m-o*g)+d*(i*v-o*h),t[6]=-(n*(u*m-c*g)-a*(i*m-o*g)+d*(i*c-o*u)),t[7]=n*(u*v-c*h)-a*(i*v-o*h)+l*(i*c-o*u),t[8]=a*(f*m-v*x)-l*(s*m-c*x)+d*(s*v-c*f),t[9]=-(n*(f*m-v*x)-l*(r*m-o*x)+d*(r*v-o*f)),t[10]=n*(s*m-c*x)-a*(r*m-o*x)+d*(r*c-o*s),t[11]=-(n*(s*v-c*f)-a*(r*v-o*f)+l*(r*c-o*s)),t[12]=-(a*(f*g-h*x)-l*(s*g-u*x)+d*(s*h-u*f)),t[13]=n*(f*g-h*x)-l*(r*g-i*x)+d*(r*h-i*f),t[14]=-(n*(s*g-u*x)-a*(r*g-i*x)+d*(r*u-i*s)),t[15]=n*(s*h-u*f)-a*(r*h-i*f)+l*(r*u-i*s),t},i.SIMD.adjoint=function(t,e){var n,r,i,o,a,s,u,c,l,f,h,v,d,n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return l=SIMD.Float32x4.shuffle(n,r,0,1,4,5),s=SIMD.Float32x4.shuffle(i,o,0,1,4,5),a=SIMD.Float32x4.shuffle(l,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,l,1,3,5,7),l=SIMD.Float32x4.shuffle(n,r,2,3,6,7),c=SIMD.Float32x4.shuffle(i,o,2,3,6,7),u=SIMD.Float32x4.shuffle(l,c,0,2,4,6),c=SIMD.Float32x4.shuffle(c,l,1,3,5,7),l=SIMD.Float32x4.mul(u,c),l=SIMD.Float32x4.swizzle(l,1,0,3,2),f=SIMD.Float32x4.mul(s,l),h=SIMD.Float32x4.mul(a,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,l),f),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,l),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),l=SIMD.Float32x4.mul(s,u),l=SIMD.Float32x4.swizzle(l,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),f),d=SIMD.Float32x4.mul(a,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(c,l)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,l),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),l=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),c),l=SIMD.Float32x4.swizzle(l,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),f),v=SIMD.Float32x4.mul(a,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,l)),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,l),v),v=SIMD.Float32x4.swizzle(v,2,3,0,1),l=SIMD.Float32x4.mul(a,s),l=SIMD.Float32x4.swizzle(l,1,0,3,2),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),v),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,l),d),l=SIMD.Float32x4.swizzle(l,2,3,0,1),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,l),v),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(u,l)),l=SIMD.Float32x4.mul(a,c),l=SIMD.Float32x4.swizzle(l,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,l)),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),v),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),h),v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(s,l)),l=SIMD.Float32x4.mul(a,u),l=SIMD.Float32x4.swizzle(l,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,l)),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(c,l)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),d),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,h),SIMD.Float32x4.store(t,8,v),SIMD.Float32x4.store(t,12,d),t},i.adjoint=r.USE_SIMD?i.SIMD.adjoint:i.scalar.adjoint,i.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],v=t[12],d=t[13],x=t[14],g=t[15];return(e*a-n*o)*(f*g-h*x)-(e*s-r*o)*(l*g-h*d)+(e*u-i*o)*(l*x-f*d)+(n*s-r*a)*(c*g-h*v)-(n*u-i*a)*(c*x-f*v)+(r*u-i*s)*(c*d-l*v)},i.SIMD.multiply=function(t,e,n){var r=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(n,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),a))));SIMD.Float32x4.store(t,0,u);var c=SIMD.Float32x4.load(n,4),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),a))));SIMD.Float32x4.store(t,4,l);var f=SIMD.Float32x4.load(n,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),a))));SIMD.Float32x4.store(t,8,h);var v=SIMD.Float32x4.load(n,12),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(v,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(v,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(v,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(v,3,3,3,3),a))));return SIMD.Float32x4.store(t,12,d),t},i.scalar.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],v=e[10],d=e[11],x=e[12],g=e[13],m=e[14],p=e[15],y=n[0],M=n[1],b=n[2],w=n[3];return t[0]=y*r+M*s+b*f+w*x,t[1]=y*i+M*u+b*h+w*g,t[2]=y*o+M*c+b*v+w*m,t[3]=y*a+M*l+b*d+w*p,y=n[4],M=n[5],b=n[6],w=n[7],t[4]=y*r+M*s+b*f+w*x,t[5]=y*i+M*u+b*h+w*g,t[6]=y*o+M*c+b*v+w*m,t[7]=y*a+M*l+b*d+w*p,y=n[8],M=n[9],b=n[10],w=n[11],t[8]=y*r+M*s+b*f+w*x,t[9]=y*i+M*u+b*h+w*g,t[10]=y*o+M*c+b*v+w*m,t[11]=y*a+M*l+b*d+w*p,y=n[12],M=n[13],b=n[14],w=n[15],t[12]=y*r+M*s+b*f+w*x,t[13]=y*i+M*u+b*h+w*g,t[14]=y*o+M*c+b*v+w*m,t[15]=y*a+M*l+b*d+w*p,t},i.multiply=r.USE_SIMD?i.SIMD.multiply:i.scalar.multiply,i.mul=i.multiply,i.scalar.translate=function(t,e,n){var r,i,o,a,s,u,c,l,f,h,v,d,x=n[0],g=n[1],m=n[2];return e===t?(t[12]=e[0]*x+e[4]*g+e[8]*m+e[12],t[13]=e[1]*x+e[5]*g+e[9]*m+e[13],t[14]=e[2]*x+e[6]*g+e[10]*m+e[14],t[15]=e[3]*x+e[7]*g+e[11]*m+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],v=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=v,t[11]=d,t[12]=r*x+s*g+f*m+e[12],t[13]=i*x+u*g+h*m+e[13],t[14]=o*x+c*g+v*m+e[14],t[15]=a*x+l*g+d*m+e[15]),t},i.SIMD.translate=function(t,e,n){var r=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,0,0,0,0)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(r,SIMD.Float32x4.add(i,SIMD.Float32x4.add(o,a)));return SIMD.Float32x4.store(t,12,u),t},i.translate=r.USE_SIMD?i.SIMD.translate:i.scalar.translate,i.scalar.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.SIMD.scale=function(t,e,n){var r,i,o,a=SIMD.Float32x4(n[0],n[1],n[2],0);return r=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(a,0,0,0,0))),i=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(a,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(a,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.scale=r.USE_SIMD?i.SIMD.scale:i.scalar.scale,i.rotate=function(t,e,n,i){var o,a,s,u,c,l,f,h,v,d,x,g,m,p,y,M,b,w,_,E,P,I,S,D,T=i[0],O=i[1],F=i[2],z=Math.sqrt(T*T+O*O+F*F);return Math.abs(z)<r.EPSILON?null:(z=1/z,T*=z,O*=z,F*=z,o=Math.sin(n),a=Math.cos(n),s=1-a,u=e[0],c=e[1],l=e[2],f=e[3],h=e[4],v=e[5],d=e[6],x=e[7],g=e[8],m=e[9],p=e[10],y=e[11],M=T*T*s+a,b=O*T*s+F*o,w=F*T*s-O*o,_=T*O*s-F*o,E=O*O*s+a,P=F*O*s+T*o,I=T*F*s+O*o,S=O*F*s-T*o,D=F*F*s+a,t[0]=u*M+h*b+g*w,t[1]=c*M+v*b+m*w,t[2]=l*M+d*b+p*w,t[3]=f*M+x*b+y*w,t[4]=u*_+h*E+g*P,t[5]=c*_+v*E+m*P,t[6]=l*_+d*E+p*P,t[7]=f*_+x*E+y*P,t[8]=u*I+h*S+g*D,t[9]=c*I+v*S+m*D,t[10]=l*I+d*S+p*D,t[11]=f*I+x*S+y*D,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},i.scalar.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r,t},i.SIMD.rotateX=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(o,r))),t},i.rotateX=r.USE_SIMD?i.SIMD.rotateX:i.scalar.rotateX,i.scalar.rotateY=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-f*r,t[3]=u*i-h*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+f*i,t[11]=u*r+h*i,t},i.SIMD.rotateY=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,i))),t},i.rotateY=r.USE_SIMD?i.SIMD.rotateY:i.scalar.rotateY,i.scalar.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r,t},i.SIMD.rotateZ=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(o,r))),t},i.rotateZ=r.USE_SIMD?i.SIMD.rotateZ:i.scalar.rotateZ,i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotation=function(t,e,n){var i,o,a,s=n[0],u=n[1],c=n[2],l=Math.sqrt(s*s+u*u+c*c);return Math.abs(l)<r.EPSILON?null:(l=1/l,s*=l,u*=l,c*=l,i=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=s*s*a+o,t[1]=u*s*a+c*i,t[2]=c*s*a-u*i,t[3]=0,t[4]=s*u*a-c*i,t[5]=u*u*a+o,t[6]=c*u*a+s*i,t[7]=0,t[8]=s*c*a+u*i,t[9]=u*c*a-s*i,t[10]=c*c*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},i.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotationTranslation=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,c=o+o,l=r*s,f=r*u,h=r*c,v=i*u,d=i*c,x=o*c,g=a*s,m=a*u,p=a*c;return t[0]=1-(v+x),t[1]=f+p,t[2]=h-m,t[3]=0,t[4]=f-p,t[5]=1-(l+x),t[6]=d+g,t[7]=0,t[8]=h+m,t[9]=d-g,t[10]=1-(l+v),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},i.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},i.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},i.fromRotationTranslationScale=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,l=a+a,f=i*u,h=i*c,v=i*l,d=o*c,x=o*l,g=a*l,m=s*u,p=s*c,y=s*l,M=r[0],b=r[1],w=r[2];return t[0]=(1-(d+g))*M,t[1]=(h+y)*M,t[2]=(v-p)*M,t[3]=0,t[4]=(h-y)*b,t[5]=(1-(f+g))*b,t[6]=(x+m)*b,t[7]=0,t[8]=(v+p)*w,t[9]=(x-m)*w,t[10]=(1-(f+d))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},i.fromRotationTranslationScaleOrigin=function(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,l=a+a,f=s+s,h=o*c,v=o*l,d=o*f,x=a*l,g=a*f,m=s*f,p=u*c,y=u*l,M=u*f,b=r[0],w=r[1],_=r[2],E=i[0],P=i[1],I=i[2];return t[0]=(1-(x+m))*b,t[1]=(v+M)*b,t[2]=(d-y)*b,t[3]=0,t[4]=(v-M)*w,t[5]=(1-(h+m))*w,t[6]=(g+p)*w,t[7]=0,t[8]=(d+y)*_,t[9]=(g-p)*_,t[10]=(1-(h+x))*_,t[11]=0,t[12]=n[0]+E-(t[0]*E+t[4]*P+t[8]*I),t[13]=n[1]+P-(t[1]*E+t[5]*P+t[9]*I),t[14]=n[2]+I-(t[2]*E+t[6]*P+t[10]*I),t[15]=1,t},i.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,v=i*s,d=i*u,x=o*a,g=o*s,m=o*u;return t[0]=1-f-d,t[1]=l+m,t[2]=h-g,t[3]=0,t[4]=l-m,t[5]=1-c-d,t[6]=v+x,t[7]=0,t[8]=h+g,t[9]=v-x,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.frustum=function(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t},i.perspective=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t},i.perspectiveFromFieldOfView=function(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((a-s)*u)*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},i.ortho=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t},i.lookAt=function(t,e,n,o){var a,s,u,c,l,f,h,v,d,x,g=e[0],m=e[1],p=e[2],y=o[0],M=o[1],b=o[2],w=n[0],_=n[1],E=n[2];return Math.abs(g-w)<r.EPSILON&&Math.abs(m-_)<r.EPSILON&&Math.abs(p-E)<r.EPSILON?i.identity(t):(h=g-w,v=m-_,d=p-E,x=1/Math.sqrt(h*h+v*v+d*d),h*=x,v*=x,d*=x,a=M*d-b*v,s=b*h-y*d,u=y*v-M*h,x=Math.sqrt(a*a+s*s+u*u),x?(x=1/x,a*=x,s*=x,u*=x):(a=0,s=0,u=0),c=v*u-d*s,l=d*a-h*u,f=h*s-v*a,x=Math.sqrt(c*c+l*l+f*f),x?(x=1/x,c*=x,l*=x,f*=x):(c=0,l=0,f=0),t[0]=a,t[1]=c,t[2]=h,t[3]=0,t[4]=s,t[5]=l,t[6]=v,t[7]=0,t[8]=u,t[9]=f,t[10]=d,t[11]=0,t[12]=-(a*g+s*m+u*p),t[13]=-(c*g+l*m+f*p),t[14]=-(h*g+v*m+d*p),t[15]=1,t)},i.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},i.sub=i.subtract,i.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},i.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],v=t[10],d=t[11],x=t[12],g=t[13],m=t[14],p=t[15],y=e[0],M=e[1],b=e[2],w=e[3],_=e[4],E=e[5],P=e[6],I=e[7],S=e[8],D=e[9],T=e[10],O=e[11],F=e[12],z=e[13],A=e[14],R=e[15];return Math.abs(n-y)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-M)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-b)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-w)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-_)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(u-E)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-P)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(l-I)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(f-S)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(h-D)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(v-T)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(d-O)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(x-F)<=r.EPSILON*Math.max(1,Math.abs(x),Math.abs(F))&&Math.abs(g-z)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(m-A)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(p-R)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(R))},t.exports=i},function(t,e,n){var r=n(5),i=n(31),o=n(32),a=n(33),s={};s.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(r,i,a){var u=o.dot(i,a);return u<-.999999?(o.cross(t,e,i),o.length(t)<1e-6&&o.cross(t,n,i),o.normalize(t,t),s.setAxisAngle(r,t,Math.PI),r):u>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(o.cross(t,i,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+u,s.normalize(r,r))}}(),s.setAxes=function(){var t=i.create();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=a.clone,s.fromValues=a.fromValues,s.copy=a.copy,s.set=a.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},s.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},s.add=a.add,s.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+a*s+i*c-o*u,t[1]=i*l+a*u+o*s-r*c,t[2]=o*l+a*c+r*u-i*s,t[3]=a*l-r*s-i*u-o*c,t},s.mul=s.multiply,s.scale=a.scale,s.rotateX=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t},s.rotateY=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t},s.rotateZ=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t},s.calculateW=function(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},s.dot=a.dot,s.lerp=a.lerp,s.slerp=function(t,e,n,r){var i,o,a,s,u,c=e[0],l=e[1],f=e[2],h=e[3],v=n[0],d=n[1],x=n[2],g=n[3];return o=c*v+l*d+f*x+h*g,o<0&&(o=-o,v=-v,d=-d,x=-x,g=-g),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),t[0]=s*c+u*v,t[1]=s*l+u*d,t[2]=s*f+u*x,t[3]=s*h+u*g,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(n,r,i,o,a,u){return s.slerp(t,r,a,u),s.slerp(e,i,o,u),s.slerp(n,t,e,2*u*(1-u)),n}}(),s.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=a.length,s.len=s.length,s.squaredLength=a.squaredLength,s.sqrLen=s.squaredLength,s.normalize=a.normalize,s.fromMat3=function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.exactEquals=a.exactEquals,s.equals=a.equals,t.exports=s},function(t,e,n){var r=n(5),i={};i.create=function(){var t=new r.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},i.fromValues=function(t,e){var n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},i.set=function(t,e,n){return t[0]=e,t[1]=n,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},i.div=i.divide,i.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},i.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},i.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},i.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},i.normalize=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},i.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},i.lerp=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t},i.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},i.transformMat2=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t},i.transformMat2d=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t},i.transformMat3=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t},i.transformMat4=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},i.forEach=function(){var t=i.create();return function(e,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}(),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},i.equals=function(t,e){var n=t[0],i=t[1],o=e[0],a=e[1];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))},t.exports=i},function(t,e){t.exports={name:"ixviii.medium",version:"0.1.0",description:"Personal webgl toolkit.",main:"lib/ixviii.medium.js",scripts:{start:"concurrently 'npm run server' 'npm run examples:js' 'npm run examples:html'",server:"live-server ./examples --port 3000 --quiet --watch ./examples --watch ./src --wait 0","examples:js":"webpack --config webpack.config.examples.js --colors --watch","examples:html":"npm run examples:files; pug --obj ./examples/files.json --watch ./examples/src/templates/*.pug --out ./examples","examples:files":"node ./examples/files; pug --obj ./examples/files.json ./examples/src/templates/*.pug --out ./examples;","examples:build":"webpack --config webpack.config.examples.js --colors; npm run examples:files; pug --obj ./examples/files.json ./examples/src/templates/*.pug --out ./examples",build:"npm run lint; webpack --config webpack.config.build.js --colors; NODE_ENV=production webpack --config webpack.config.build.js --colors",prepublish:"npm run build",lint:"tslint ./src/**/*.ts",docs:"typedoc --target es6 --tsconfig ./tsconfig.json --ignoreCompilerErrors --theme default --name Medium --out ./docs ./src"},"pre-push":["lint"],repository:{type:"git",url:"https://github.com/ixviii/medium.git"},author:"Amelie Rosser <mail@ixviii.co.uk> (https://www.ixviii.io)",license:"MIT",bugs:{url:"https://github.com/ixviii/medium/issues"},homepage:"https://github.com/ixviii/medium",devDependencies:{"@types/webgl2":"0.0.0","babel-cli":"^6.6.5","babel-loader":"^6.2.4","babel-preset-es2015":"^6.6.0","babel-preset-stage-0":"^6.16.0",concurrently:"^3.1.0","dat-gui":"^0.5.0","json-loader":"^0.5.4","live-server":"^1.2.0","pre-push":"^0.1.1","pug-cli":"^1.0.0-alpha6","query-string":"^4.3.1","ts-loader":"^2.0.1",tslint:"^5.0.0",typedoc:"^0.5.7",typescript:"^2.2.1",webpack:"^2.2.1"},dependencies:{"gl-matrix":"^2.3.2",happens:"^0.6.0","parse-hdr":"^1.0.0","webgl-obj-loader":"^0.1.1"}}},function(t,e){function n(t,e,n,r,i,o){function a(e){var n=0;do{e[n++]=t[r]}while(++r<d&&n<e.length);return n}function s(e,n,i){var o=0;do{e[n+o++]=t[r]}while(++r<d&&o<i);return o}for(var u,c,l,f=new Array(4),h=null,v=new Array(2),d=t.length;o>0;){if(a(f)<f.length)throw new Error("Error reading bytes: expected "+f.length);if(2!=f[0]||2!=f[1]||0!=(128&f[2]))return e[n++]=f[0],e[n++]=f[1],e[n++]=f[2],e[n++]=f[3],void function(t,e,n,r){var i=4*r,o=s(e,n,i);if(o<i)throw new Error("Error reading raw pixels: got "+o+" bytes, expected "+i)}(0,e,n,i*o-1);if(((255&f[2])<<8|255&f[3])!=i)throw new Error("Wrong scanline width "+((255&f[2])<<8|255&f[3])+", expected "+i);null==h&&(h=new Array(4*i)),u=0;for(var x=0;x<4;x++)for(c=(x+1)*i;u<c;){if(a(v)<v.length)throw new Error("Error reading 2-byte buffer");if((255&v[0])>128){if(0==(l=(255&v[0])-128)||l>c-u)throw new Error("Bad scanline data");for(;l-- >0;)h[u++]=v[1]}else{if(0==(l=255&v[0])||l>c-u)throw new Error("Bad scanline data");if(h[u++]=v[1],--l>0){if(s(h,u,l)<l)throw new Error("Error reading non-run data");u+=l}}}for(var x=0;x<i;x++)e[n+0]=h[x],e[n+1]=h[x+i],e[n+2]=h[x+2*i],e[n+3]=h[x+3*i],n+=4;o--}}function r(t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));for(var e=0,r=t.length,c=10,l=0,f=0,h=1,v=!1,d=0;d<20;d++){var x,g=function(){var n="";do{var i=t[e];if(i==c){++e;break}n+=String.fromCharCode(i)}while(++e<r);return n}();if(x=g.match(i));else if(x=g.match(s))v=!0;else if(x=g.match(a))h=Number(x[1]);else if(x=g.match(o));else if(x=g.match(u)){f=Number(x[1]),l=Number(x[2]);break}}if(!v)throw new Error("File is not run length encoded!");var m=new Uint8Array(l*f*4);n(t,m,0,e,l,f);for(var p=new Float32Array(l*f*4),y=0;y<m.length;y+=4){var M=m[y+0]/255,b=m[y+1]/255,w=m[y+2]/255,_=m[y+3],E=Math.pow(2,_-128);M*=E,b*=E,w*=E;var P=y;p[P+0]=M,p[P+1]=b,p[P+2]=w,p[P+3]=1}return{shape:[l,f],exposure:h,gamma:1,data:p}}var i="#\\?RADIANCE",o="#.*",a="EXPOSURE=\\s*([0-9]*[.][0-9]*)",s="FORMAT=32-bit_rle_rgbe",u="-Y ([0-9]+) \\+X ([0-9]+)";t.exports=r},function(t,e,n){!function(e){"use strict";var n={};t.exports=n,n.Mesh=function(t){var e=[],n=[],r=[],i={};i.verts=[],i.norms=[],i.textures=[],i.hashindices={},i.indices=[],i.index=0;for(var o=t.split("\n"),a=/^v\s/,s=/^vn\s/,u=/^vt\s/,c=/^f\s/,l=0;l<o.length;l++){var f=o[l].trim(),h=f.split(/\s+/);if(h.shift(),a.test(f))e.push.apply(e,h);else if(s.test(f))n.push.apply(n,h);else if(u.test(f))r.push.apply(r,h);else if(c.test(f))for(var v=!1,d=0,x=h.length;d<x;d++){if(3!==d||v||(d=2,v=!0),h[d]in i.hashindices)i.indices.push(i.hashindices[h[d]]);else{var g=h[d].split("/");i.verts.push(+e[3*(g[0]-1)+0]),i.verts.push(+e[3*(g[0]-1)+1]),i.verts.push(+e[3*(g[0]-1)+2]),r.length&&(i.textures.push(+r[2*(g[1]-1)+0]),i.textures.push(+r[2*(g[1]-1)+1])),i.norms.push(+n[3*(g[2]-1)+0]),i.norms.push(+n[3*(g[2]-1)+1]),i.norms.push(+n[3*(g[2]-1)+2]),i.hashindices[h[d]]=i.index,i.indices.push(i.index),i.index+=1}3===d&&v&&i.indices.push(i.hashindices[h[0]])}}this.vertices=i.verts,this.vertexNormals=i.norms,this.textures=i.textures,this.indices=i.indices};var r=function(){var t=this;this.xmlhttp=new XMLHttpRequest,this.get=function(e,n){t.xmlhttp.onreadystatechange=function(){4===t.xmlhttp.readyState&&n(t.xmlhttp.responseText,t.xmlhttp.status)},t.xmlhttp.open("GET",e,!0),t.xmlhttp.send()}};n.downloadMeshes=function(t,e,i){var o=Object.keys(t).length,a=!1;void 0===i&&(i={});for(var s in t)t.hasOwnProperty(s)&&(new r).get(t[s],function(t){return function(r,s){if(200===s?i[t]=new n.Mesh(r):(a=!0,console.error('An error has occurred and the mesh "'+t+'" could not be downloaded.')),0===--o){if(a)throw console.error("An error has occurred and one or meshes has not been downloaded. The execution of the script has terminated."),"";e(i)}}}(s))};var i=function(t,e,n,r){var i=t.createBuffer(),o=e===t.ARRAY_BUFFER?Float32Array:Uint16Array;return t.bindBuffer(e,i),t.bufferData(e,new o(n),t.STATIC_DRAW),i.itemSize=r,i.numItems=n.length/r,i};n.initMeshBuffers=function(t,e){e.normalBuffer=i(t,t.ARRAY_BUFFER,e.vertexNormals,3),e.textureBuffer=i(t,t.ARRAY_BUFFER,e.textures,2),e.vertexBuffer=i(t,t.ARRAY_BUFFER,e.vertices,3),e.indexBuffer=i(t,t.ELEMENT_ARRAY_BUFFER,e.indices,1)},n.deleteMeshBuffers=function(t,e){t.deleteBuffer(e.normalBuffer),t.deleteBuffer(e.textureBuffer),t.deleteBuffer(e.vertexBuffer),t.deleteBuffer(e.indexBuffer)}}()}]);
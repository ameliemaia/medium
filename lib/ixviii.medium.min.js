var _Mathtan=Math.tan,_Mathround=Math.round,_Mathfloor=Math.floor,_Mathceil=Math.ceil,_Mathpow=Math.pow,_Mathatan=Math.atan2,_Mathsqrt=Math.sqrt,_Mathcos=Math.cos,_Mathsin=Math.sin,_Mathacos=Math.acos,_Mathmin=Math.min,_Mathmax=Math.max,_Mathabs=Math.abs,_MathPI=Math.PI;module.exports=function(h){function F(I){if(T[I])return T[I].exports;var N=T[I]={i:I,l:!1,exports:{}};return h[I].call(N.exports,N,N.exports,F),N.l=!0,N.exports}var T={};return F.m=h,F.c=T,F.i=function(I){return I},F.d=function(I,N,P){F.o(I,N)||Object.defineProperty(I,N,{configurable:!1,enumerable:!0,get:P})},F.n=function(I){var N=I&&I.__esModule?function(){return I['default']}:function(){return I};return F.d(N,'a',N),N},F.o=function(I,N){return Object.prototype.hasOwnProperty.call(I,N)},F.p='',F(F.s=68)}([function(h,F,T){'use strict';function P(H,W,Z=!1){const K=V.createBuffer(),Q=Z?V.DYNAMIC_DRAW:V.STATIC_DRAW,J=H===V.ARRAY_BUFFER?Float32Array:Uint16Array;return V.bindBuffer(H,K),V instanceof WebGL2RenderingContext?V.bufferData(H,new J(W),Q,0):V.bufferData(H,new J(W),Q),V.bindBuffer(H,null),K}function O(H){const W=V.createBuffer();return!!(V instanceof WebGL2RenderingContext)&&(V.bindBuffer(V.UNIFORM_BUFFER,W),V.bufferData(V.UNIFORM_BUFFER,new Float32Array(H),V.DYNAMIC_DRAW),V.bindBuffer(V.UNIFORM_BUFFER,null),W)}Object.defineProperty(F,'__esModule',{value:!0});var X=T(7);F.set=function(H,W){V=H,Y=W,G=Y===X.WEBGL2_CONTEXT},F.get=function(){return V},T.d(F,'webgl2',function(){return G}),T.d(F,'createBuffer',function(){return P}),T.d(F,'createUniformBuffer',function(){return O});let V,Y,G},function(h,F,T){F.glMatrix=T(6),F.mat2=T(82),F.mat2d=T(83),F.mat3=T(37),F.mat4=T(84),F.quat=T(85),F.vec2=T(86),F.vec3=T(38),F.vec4=T(39)},function(h,F,T){'use strict';var I=T(1),N=T.n(I);class P{constructor(O=0,X=0,V=0){return this.v=I.vec3.create(),this.set(O,X,V),this}set x(O){this.v[0]=O}get x(){return this.v[0]}set y(O){this.v[1]=O}get y(){return this.v[1]}set z(O){this.v[2]=O}get z(){return this.v[2]}set(O,X,V){return I.vec3.set(this.v,O,X,V),this}clone(){return new P(this.v[0],this.v[1],this.v[2])}copy(O){return I.vec3.copy(this.v,O.v),this}add(O){return I.vec3.add(this.v,this.v,O.v),this}subtract(O){return I.vec3.subtract(this.v,this.v,O.v),this}subtractVectors(O,X){const V=I.vec3.create();return I.vec3.subtract(V,O.v,X.v),V}scale(O){return I.vec3.scale(this.v,this.v,O),this}distance(O){return I.vec3.distance(this.v,O.v)}length(){return I.vec3.length(this.v)}negate(){return I.vec3.negate(this.v,this.v),this}normalize(){return I.vec3.normalize(this.v,this.v),this}dot(O){return I.vec3.dot(this.v,O.v)}cross(O){return I.vec3.cross(this.v,this.v,O.v),this}crossVectors(O,X){const V=I.vec3.create();return I.vec3.cross(V,O.v,X.v),V}lerp(O,X){return I.vec3.lerp(this.v,this.v,O.v,X),this}equals(O){return I.vec3.equals(this.v,O.v)}}F.a=P},function(h,F,T){'use strict';function I(W,Z){if('highp'===Z){if(0<W.getShaderPrecisionFormat(W.VERTEX_SHADER,W.HIGH_FLOAT).precision&&0<W.getShaderPrecisionFormat(W.FRAGMENT_SHADER,W.HIGH_FLOAT).precision)return'highp';Z='mediump'}return'mediump'===Z&&0<W.getShaderPrecisionFormat(W.VERTEX_SHADER,W.MEDIUM_FLOAT).precision&&0<W.getShaderPrecisionFormat(W.FRAGMENT_SHADER,W.MEDIUM_FLOAT).precision?'mediump':'lowp'}function N(W){let Z=V.PRECISION;const K=I(W,Z);K!==Z&&(T.i(Y.a)('Capabilities:',Z,'not supported, using',K,'instead.'),Z=K);const Q=W.getParameter(W.MAX_TEXTURE_IMAGE_UNITS),J=W.getParameter(W.MAX_VERTEX_TEXTURE_IMAGE_UNITS),$=W.getParameter(W.MAX_TEXTURE_SIZE),ee=W.getParameter(W.MAX_CUBE_MAP_TEXTURE_SIZE),ae=W.getParameter(W.MAX_VERTEX_ATTRIBS),ie=W.getParameter(W.MAX_VERTEX_UNIFORM_VECTORS),re=W.getParameter(W.MAX_VARYING_VECTORS),oe=W.getParameter(W.MAX_FRAGMENT_UNIFORM_VECTORS);return{precision:Z,maxTextures:Q,maxPrecision:K,maxVertexTextures:J,maxTextureSize:$,maxCubemapSize:ee,maxAttributes:ae,maxVertexUniforms:ie,maxVaryings:re,maxFragmentUniforms:oe}}function P(W){const Z=X.webgl2||W.getExtension('OES_vertex_array_object')||!1,K=W.getExtension('ANGLE_instanced_arrays')||!1,Q=W.getExtension('OES_texture_float')||!1;return{angleInstancedArrays:K,vertexArrayObject:Z,textureFloat:Q}}Object.defineProperty(F,'__esModule',{value:!0});var X=T(0),V=T(7),Y=T(13);F.set=function(W){G=N(W),H=P(W)},T.d(F,'capabilities',function(){return G}),T.d(F,'extensions',function(){return H});let G={},H={}},function(h,F,T){'use strict';var I=T(0),N=T(25),P=T(67),O=T(2),X=T(16);let V,Y=[];F.a=class{constructor(H,W,Z,K,Q){V=I.get(),this.bufferVertices=H,this.bufferIndices=W,this.bufferNormals=Z,this.bufferUvs=K,this.bufferColors=Q,this.attributes={},this.attributesInstanced={},this.bufferVertices&&(this.addAttribute('aVertexPosition',V.ARRAY_BUFFER,this.bufferVertices,3),this.generateVertices()),this.bufferIndices&&(this.addAttribute('aIndex',V.ELEMENT_ARRAY_BUFFER,this.bufferIndices,1,!1),this.generateFaces()),this.bufferNormals&&this.addAttribute('aVertexNormal',V.ARRAY_BUFFER,this.bufferNormals,3),this.bufferUvs&&(this.addAttribute('aUv',V.ARRAY_BUFFER,this.bufferUvs,2),this.generateUvs()),this.bufferColors&&this.addAttribute('aVertexColor',V.ARRAY_BUFFER,this.bufferColors,3)}addAttribute(H,W,Z,K,Q){this.attributes[H]=new N.a(W,Z,K,Q)}addInstancedBufferAttribute(H,W,Z){this.attributesInstanced[H]=new N.a(V.ARRAY_BUFFER,W,Z)}generateVertices(){this.vertices=[];for(let H=0;H<this.bufferVertices.length;H+=3){const W=this.bufferVertices[H],Z=this.bufferVertices[H+1],K=this.bufferVertices[H+2],Q=new O.a(W,Z,K);this.vertices.push(Q)}}generateFaces(){this.faces=[];for(let H=0;H<this.bufferIndices.length;H+=3){const W=this.bufferIndices[H],Z=this.bufferIndices[H+1],K=this.bufferIndices[H+2],Q=this.vertices[W],J=this.vertices[Z],$=this.vertices[K],ee=new P.a(W,Z,K,Q,J,$);this.faces.push(ee)}}generateUvs(){this.uvs=[];for(let H=0;H<this.bufferUvs.length;H+=2){const W=this.bufferUvs[H],Z=this.bufferUvs[H+1],K=new X.a(W,Z);this.uvs.push(K)}}updateVertices(){V=I.get(),this.vertices.forEach((H,W)=>{this.bufferVertices.set(H.v,W*H.v.length)}),this.attributes.aVertexPosition.update(this.bufferVertices)}updateNormals(){const H=[];this.faces.forEach((W)=>{W.updateFaceNormal(),H[W.indices[0]]=W.normal.v,H[W.indices[1]]=W.normal.v,H[W.indices[2]]=W.normal.v}),Y=[],H.forEach((W)=>{Y=Y.concat(...W)}),this.bufferNormals.set(Y),this.attributes.aVertexNormal.update(this.bufferNormals)}dispose(){V=I.get(),Object.keys(this.attributes).forEach((H)=>{this.attributes[H].dispose(V),delete this.attributes[H]}),Object.keys(this.attributesInstanced).forEach((H)=>{this.attributesInstanced[H].dispose(V),delete this.attributesInstanced[H]}),delete this.attributes,delete this.attributesInstanced,this.bufferVertices=null,this.bufferIndices=null,this.bufferNormals=null,this.bufferUvs=null,this.bufferColors=null}}},function(h,F){'use strict';F.a='#version 300 es'},function(h){var T={};T.EPSILON=1e-6,T.ARRAY_TYPE='undefined'==typeof Float32Array?Array:Float32Array,T.RANDOM=Math.random,T.ENABLE_SIMD=!1,T.SIMD_AVAILABLE=T.ARRAY_TYPE===Float32Array&&'SIMD'in this,T.USE_SIMD=T.ENABLE_SIMD&&T.SIMD_AVAILABLE,T.setMatrixArrayType=function(N){T.ARRAY_TYPE=N};T.toRadian=function(N){return N*(_MathPI/180)},T.equals=function(N,P){return _Mathabs(N-P)<=T.EPSILON*_Mathmax(1,_Mathabs(N),_Mathabs(P))},h.exports=T},function(h,F){'use strict';Object.defineProperty(F,'__esModule',{value:!0});F.WEBGL_CONTEXT='webgl';const N='webgl2';F.WEBGL2_CONTEXT=N;F.RENDERER_DEFAULT_CONTEXT=N;const O=1280;F.RENDERER_DEFAULT_WIDTH=O;const X=720;F.RENDERER_DEFAULT_HEIGHT=X;F.RENDERER_DEFAULT_RATIO=O/X;F.PRECISION='highp';F.CULL_NONE=-1;F.CULL_BACK=1029;F.CULL_FRONT=1028;F.CULL_FRONT_AND_BACK=1032;F.DRAW_POINTS=0;F.DRAW_LINES=1;F.DRAW_LINE_LOOP=2;F.DRAW_LINE_STRIP=3;F.DRAW_TRIANGLES=4;F.UNIFORM_PROJECTION_VIEW_LOCATION=0;F.UNIFORM_DIRECTIONAL_LIGHTS_LOCATION=1;F.UNIFORM_SPOT_LIGHTS_LOCATION=2},function(h,F,T){'use strict';var I=T(0),N=T(23),P=T(24),O=T(3);let X;class V extends N.a{constructor(Y,G){super(),this.geometry=Y,this.shader=G,this.vao=new P.a,this.visible=!0,this.instanceCount=0,this.shader.program.created||this.shader.create(this.geometry),this.isInstanced=!1,X=I.get(),this.vao.bind(),this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer(),this.vao.unbind()}setInstanceCount(Y){X=I.get(),this.instanceCount=Y,this.isInstanced=!0}bindAttributes(){Object.keys(this.geometry.attributes).forEach((Y)=>{'aIndex'!==Y&&(this.shader.program.setAttributeLocation(Y),this.geometry.attributes[Y].bind(),this.shader.program.setAttributePointer(Y,this.geometry.attributes[Y].itemSize))})}bindAttributesInstanced(){Object.keys(this.geometry.attributesInstanced).forEach((Y)=>{'aIndex'!==Y&&(this.shader.program.setAttributeLocation(Y),this.geometry.attributesInstanced[Y].bind(),this.shader.program.setAttributeInstancedPointer(Y,this.geometry.attributesInstanced[Y].itemSize),X instanceof WebGL2RenderingContext?X.vertexAttribDivisor(this.shader.program.attributeLocations[Y],1):O.extensions.angleInstancedArrays.vertexAttribDivisorANGLE(this.shader.program.attributeLocations[Y],1))})}bindIndexBuffer(){this.geometry.bufferIndices&&this.geometry.attributes.aIndex.bind()}draw(Y,G,H){this.visible&&(X=I.get(),this.updateMatrix(),this.shader.program.bind(),-1!==this.shader.culling&&(X.enable(X.CULL_FACE),X.cullFace(this.shader.culling)),this.shader.setUniforms(Y,G,this.modelMatrix,H),O.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),this.geometry.attributes.aIndex?X.drawElements(this.shader.drawType,this.geometry.attributes.aIndex.numItems,X.UNSIGNED_SHORT,0):X.drawArrays(this.shader.drawType,0,this.geometry.attributes.aVertexPosition.numItems),O.extensions.vertexArrayObject&&this.vao.unbind(),-1!==this.shader.culling&&X.disable(X.CULL_FACE))}drawInstance(Y,G,H){this.visible&&(X=I.get(),this.updateMatrix(),this.shader.program.bind(),this.shader.setUniforms(Y,G,this.modelMatrix,H),-1!==this.shader.culling&&(X.enable(X.CULL_FACE),X.cullFace(this.shader.culling)),O.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),X instanceof WebGL2RenderingContext?X.drawElementsInstanced(this.shader.drawType,this.geometry.attributes.aIndex.numItems,X.UNSIGNED_SHORT,0,this.instanceCount):O.extensions.angleInstancedArrays.drawElementsInstancedANGLE(this.shader.drawType,this.geometry.attributes.aIndex.numItems,X.UNSIGNED_SHORT,0,this.instanceCount),O.extensions.vertexArrayObject&&this.vao.unbind(),-1!==this.shader.culling&&X.disable(X.CULL_FACE))}dispose(){this.shader.dispose(),this.geometry.dispose(),this.vao.dispose(),this.geometry=null,this.shader=null,super.dispose()}}F.a=V},function(h,F,T){'use strict';var I=T(0),N=T(7),P=T(1),O=T.n(P),X=T(70),V=T(69),Y=T(79),G=T(12),H=T(3),W=T(15),Z=T(66);let K;const Q=P.mat3.create(),J=P.mat4.create(),$=P.mat4.create();F.a=class{constructor(ae){const ie=I.webgl2?X.a:X.b,re=I.webgl2?V.a:V.b;this.name='',this.uniforms={},this.hookVertexPre='',this.hookVertexMain='',this.hookVertexEnd='',this.hookFragmentPre='',this.hookFragmentMain='',this.hookFragmentEnd='',this.vertexShader=ie,this.fragmentShader=re,this.drawType=N.DRAW_TRIANGLES,this.directionalLights=void 0,this.pointLights=void 0,this.culling=N.CULL_NONE,Object.assign(this,ae),this.program=new Z.a}create(ae,ie){K=I.get(),this.vertexShader=this._processShader(this.vertexShader,'vertex',ae),this.fragmentShader=this._processShader(this.fragmentShader,'fragment',ae),this.program.link(this.vertexShader,this.fragmentShader,ie),this.customUniforms=this.uniforms||{},I.webgl2&&this.program.setUniformBlockLocation('ProjectionView',W['default'].projectionView.buffer,N.UNIFORM_PROJECTION_VIEW_LOCATION),this.directionalLights&&(I.webgl2?this.program.setUniformBlockLocation('DirectionalLights',this.directionalLights.uniformBuffer.buffer,N.UNIFORM_DIRECTIONAL_LIGHTS_LOCATION):this.directionalLights.get().forEach((ne,se)=>{Object.keys(ne.uniforms).forEach((ue)=>{const ce=ne.uniforms[ue];this.customUniforms[`uDirectionalLights[${se}].${ue}`]=ce})})),this.pointLights&&(I.webgl2?this.program.setUniformBlockLocation('PointLights',this.pointLights.uniformBuffer.buffer,N.UNIFORM_SPOT_LIGHTS_LOCATION):this.pointLights.get().forEach((ne,se)=>{Object.keys(ne.uniforms).forEach((ue)=>{const ce=ne.uniforms[ue];this.customUniforms[`uPointLights[${se}].${ue}`]=ce})}));const re=[K.TEXTURE0,K.TEXTURE1,K.TEXTURE2,K.TEXTURE3,K.TEXTURE4,K.TEXTURE5];Object.keys(this.uniforms).forEach((ne,se)=>{switch(this.uniforms[ne].type){case't':case'tc':case't3d':{this.uniforms[ne].textureIndex=se,this.uniforms[ne].activeTexture=re[se];break}default:}}),this.uniforms.uCameraPosition===void 0&&this.pointLights&&(this.uniforms.uCameraPosition={type:'3f',value:[0,0,0]});const oe=I.webgl2?{}:{uProjectionMatrix:{type:'4fv',value:P.mat4.create(),location:null},uViewMatrix:{type:'4fv',value:P.mat4.create(),location:null}};this.uniforms=Object.assign({uViewMatrixInverse:{type:'4fv',value:P.mat4.create(),location:null},uModelMatrix:{type:'4fv',value:P.mat4.create(),location:null},uModelMatrixInverse:{type:'4fv',value:P.mat4.create(),location:null},uNormalMatrix:{type:'4fv',value:P.mat4.create(),location:null},uDiffuse:{type:'3f',value:new G.a().v,location:null}},this.customUniforms,oe),Object.keys(this.uniforms).forEach((ne)=>{this.program.setUniformLocation(this.uniforms,ne)})}_processShader(ae,ie,re){function oe(ue){ne+=`#define ${ue} \n`}K=I.get();let ne='';const se=`precision ${H.capabilities.precision} float;`;return re.bufferUvs&&oe('uv'),re.bufferColors&&oe('vertexColors'),re.bufferNormals&&oe('normals'),this.directionalLights&&oe('directionalLights'),this.pointLights&&oe('pointLights'),ae=ae.replace(/#HOOK_PRECISION/g,se),ae=ae.replace(/#HOOK_DEFINES/g,ne),ae=ae.replace(/#HOOK_VERTEX_PRE/g,this.hookVertexPre),ae=ae.replace(/#HOOK_VERTEX_MAIN/g,this.hookVertexMain),ae=ae.replace(/#HOOK_VERTEX_END/g,this.hookVertexEnd),ae=ae.replace(/#HOOK_FRAGMENT_PRE/g,this.hookFragmentPre),ae=ae.replace(/#HOOK_FRAGMENT_MAIN/g,this.hookFragmentMain),ae=ae.replace(/#HOOK_FRAGMENT_END/g,this.hookFragmentEnd),this.pointLights&&(ae=ae.replace(/#HOOK_POINT_LIGHTS/g,this.pointLights.length+'')),this.directionalLights&&(ae=ae.replace(/#HOOK_DIRECTIONAL_LIGHTS/g,this.directionalLights.length+'')),T.i(Y.a)(ae,ie)}setUniforms(ae,ie,re,oe){K=I.get(),Object.keys(this.customUniforms).forEach((ne)=>{const se=this.uniforms[ne];switch(se.type){case't':{K.uniform1i(se.location,se.textureIndex),K.activeTexture(se.activeTexture),K.bindTexture(K.TEXTURE_2D,se.value);break}case'tc':{K.uniform1i(se.location,se.textureIndex),K.activeTexture(se.activeTexture),K.bindTexture(K.TEXTURE_CUBE_MAP,se.value);break}case't3d':{K instanceof WebGL2RenderingContext&&(K.uniform1i(se.location,se.textureIndex),K.activeTexture(se.activeTexture),K.bindTexture(K.TEXTURE_3D,se.value));break}case'i':{K.uniform1i(se.location,se.value);break}case'f':{K.uniform1f(se.location,se.value);break}case'2f':{K.uniform2f(se.location,se.value[0],se.value[1]);break}case'3f':{K.uniform3f(se.location,se.value[0],se.value[1],se.value[2]);break}case'4f':{K.uniform4f(se.location,se.value[0],se.value[1],se.value[2],se.value[3]);break}case'1iv':{K.uniform1iv(se.location,se.value);break}case'2iv':{K.uniform2iv(se.location,se.value);break}case'1fv':{K.uniform1fv(se.location,se.value);break}case'2fv':{K.uniform2fv(se.location,se.value);break}case'3fv':{K.uniform3fv(se.location,se.value);break}case'4fv':{K.uniform4fv(se.location,se.value);break}case'Matrix3fv':{K.uniformMatrix3fv(se.location,!1,se.value);break}case'Matrix4fv':{K.uniformMatrix4fv(se.location,!1,se.value);break}default:}}),I.webgl2||(K.uniformMatrix4fv(this.uniforms.uProjectionMatrix.location,!1,ie),K.uniformMatrix4fv(this.uniforms.uViewMatrix.location,!1,ae)),P.mat4.identity(J),P.mat4.invert(J,ae),K.uniformMatrix4fv(this.uniforms.uViewMatrixInverse.location,!1,J),K.uniformMatrix4fv(this.uniforms.uModelMatrix.location,!1,re),P.mat4.identity($),P.mat4.invert($,re),K.uniformMatrix4fv(this.uniforms.uModelMatrixInverse.location,!1,$),P.mat3.identity(Q),P.mat3.fromMat4(Q,$),P.mat3.transpose(Q,Q),K.uniformMatrix3fv(this.uniforms.uNormalMatrix.location,!1,Q),K.uniform3f(this.uniforms.uDiffuse.location,this.uniforms.uDiffuse.value[0],this.uniforms.uDiffuse.value[1],this.uniforms.uDiffuse.value[2]),oe&&this.uniforms.uCameraPosition&&K.uniform3f(this.uniforms.uCameraPosition.location,oe.position.v[0],oe.position.v[1],oe.position.v[2])}dispose(){Object.keys(this.customUniforms).forEach((ae)=>{const ie=this.uniforms[ae];switch(ie.type){case't':case'tc':{K.deleteTexture(ie.value);break}default:}}),this.program.dispose()}}},function(h,F){'use strict';F.a=`
	uniform ProjectionView {
		mat4 projectionMatrix;
		mat4 viewMatrix;
	} uProjectionView;
`},function(h,F,T){'use strict';Object.defineProperty(F,'__esModule',{value:!0});var H=T(1),W=T.n(H),Z=T(16),K=T(2);F.degToRad=function(Q){return Q*(_MathPI/180)},F.radToDeg=function(Q){return Q*(180/_MathPI)},F.clamp=function(Q,J,$){return _Mathmax(_Mathmin(Q,$),J)},F.lerp=function(Q,J,$){return Q+(J-Q)*$},F.barycoordFromPoint=function(Q,J,$,ee){const ae=H.vec3.create(),ie=H.vec3.create(),re=H.vec3.create();H.vec3.sub(ae,ee,J),H.vec3.sub(ie,$,J),H.vec3.sub(re,Q,J);const oe=H.vec3.dot(ae,ae),ne=H.vec3.dot(ae,ie),se=H.vec3.dot(ae,re),ue=H.vec3.dot(ie,ie),ce=H.vec3.dot(ie,re),me=oe*ue-ne*ne,xe=new K.a;if(0==me)return xe.set(-2,-1,-1);const pe=1/me,ge=(ue*se-ne*ce)*pe,he=(oe*ce-ne*se)*pe;return xe.set(1-ge-he,he,ge)},F.randomSpherePoint=function(Q,J,$,ee){const ae=Math.random(),ie=Math.random(),re=2*_MathPI*ae,oe=_Mathacos(2*ie-1),ne=Q+ee*_Mathsin(oe)*_Mathcos(re),se=J+ee*_Mathsin(oe)*_Mathsin(re),ue=$+ee*_Mathcos(oe);return[ne,se,ue]},F.from3DTo2D=function(Q,J){const $=Q.x,ee=Q.y,ae=Q.z,ie=J[0]*$+J[4]*ee+J[8]*ae+J[12],re=J[1]*$+J[5]*ee+J[9]*ae+J[13],oe=J[3]*$+J[7]*ee+J[11]*ae+J[15],ne=new Z.a;return ne.x=(ie/oe+1)/2,ne.y=1-(re/oe+1)/2,ne},F.lookAt=function(Q,J,$){const ee=H.quat.create(),ae=H.vec3.create(),ie=H.vec3.create(),re=H.vec3.create();return H.vec3.sub(re,Q,J),0===H.vec3.squaredLength(re)&&(re[2]=1),H.vec3.normalize(re,re),H.vec3.cross(ae,$,re),0===H.vec3.squaredLength(ae)&&(re[2]+=1e-4,H.vec3.cross(ae,$,re)),H.vec3.normalize(ae,ae),H.vec3.cross(ie,re,ae),H.quat.setAxes(ee,re,ae,ie),H.quat.invert(ee,ee),ee}},function(h,F,T){'use strict';var I=T(1),N=T.n(I);class P{constructor(O=16777215){return this.v=I.vec3.create(),this.convert(O),this}set r(O){this.v[0]=O}get r(){return this.v[0]}set g(O){this.v[1]=O}get g(){return this.v[1]}set b(O){this.v[2]=O}get b(){return this.v[2]}set(O,X,V){return I.vec3.set(this.v,O,X,V),this}copy(O){return I.vec3.copy(this.v,I.vec3.fromValues(O[0],O[1],O[2])),this}convert(O){let X;return'number'==typeof O&&(X=this.hexIntToRgb(O)),'string'==typeof O&&(X=this.hexStringToRgb(O)),I.vec3.copy(this.v,this.normalize(X)),this}normalize(O){return I.vec3.fromValues(O[0]/255,O[1]/255,O[2]/255)}fromArray(O){this.set(O[0],O[1],O[2])}componentToHex(O){const X=O.toString(16);return 1===X.length?`0${X}`:X}rgbToHex(O,X,V){const Y=this.componentToHex(O),G=this.componentToHex(X),H=this.componentToHex(V);return`#${Y}${G}${H}`}hexIntToRgb(O){return I.vec3.fromValues(O>>16,255&O>>8,255&O)}hexStringToRgb(O){const X=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(O);return X?I.vec3.fromValues(parseInt(X[1],16),parseInt(X[2],16),parseInt(X[3],16)):null}}F.a=P},function(h,F){'use strict';const N=function(){return window.console&&console.log?Function.prototype.bind.call(console.log,console):function(){}}();F.b=N;const P=function(){return window.console&&console.clear?Function.prototype.bind.call(console.clear,console):function(){}}(),O=function(){return window.console&&console.debug?Function.prototype.bind.call(console.debug,console):function(){}}(),X=function(){return window.console&&console.info?Function.prototype.bind.call(console.info,console):function(){}}(),V=function(){return window.console&&console.warn?Function.prototype.bind.call(console.warn,console):function(){}}();F.a=V;(function(){return window.console&&console.error?Function.prototype.bind.call(console.error,console):function(){}})()},function(h){(function(I,N){h.exports=N()})(this,function(){'use strict';function I(P){var O=this instanceof I;if(P){if(!O)for(var X in I.prototype)P[X]=I.prototype[X];else throw new Error('You can\'t pass a target when instantiating with the `new` keyword');}else if(!O)return new I}function N(P){if(!(P&&P instanceof Function))throw new Error(P+' is not a Function')}return I.prototype.__init=function(P){var O=this.__listeners||(this.__listeners=[]);return O[P]||(O[P]=[])},I.prototype.on=function(P,O){N(O),this.__init(P).push(O)},I.prototype.off=function(P,O){var X=this.__init(P);X.splice(X.indexOf(O),1)},I.prototype.once=function(P,O){N(O);var X=this,V=function(){X.off(P,V),O.apply(this,arguments)};this.on(P,V)},I.prototype.emit=function(P){var X=this.__init(P).slice(0),O;for(O in X)X[O].apply(this,[].slice.call(arguments,1))},I})},function(h,F,T){'use strict';Object.defineProperty(F,'__esModule',{value:!0});var P=T(1),O=T.n(P),X=T(17);F.setup=function(){const G=new Float32Array([...P.mat4.create(),...P.mat4.create()]);V.projectionView=new X.a(G)},F.updateProjectionView=function(G,H,W){G.bindBufferBase(G.UNIFORM_BUFFER,0,V.projectionView.buffer),G.bindBuffer(G.UNIFORM_BUFFER,V.projectionView.buffer),Y=[...H,...W],V.projectionView.data.set(Y,0),G.bufferSubData(G.UNIFORM_BUFFER,0,V.projectionView.data),G.bindBuffer(G.UNIFORM_BUFFER,null)};const V={};let Y;F['default']=V},function(h,F,T){'use strict';var I=T(1),N=T.n(I);class P{constructor(O=0,X=0){return this.v=I.vec2.create(),this.set(O,X),this}set x(O){this.v[0]=O}get x(){return this.v[0]}set y(O){this.v[1]=O}get y(){return this.v[1]}set(O,X){return I.vec2.set(this.v,O,X),this}clone(){return new P(this.v[0],this.v[1])}copy(O){return I.vec2.copy(this.v,O.v),this}add(O){return I.vec2.add(this.v,this.v,O.v),this}subtract(O){return I.vec2.subtract(this.v,this.v,O.v),this}subtractVectors(O,X){const V=I.vec2.create();return I.vec2.subtract(V,O.v,X.v),V}scale(O){return I.vec2.scale(this.v,this.v,O),this}distance(O){return I.vec2.distance(this.v,O.v)}length(){return I.vec2.length(this.v)}negate(){return I.vec2.negate(this.v,this.v),this}normalize(){return I.vec2.normalize(this.v,this.v),this}lerp(O,X){return I.vec2.lerp(this.v,this.v,O.v,X),this}equals(O){return I.vec2.equals(this.v,O.v)}}F.a=P},function(h,F,T){'use strict';var I=T(0);F.a=class{constructor(P){this.data=P,this.buffer=T.i(I.createUniformBuffer)(P)}setValues(P,O=0){this.data.set(P,O)}}},function(h,F){'use strict';F.a=function(N){return new Promise((P,O)=>{const X=new XMLHttpRequest;X.onreadystatechange=()=>{4!==X.readyState||(4===X.readyState&&200===X.status?P(X.responseText,X.status):O('error',X.status))},X.open('GET',N,!0),X.send()})}},function(h,F,T){'use strict';var N=T(88),P=T.n(N),O=T(21);F.a=function(X){return new Promise((V,Y)=>{const G=new XMLHttpRequest;G.responseType='arraybuffer',G.onreadystatechange=()=>{if(4===G.readyState)if(4===G.readyState&&200===G.status){const H=P()(G.response),W=new O.a(H.shape[0],H.shape[1],H.data);V(W)}else Y(G.status)},G.open('GET',X,!0),G.send()})}},function(h,F){'use strict';F.a=function(N){return new Promise((P,O)=>{const X=new Image;X.onload=()=>{P(X)},X.onerror=()=>{O(`Failed to load ${N}`)},X.src=N})}},function(h,F){'use strict';F.a=class{constructor(N,P,O){this.width=N,this.height=P,this.data=O}}},function(h,F,T){'use strict';Object.defineProperty(F,'__esModule',{value:!0}),T.d(F,'pointLightsOutEs300',function(){return N}),T.d(F,'pointLightsInEs300',function(){return P}),T.d(F,'pointLightsEs100',function(){return O});const I=`
	struct PointLight {
		vec4 position;
		vec4 color;
		vec4 specularColor;
		vec4 shininess;
		vec4 intensity;
	};
	uniform PointLights {
		PointLight uPointLights[#HOOK_POINT_LIGHTS];
	};
`,N=`
	${I}
	out vec3 vPointLightSurfaceToLightDirection[#HOOK_POINT_LIGHTS];
	out vec3 vPointLightSurfaceToCameraDirection[#HOOK_POINT_LIGHTS];
`,P=`
	${I}
	in vec3 vPointLightSurfaceToLightDirection[#HOOK_POINT_LIGHTS];
	in vec3 vPointLightSurfaceToCameraDirection[#HOOK_POINT_LIGHTS];
`,O=`
	struct PointLight {
		vec3 position;
		vec3 color;
		vec3 specularColor;
		float shininess;
		float intensity;
	};
	uniform PointLight uPointLights[#HOOK_POINT_LIGHTS];
	varying vec3 vPointLightSurfaceToLightDirection[#HOOK_POINT_LIGHTS];
	varying vec3 vPointLightSurfaceToCameraDirection[#HOOK_POINT_LIGHTS];
`},function(h,F,T){'use strict';var I=T(1),N=T.n(I),P=T(2),O=T(11);let X=0;const V=I.vec3.create();F.a=class{constructor(){this.children=[],this.localMatrix=I.mat4.create(),this.modelMatrix=I.mat4.create(),this.position=new P.a,this.rotation=new P.a,this.scale=new P.a(1,1,1),this.isObject3D=!0,this._quaternion=I.quat.create(),this._quaternionLookAt=I.quat.create(),this._lookAtUp=I.vec3.create()}updateMatrix(){I.mat4.identity(this.localMatrix),I.mat4.identity(this.modelMatrix),I.quat.identity(this._quaternion),this.parent&&(I.mat4.copy(this.localMatrix,this.parent.modelMatrix),I.mat4.multiply(this.modelMatrix,this.modelMatrix,this.localMatrix)),I.quat.copy(this._quaternion,this._quaternionLookAt),I.mat4.translate(this.modelMatrix,this.modelMatrix,this.position.v),I.quat.rotateX(this._quaternion,this._quaternion,this.rotation.x),I.quat.rotateY(this._quaternion,this._quaternion,this.rotation.y),I.quat.rotateZ(this._quaternion,this._quaternion,this.rotation.z),X=I.quat.getAxisAngle(V,this._quaternion),I.mat4.rotate(this.modelMatrix,this.modelMatrix,X,V),I.mat4.scale(this.modelMatrix,this.modelMatrix,this.scale.v)}lookAt(G){I.quat.identity(this._quaternionLookAt),this._quaternionLookAt=T.i(O.lookAt)(this.position.v,G.v,this._lookAtUp)}setParent(G){this.unParent(),G.isObject3D&&(G.children.push(this),this.parent=G)}unParent(){if(void 0!==this.parent){const G=this.parent.children.indexOf(this);-1!==G&&(this.parent.children.splice(G,1),this.parent=null)}}dispose(){this.unParent(),this.children=[],this.localMatrix=null,this.modelMatrix=null,this.position=null,this.rotation=null,this.scale=null,this._quaternion=null,this.isObject3D=null}}},function(h,F,T){'use strict';var I=T(0),N=T(3);let P;F.a=class{constructor(){P=I.get(),P instanceof WebGL2RenderingContext?this.vao=P.createVertexArray():N.extensions.vertexArrayObject&&(this.vao=N.extensions.vertexArrayObject.createVertexArrayOES())}bind(){P instanceof WebGL2RenderingContext?P.bindVertexArray(this.vao):N.extensions.vertexArrayObject&&N.extensions.vertexArrayObject.bindVertexArrayOES(this.vao)}unbind(){P instanceof WebGL2RenderingContext?P.bindVertexArray(null):N.extensions.vertexArrayObject&&N.extensions.vertexArrayObject.bindVertexArrayOES(null)}dispose(){P instanceof WebGL2RenderingContext?P.deleteVertexArray(this.vao):N.extensions.vertexArrayObject&&N.extensions.vertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null}}},function(h,F,T){'use strict';var I=T(0);let N;F.a=class{constructor(O,X,V,Y=!0){this.type=O,this.itemSize=V,this.numItems=X.length/V,this.buffer=I.createBuffer(O,X),this.shaderAttribute=Y}bind(){N=I.get(),N.bindBuffer(this.type,this.buffer)}unbind(){N=I.get(),N.bindBuffer(this.type,null)}update(O){this.bind(),N=I.get(),N.bufferSubData(this.type,0,O),this.unbind()}dispose(){N=I.get(),N.deleteBuffer(this.buffer),this.buffer=null}}},function(h,F,T){'use strict';var I=T(4);class N extends I.a{constructor(P){const O=[];let X=0,V=0,Y=P.length/3;for(let G=0;G<Y;G+=1)X=3*G,V=6*G,G<Y-1&&(O[V]=P[X],O[V+1]=P[X+1],O[V+2]=P[X+2],O[V+3]=P[X+3],O[V+4]=P[X+4],O[V+5]=P[X+5]);super(new Float32Array(O))}}F.a=N},function(h,F,T){'use strict';var I=T(4);class N extends I.a{constructor(P=1,O=8,X=8,V){const Y=[],G=[],H=[];for(let Z=0;Z<=O;Z+=1){const K=Z*_MathPI/O,Q=_Mathsin(K),J=_Mathcos(K);for(let $=0;$<=X;$+=1){const ee=2*$*_MathPI/X,ae=_Mathsin(ee),ie=_Mathcos(ee),re=ie*Q,oe=J,ne=ae*Q,se=1-$/X,ue=1-Z/O;G.push(re),G.push(oe),G.push(ne),H.push(se),H.push(ue),Y.push(P*re),Y.push(P*oe),Y.push(P*ne)}}const W=[];for(let Z=0;Z<O;Z+=1)for(let K=0;K<X;K+=1){const Q=Z*(X+1)+K,J=Q+X+1;W.push(Q),W.push(J),W.push(Q+1),W.push(J),W.push(J+1),W.push(Q+1)}super(new Float32Array(Y),new Uint16Array(W),new Float32Array(G),new Float32Array(H),V)}}F.a=N},function(h,F,T){'use strict';var I=T(2),N=T(1),P=T.n(N);const O=N.vec3.create(),X=N.vec3.create(),V=N.vec3.create(),Y=N.vec3.create();F.a=class{constructor(){this.origin=new I.a,this.direction=new I.a}set(H,W){this.origin.copy(H),this.direction.copy(W)}intersectTriangle(H,W,Z,K=!0){N.vec3.sub(X,W.v,H.v),N.vec3.sub(V,Z.v,H.v),N.vec3.cross(Y,X,V);let Q=N.vec3.dot(this.direction.v,Y),J;if(0<Q){if(K)return null;J=1}else if(0>Q)J=-1,Q=-Q;else return null;N.vec3.sub(O,this.origin.v,H.v),N.vec3.cross(V,O,V);const $=J*N.vec3.dot(this.direction.v,V);if(0>$)return null;N.vec3.cross(X,X,O);const ee=J*N.vec3.dot(this.direction.v,X);if(0>ee)return null;if($+ee>Q)return null;const ae=-J*N.vec3.dot(O,Y);if(0>ae)return null;const ie=new I.a;return ie.copy(this.direction).scale(ae/Q).add(this.origin),ie}}},function(h,F){'use strict';F.a=function(){try{const I=WebGLRenderingContext,N=document.createElement('canvas'),P=document.createElement('canvas'),O=P.getContext('webgl2'),X=N.getContext('webgl')||N.getContext('experimental-webgl');return void 0!==I&&{webgl:!!X,webgl2:!!O}}catch(I){return!1}}},function(h,F,T){'use strict';var I=T(92),N=T.n(I);F.a=function(P){const O=new N.a.Mesh(P);return{vertices:new Float32Array(O.vertices),normals:new Float32Array(O.vertexNormals),indices:new Uint16Array(O.indices),uvs:new Float32Array(O.textures)}}},function(h,F){'use strict';F.a=class{update(){}setValues(N,P=0){this.data.set(N,P)}}},function(h,F){'use strict';const I=`
float whenEquals(float x, float y) {
  return 1.0 - abs(sign(x - y));
};
`,N=`
int whenEqualsInt(int x, int y) {
  return 1 - abs(sign(x - y));
}
`,P=`
float whenLessThan(float x, float y) {
  return max(sign(y - x), 0.0);
}
`,O=`
float whenGreaterThan(float x, float y) {
  return max(sign(x - y), 0.0);
}
`;F.b=O,F.a={whenEquals:I,whenEqualsInt:N,whenLessThan:P,whenGreaterThan:O}},function(h,F,T){'use strict';Object.defineProperty(F,'__esModule',{value:!0}),T.d(F,'directionalLightsEs300',function(){return I}),T.d(F,'directionalLightsEs100',function(){return N});const I=`
	struct DirectionalLight {
		vec4 position;
		vec4 color;
		vec4 intensity;
	};
	uniform DirectionalLights {
		DirectionalLight uDirectionalLights[#HOOK_DIRECTIONAL_LIGHTS];
	};
`,N=`
	struct DirectionalLight {
		vec3 position;
		vec3 color;
		float intensity;
	};
	uniform DirectionalLight uDirectionalLights[#HOOK_DIRECTIONAL_LIGHTS];
`},function(h,F){'use strict';const I=`
#define PI 3.141592653589793
`;F.b=I;const N=`
#define TWO_PI 6.283185307179586
`;F.c=N;const P=`
float mapLinear(float value, float in_min, float in_max, float out_min, float out_max) {
	return (value - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
}
`;F.a={definePI:I,definePITwo:N,mapLinear:P}},function(h,F,T){(function(){'use strict';function I(Q,J,$,ee,ae){'undefined'==typeof ae&&(ae=0.5);var ie=H.projectionratio(ae,Q),re=1-ie,oe={x:ie*J.x+re*ee.x,y:ie*J.y+re*ee.y},ne=H.abcratio(ae,Q),se={x:$.x+($.x-oe.x)/ne,y:$.y+($.y-oe.y)/ne};return{A:se,B:$,C:oe}}var N=_Mathabs,P=_Mathmin,O=_Mathmax,V=_Mathsqrt,G={x:0,y:0,z:0},H=T(36),W=T(81),Z=function(Q){var J=Q&&Q.forEach?Q:[].slice.call(arguments),$=!1;if('object'==typeof J[0]){$=J.length;var ee=[];J.forEach(function(me){['x','y','z'].forEach(function(xe){'undefined'!=typeof me[xe]&&ee.push(me[xe])})}),J=ee}var ae=!1,ie=J.length;if($){if(4<$){if(1!==arguments.length)throw new Error('Only new Bezier(point[]) is accepted for 4th and higher order curves');ae=!0}}else if(6!==ie&&8!==ie&&9!==ie&&12!==ie&&1!==arguments.length)throw new Error('Only new Bezier(point[]) is accepted for 4th and higher order curves');var re=!ae&&(9===ie||12===ie)||Q&&Q[0]&&'undefined'!=typeof Q[0].z;this._3d=re;for(var oe=[],ne=0,se=re?3:2,ue;ne<ie;ne+=se)ue={x:J[ne],y:J[ne+1]},re&&(ue.z=J[ne+2]),oe.push(ue);this.order=oe.length-1,this.points=oe;var ce=['x','y'];re&&ce.push('z'),this.dims=ce,this.dimlen=ce.length,function(me){for(var xe=me.order,pe=me.points,ge=H.align(pe,{p1:pe[0],p2:pe[xe]}),he=0;he<ge.length;he++)if(1e-4<N(ge[he].y))return void(me._linear=!1);me._linear=!0}(this),this._t1=0,this._t2=1,this.update()};Z.fromSVG=function(Q){var J=Q.match(/[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?/g).map(parseFloat),$=/[cq]/.test(Q);return $?(J=J.map(function(ee,ae){return 2>ae?ee:ee+J[ae%2]}),new Z(J)):new Z(J)},Z.quadraticFromPoints=function(Q,J,$,ee){if('undefined'==typeof ee&&(ee=0.5),0===ee)return new Z(J,J,$);if(1===ee)return new Z(Q,J,J);var ae=I(2,Q,J,$,ee);return new Z(Q,ae.A,$)},Z.cubicFromPoints=function(Q,J,$,ee,ae){'undefined'==typeof ee&&(ee=0.5);var ie=I(3,Q,J,$,ee);'undefined'==typeof ae&&(ae=H.dist(J,ie.C));var re=ae*(1-ee)/ee,oe=H.dist(Q,$),ne=($.x-Q.x)/oe,se=($.y-Q.y)/oe,ue=ae*ne,ce=ae*se,pe={x:J.x-ue,y:J.y-ce},ge={x:J.x+re*ne,y:J.y+re*se},he=ie.A,ve={x:he.x+(pe.x-he.x)/(1-ee),y:he.y+(pe.y-he.y)/(1-ee)},Ee={x:he.x+(ge.x-he.x)/ee,y:he.y+(ge.y-he.y)/ee},_e={x:Q.x+(ve.x-Q.x)/ee,y:Q.y+(ve.y-Q.y)/ee},ye={x:$.x+(Ee.x-$.x)/(1-ee),y:$.y+(Ee.y-$.y)/(1-ee)};return new Z(Q,_e,ye,$)};var K=function(){return H};Z.getUtils=K,Z.prototype={getUtils:K,valueOf:function(){return this.toString()},toString:function(){return H.pointsToString(this.points)},toSVG:function(){if(this._3d)return!1;for(var J=this.points,$=J[0].x,ee=J[0].y,ae=['M',$,ee,2===this.order?'Q':'C'],ie=1,re=J.length;ie<re;ie++)ae.push(J[ie].x),ae.push(J[ie].y);return ae.join(' ')},update:function(){this.dpoints=[];for(var Q=this.points,J=Q.length,$=J-1,ee;1<J;J--,$--){ee=[];for(var ae=0,ie;ae<$;ae++)ie={x:$*(Q[ae+1].x-Q[ae].x),y:$*(Q[ae+1].y-Q[ae].y)},this._3d&&(ie.z=$*(Q[ae+1].z-Q[ae].z)),ee.push(ie);this.dpoints.push(ee),Q=ee}this.computedirection()},computedirection:function(){var Q=this.points,J=H.angle(Q[0],Q[this.order],Q[1]);this.clockwise=0<J},length:function(){return H.length(this.derivative.bind(this))},_lut:[],getLUT:function(Q){if(Q=Q||100,this._lut.length===Q)return this._lut;this._lut=[];for(var J=0;J<=Q;J++)this._lut.push(this.compute(J/Q));return this._lut},on:function(Q,J){J=J||5;for(var $=this.getLUT(),ee=[],ie=0,re=0,ae;re<$.length;re++)ae=$[re],H.dist(ae,Q)<J&&(ee.push(ae),ie+=re/$.length);return!!ee.length&&(ie/=ee.length)},project:function(Q){var J=this.getLUT(),$=J.length-1,ee=H.closest(J,Q),ae=ee.mdist,ie=ee.mpos;if(0===ie||ie===$){var re=ie/$,oe=this.compute(re);return oe.t=re,oe.d=ae,oe}var xe=0.1/$,ne,re,se,ue;for(ae+=1,re=(ie-1)/$,ne=re;re<(ie+1)/$+xe;re+=xe)se=this.compute(re),ue=H.dist(Q,se),ue<ae&&(ae=ue,ne=re);return se=this.compute(ne),se.t=ne,se.d=ae,se},get:function(Q){return this.compute(Q)},point:function(Q){return this.points[Q]},compute:function(Q){if(0===Q)return this.points[0];if(1===Q)return this.points[this.order];var J=this.points,$=1-Q;if(1===this.order)return se={x:$*J[0].x+Q*J[1].x,y:$*J[0].y+Q*J[1].y},this._3d&&(se.z=$*J[0].z+Q*J[1].z),se;if(4>this.order){var ee=$*$,ae=Q*Q,ne=0,ie,re,oe;2===this.order?(J=[J[0],J[1],J[2],G],ie=ee,re=2*($*Q),oe=ae):3===this.order&&(ie=ee*$,re=3*(ee*Q),oe=3*($*ae),ne=Q*ae);var se={x:ie*J[0].x+re*J[1].x+oe*J[2].x+ne*J[3].x,y:ie*J[0].y+re*J[1].y+oe*J[2].y+ne*J[3].y};return this._3d&&(se.z=ie*J[0].z+re*J[1].z+oe*J[2].z+ne*J[3].z),se}for(var ue=JSON.parse(JSON.stringify(this.points));1<ue.length;){for(var ce=0;ce<ue.length-1;ce++)ue[ce]={x:ue[ce].x+(ue[ce+1].x-ue[ce].x)*Q,y:ue[ce].y+(ue[ce+1].y-ue[ce].y)*Q},'undefined'!=typeof ue[ce].z&&(ue[ce]=ue[ce].z+(ue[ce+1].z-ue[ce].z)*Q);ue.splice(ue.length-1,1)}return ue[0]},raise:function(){for(var Q=this.points,J=[Q[0]],ee=Q.length,$=1,$,ae,ie;$<ee;$++)ae=Q[$],ie=Q[$-1],J[$]={x:(ee-$)/ee*ae.x+$/ee*ie.x,y:(ee-$)/ee*ae.y+$/ee*ie.y};return J[ee]=Q[ee-1],new Z(J)},derivative:function(Q){var J=1-Q,ae=0,ie=this.dpoints[0],$,ee;2===this.order&&(ie=[ie[0],ie[1],G],$=J,ee=Q),3===this.order&&($=J*J,ee=2*(J*Q),ae=Q*Q);var re={x:$*ie[0].x+ee*ie[1].x+ae*ie[2].x,y:$*ie[0].y+ee*ie[1].y+ae*ie[2].y};return this._3d&&(re.z=$*ie[0].z+ee*ie[1].z+ae*ie[2].z),re},inflections:function(){return H.inflections(this.points)},normal:function(Q){return this._3d?this.__normal3(Q):this.__normal2(Q)},__normal2:function(Q){var J=this.derivative(Q),$=V(J.x*J.x+J.y*J.y);return{x:-J.y/$,y:J.x/$}},__normal3:function(Q){var J=this.derivative(Q),$=this.derivative(Q+0.01),ee=V(J.x*J.x+J.y*J.y+J.z*J.z),ae=V($.x*$.x+$.y*$.y+$.z*$.z);J.x/=ee,J.y/=ee,J.z/=ee,$.x/=ae,$.y/=ae,$.z/=ae;var ie={x:$.y*J.z-$.z*J.y,y:$.z*J.x-$.x*J.z,z:$.x*J.y-$.y*J.x},re=V(ie.x*ie.x+ie.y*ie.y+ie.z*ie.z);ie.x/=re,ie.y/=re,ie.z/=re;var oe=[ie.x*ie.x,ie.x*ie.y-ie.z,ie.x*ie.z+ie.y,ie.x*ie.y+ie.z,ie.y*ie.y,ie.y*ie.z-ie.x,ie.x*ie.z-ie.y,ie.y*ie.z+ie.x,ie.z*ie.z],ne={x:oe[0]*J.x+oe[1]*J.y+oe[2]*J.z,y:oe[3]*J.x+oe[4]*J.y+oe[5]*J.z,z:oe[6]*J.x+oe[7]*J.y+oe[8]*J.z};return ne},hull:function(Q){var J=this.points,$=[],ae=[],ie=0,re=0,oe=0,ee;for(ae[ie++]=J[0],ae[ie++]=J[1],ae[ie++]=J[2],3===this.order&&(ae[ie++]=J[3]);1<J.length;){for($=[],re=0,oe=J.length-1;re<oe;re++)ee=H.lerp(Q,J[re],J[re+1]),ae[ie++]=ee,$.push(ee);J=$}return ae},split:function(Q,J){if(0===Q&&!!J)return this.split(J).left;if(1===J)return this.split(Q).right;var $=this.hull(Q),ee={left:2===this.order?new Z([$[0],$[3],$[5]]):new Z([$[0],$[4],$[7],$[9]]),right:2===this.order?new Z([$[5],$[4],$[2]]):new Z([$[9],$[8],$[6],$[3]]),span:$};if(ee.left._t1=H.map(0,0,1,this._t1,this._t2),ee.left._t2=H.map(Q,0,1,this._t1,this._t2),ee.right._t1=H.map(Q,0,1,this._t1,this._t2),ee.right._t2=H.map(1,0,1,this._t1,this._t2),!J)return ee;J=H.map(J,Q,1,0,1);var ae=ee.right.split(J);return ae.left},extrema:function(){var Q=this.dims,J={},$=[],ee,ae;return Q.forEach(function(ie){ae=function(re){return re[ie]},ee=this.dpoints[0].map(ae),J[ie]=H.droots(ee),3===this.order&&(ee=this.dpoints[1].map(ae),J[ie]=J[ie].concat(H.droots(ee))),J[ie]=J[ie].filter(function(re){return 0<=re&&1>=re}),$=$.concat(J[ie].sort())}.bind(this)),$=$.sort().filter(function(ie,re){return $.indexOf(ie)===re}),J.values=$,J},bbox:function(){var Q=this.extrema(),J={};return this.dims.forEach(function($){J[$]=H.getminmax(this,$,Q[$])}.bind(this)),J},overlaps:function(Q){var J=this.bbox(),$=Q.bbox();return H.bboxoverlap(J,$)},offset:function(Q,J){if('undefined'!=typeof J){var $=this.get(Q),ee=this.normal(Q),ae={c:$,n:ee,x:$.x+ee.x*J,y:$.y+ee.y*J};return this._3d&&(ae.z=$.z+ee.z*J),ae}if(this._linear){var ie=this.normal(0),re=this.points.map(function(ne){var se={x:ne.x+Q*ie.x,y:ne.y+Q*ie.y};return ne.z&&ee.z&&(se.z=ne.z+Q*ie.z),se});return[new Z(re)]}var oe=this.reduce();return oe.map(function(ne){return ne.scale(Q)})},simple:function(){if(3===this.order){var Q=H.angle(this.points[0],this.points[3],this.points[1]),J=H.angle(this.points[0],this.points[3],this.points[2]);if(0<Q&&0>J||0>Q&&0<J)return!1}var $=this.normal(0),ee=this.normal(1),ae=$.x*ee.x+$.y*ee.y;this._3d&&(ae+=$.z*ee.z);var ie=N(_Mathacos(ae));return ie<_MathPI/3},reduce:function(){var J=0,$=0,ee=0.01,ie=[],re=[],oe=this.extrema().values,Q,ae;for(-1===oe.indexOf(0)&&(oe=[0].concat(oe)),-1===oe.indexOf(1)&&oe.push(1),(J=oe[0],Q=1);Q<oe.length;Q++)$=oe[Q],ae=this.split(J,$),ae._t1=J,ae._t2=$,ie.push(ae),J=$;return ie.forEach(function(ne){for(J=0,$=0;1>=$;)for($=J+ee;$<=1+ee;$+=ee)if(ae=ne.split(J,$),!ae.simple()){if($-=ee,N(J-$)<ee)return[];ae=ne.split(J,$),ae._t1=H.map(J,0,1,ne._t1,ne._t2),ae._t2=H.map($,0,1,ne._t1,ne._t2),re.push(ae),J=$;break}1>J&&(ae=ne.split(J,1),ae._t1=H.map(J,0,1,ne._t1,ne._t2),ae._t2=ne._t2,re.push(ae))}),re},scale:function(Q){var J=this.order,$=!1;if('function'==typeof Q&&($=Q),$&&2===J)return this.raise().scale($);var ee=this.clockwise,ae=$?$(0):Q,ie=$?$(1):Q,re=[this.offset(0,10),this.offset(1,10)],oe=H.lli4(re[0],re[0].c,re[1],re[1].c);if(!oe)throw new Error('cannot scale this curve. Try reducing it first.');var ne=this.points,se=[];return([0,1].forEach(function(ue){var ce=se[ue*J]=H.copy(ne[ue*J]);ce.x+=(ue?ie:ae)*re[ue].n.x,ce.y+=(ue?ie:ae)*re[ue].n.y}.bind(this)),!$)?([0,1].forEach(function(ue){if(2!==this.order||!ue){var ce=se[ue*J],me=this.derivative(ue),xe={x:ce.x+me.x,y:ce.y+me.y};se[ue+1]=H.lli4(ce,xe,oe,ne[ue+1])}}.bind(this)),new Z(se)):([0,1].forEach(function(ue){if(2!==this.order||!ue){var ce=ne[ue+1],me={x:ce.x-oe.x,y:ce.y-oe.y},xe=$?$((ue+1)/J):Q;$&&!ee&&(xe=-xe);var pe=V(me.x*me.x+me.y*me.y);me.x/=pe,me.y/=pe,se[ue+1]={x:ce.x+xe*me.x,y:ce.y+xe*me.y}}}.bind(this)),new Z(se))},outline:function(Q,J,$,ee){function ae(Fe,Te,Re,Ae,Ie){return function(we){var ze=Te-Fe;return H.map(we,0,1,Fe+Ae/Re*ze,Fe+(Ae+Ie)/Re*ze)}}J='undefined'==typeof J?Q:J;var ie=this.reduce(),re=ie.length,oe=[],ne=[],ue=0,ce=this.length(),se;ie.forEach(function(Fe){ye=Fe.length(),'undefined'!=typeof $&&'undefined'!=typeof ee?(oe.push(Fe.scale(ae(Q,$,ce,ue,ye))),ne.push(Fe.scale(ae(-J,-ee,ce,ue,ye)))):(oe.push(Fe.scale(Q)),ne.push(Fe.scale(-J))),ue+=ye}),ne=ne.map(function(Fe){return se=Fe.points,Fe.points=se[3]?[se[3],se[2],se[1],se[0]]:[se[2],se[1],se[0]],Fe}).reverse();var xe=oe[0].points[0],pe=oe[re-1].points[oe[re-1].points.length-1],ge=ne[re-1].points[ne[re-1].points.length-1],he=ne[0].points[0],ve=H.makeline(ge,xe),Ee=H.makeline(pe,he),_e=[ve].concat(oe).concat([Ee]).concat(ne),ye=_e.length;return new W(_e)},outlineshapes:function(Q,J,$){J=J||Q;for(var ee=this.outline(Q,J).curves,ae=[],ie=1,re=ee.length,oe;ie<re/2;ie++)oe=H.makeshape(ee[ie],ee[re-ie],$),oe.startcap.virtual=1<ie,oe.endcap.virtual=ie<re/2-1,ae.push(oe);return ae},intersects:function(Q,J){return Q?Q.p1&&Q.p2?this.lineIntersects(Q):(Q instanceof Z&&(Q=Q.reduce()),this.curveintersects(this.reduce(),Q,J)):this.selfintersects(J)},lineIntersects:function(Q){var J=P(Q.p1.x,Q.p2.x),$=P(Q.p1.y,Q.p2.y),ee=O(Q.p1.x,Q.p2.x),ae=O(Q.p1.y,Q.p2.y),ie=this;return H.roots(this.points,Q).filter(function(re){var oe=ie.get(re);return H.between(oe.x,J,ee)&&H.between(oe.y,$,ae)})},selfintersects:function(Q){var J=this.reduce(),$,ee=J.length-2,ae=[],ie,re,oe;for($=0;$<ee;$++)re=J.slice($,$+1),oe=J.slice($+2),ie=this.curveintersects(re,oe,Q),ae=ae.concat(ie);return ae},curveintersects:function(Q,J,$){var ee=[];Q.forEach(function(ie){J.forEach(function(re){ie.overlaps(re)&&ee.push({left:ie,right:re})})});var ae=[];return ee.forEach(function(ie){var re=H.pairiteration(ie.left,ie.right,$);0<re.length&&(ae=ae.concat(re))}),ae},arcs:function(Q){Q=Q||0.5;return this._iterate(Q,[])},_error:function(Q,J,$,ee){var ae=(ee-$)/4,ie=this.get($+ae),re=this.get(ee-ae),oe=H.dist(Q,J),ne=H.dist(Q,ie),se=H.dist(Q,re);return N(ne-oe)+N(se-oe)},_iterate:function(Q,J){var $=0,ee=1,ae;do{ae=0,ee=1;var ie=this.get($),re,oe,ne,se,ue=!1,ce=!1,me,xe=ee,pe=1,ge=0;do{ce=ue,se=ne,xe=($+ee)/2,ge++,re=this.get(xe),oe=this.get(ee),ne=H.getccenter(ie,re,oe),ne.interval={start:$,end:ee};var he=this._error(ne,ie,$,ee);if(ue=he<=Q,me=ce&&!ue,me||(pe=ee),ue){if(1<=ee){ne.interval.end=pe=1,se=ne;break}ee+=(ee-$)/2}else ee=xe}while(!me&&100>ae++);if(100<=ae)break;se=se?se:ne,J.push(se),$=pe}while(1>ee);return J}},h.exports=Z})()},function(h,F,T){(function(){'use strict';var I=_Mathabs,N=_Mathcos,P=_Mathsin,X=_Mathatan,V=_Mathsqrt,Y=_Mathpow,G=function(ee){return 0>ee?-Y(-ee,1/3):Y(ee,1/3)},H=_MathPI,W=2*H,Z=H/2,Q=Number.MAX_SAFE_INTEGER,J=Number.MIN_SAFE_INTEGER,$={Tvalues:[-0.06405689286260563,0.06405689286260563,-0.1911188674736163,0.1911188674736163,-0.3150426796961634,0.3150426796961634,-0.4337935076260451,0.4337935076260451,-0.5454214713888396,0.5454214713888396,-0.6480936519369755,0.6480936519369755,-0.7401241915785544,0.7401241915785544,-0.820001985973903,0.820001985973903,-0.8864155270044011,0.8864155270044011,-0.9382745520027328,0.9382745520027328,-0.9747285559713095,0.9747285559713095,-0.9951872199970213,0.9951872199970213],Cvalues:[0.12793819534675216,0.12793819534675216,0.1258374563468283,0.1258374563468283,0.12167047292780339,0.12167047292780339,0.1155056680537256,0.1155056680537256,0.10744427011596563,0.10744427011596563,0.09761865210411388,0.09761865210411388,0.08619016153195327,0.08619016153195327,0.0733464814110803,0.0733464814110803,0.05929858491543678,0.05929858491543678,0.04427743881741981,0.04427743881741981,0.028531388628933663,0.028531388628933663,0.0123412297999872,0.0123412297999872],arcfn:function(ee,ae){var ie=ae(ee),re=ie.x*ie.x+ie.y*ie.y;return'undefined'!=typeof ie.z&&(re+=ie.z*ie.z),V(re)},between:function(ee,ae,ie){return ae<=ee&&ee<=ie||$.approximately(ee,ae)||$.approximately(ee,ie)},approximately:function(ee,ae,ie){return I(ee-ae)<=(ie||1e-6)},length:function(ee){var ae=0.5,ie=0,re=$.Tvalues.length,oe,ne;for(oe=0;oe<re;oe++)ne=ae*$.Tvalues[oe]+ae,ie+=$.Cvalues[oe]*$.arcfn(ne,ee);return ae*ie},map:function(ee,ae,ie,re,oe){return re+(oe-re)*((ee-ae)/(ie-ae))},lerp:function(ee,ae,ie){var re={x:ae.x+ee*(ie.x-ae.x),y:ae.y+ee*(ie.y-ae.y)};return!ae.z||!ie.z||(re.z=ae.z+ee*(ie.z-ae.z)),re},pointToString:function(ee){var ae=ee.x+'/'+ee.y;return'undefined'!=typeof ee.z&&(ae+='/'+ee.z),ae},pointsToString:function(ee){return'['+ee.map($.pointToString).join(', ')+']'},copy:function(ee){return JSON.parse(JSON.stringify(ee))},angle:function(ee,ae,ie){var re=ae.x-ee.x,oe=ae.y-ee.y,ne=ie.x-ee.x,se=ie.y-ee.y;return X(re*se-oe*ne,re*ne+oe*se)},round:function(ee,ae){var ie=''+ee,re=ie.indexOf('.');return parseFloat(ie.substring(0,re+1+ae))},dist:function(ee,ae){var ie=ee.x-ae.x,re=ee.y-ae.y;return V(ie*ie+re*re)},closest:function(ee,ae){var ie=Y(2,63),re,oe;return ee.forEach(function(ne,se){oe=$.dist(ae,ne),oe<ie&&(ie=oe,re=se)}),{mdist:ie,mpos:re}},abcratio:function(ee,ae){if(2!==ae&&3!==ae)return!1;if('undefined'==typeof ee)ee=0.5;else if(0===ee||1===ee)return ee;var ie=Y(ee,ae)+Y(1-ee,ae);return I((ie-1)/ie)},projectionratio:function(ee,ae){if(2!==ae&&3!==ae)return!1;if('undefined'==typeof ee)ee=0.5;else if(0===ee||1===ee)return ee;var ie=Y(1-ee,ae),re=Y(ee,ae)+ie;return ie/re},lli8:function(ee,ae,ie,re,oe,ne,se,ue){var xe=(ee-ie)*(ne-ue)-(ae-re)*(oe-se);return 0!=xe&&{x:((ee*re-ae*ie)*(oe-se)-(ee-ie)*(oe*ue-ne*se))/xe,y:((ee*re-ae*ie)*(ne-ue)-(ae-re)*(oe*ue-ne*se))/xe}},lli4:function(ee,ae,ie,re){var oe=ee.x,ne=ee.y,se=ae.x,ue=ae.y,ce=ie.x,me=ie.y,xe=re.x,pe=re.y;return $.lli8(oe,ne,se,ue,ce,me,xe,pe)},lli:function(ee,ae){return $.lli4(ee,ee.c,ae,ae.c)},makeline:function(ee,ae){var ie=T(35),re=ee.x,oe=ee.y,ne=ae.x,se=ae.y,ue=(ne-re)/3,ce=(se-oe)/3;return new ie(re,oe,re+ue,oe+ce,re+2*ue,oe+2*ce,ne,se)},findbbox:function(ee){var ae=Q,ie=Q,re=J,oe=J;return ee.forEach(function(ne){var se=ne.bbox();ae>se.x.min&&(ae=se.x.min),ie>se.y.min&&(ie=se.y.min),re<se.x.max&&(re=se.x.max),oe<se.y.max&&(oe=se.y.max)}),{x:{min:ae,mid:(ae+re)/2,max:re,size:re-ae},y:{min:ie,mid:(ie+oe)/2,max:oe,size:oe-ie}}},shapeintersections:function(ee,ae,ie,re,oe){if(!$.bboxoverlap(ae,re))return[];var ne=[],se=[ee.startcap,ee.forward,ee.back,ee.endcap],ue=[ie.startcap,ie.forward,ie.back,ie.endcap];return se.forEach(function(ce){ce.virtual||ue.forEach(function(me){if(!me.virtual){var xe=ce.intersects(me,oe);0<xe.length&&(xe.c1=ce,xe.c2=me,xe.s1=ee,xe.s2=ie,ne.push(xe))}})}),ne},makeshape:function(ee,ae,ie){var re=ae.points.length,oe=ee.points.length,ne=$.makeline(ae.points[re-1],ee.points[0]),se=$.makeline(ee.points[oe-1],ae.points[0]),ue={startcap:ne,forward:ee,back:ae,endcap:se,bbox:$.findbbox([ne,ee,ae,se])};return ue.intersections=function(me){return $.shapeintersections(ue,ue.bbox,me,me.bbox,ie)},ue},getminmax:function(ee,ae,ie){if(!ie)return{min:0,max:0};var re=Q,oe=J,ne,se;-1===ie.indexOf(0)&&(ie=[0].concat(ie)),-1===ie.indexOf(1)&&ie.push(1);for(var ue=0,ce=ie.length;ue<ce;ue++)ne=ie[ue],se=ee.get(ne),se[ae]<re&&(re=se[ae]),se[ae]>oe&&(oe=se[ae]);return{min:re,mid:(re+oe)/2,max:oe,size:oe-re}},align:function(ee,ae){var ie=ae.p1.x,re=ae.p1.y,oe=-X(ae.p2.y-re,ae.p2.x-ie);return ee.map(function(se){return{x:(se.x-ie)*N(oe)-(se.y-re)*P(oe),y:(se.x-ie)*P(oe)+(se.y-re)*N(oe)}})},roots:function(ee,ae){ae=ae||{p1:{x:0,y:0},p2:{x:1,y:0}};var ie=ee.length-1,re=$.align(ee,ae),oe=function(Ce){return 0<=Ce&&1>=Ce};if(2==ie){var ne=re[0].y,se=re[1].y,ue=re[2].y,ce=ne-2*se+ue;if(0!==ce){var me=-V(se*se-ne*ue),xe=-ne+se,pe=-(me+xe)/ce;return[pe,-(-me+xe)/ce].filter(oe)}return se!==ue&&0===ce?[(2*se-ue)/2*(se-ue)].filter(oe):[]}var he=re[0].y,ve=re[1].y,Ee=re[2].y,_e=re[3].y,ce=-he+3*ve-3*Ee+_e,ne=(3*he-6*ve+3*Ee)/ce,se=(-3*he+3*ve)/ce,ue=he/ce,re=(3*se-ne*ne)/3,ye=re/3,Fe=(2*ne*ne*ne-9*ne*se+27*ue)/27,Te=Fe/2,Re=Te*Te+ye*ye*ye,Ae,pe,Ie,we,Se;if(0>Re){var Le=-re/3,Me=V(Le*Le*Le),Ne=-Fe/(2*Me),Pe=-1>Ne?-1:1<Ne?1:Ne,Ue=_Mathacos(Pe),De=G(Me),Oe=2*De;return Ie=Oe*N(Ue/3)-ne/3,we=Oe*N((Ue+W)/3)-ne/3,Se=Oe*N((Ue+2*W)/3)-ne/3,[Ie,we,Se].filter(oe)}if(0==Re)return Ae=0>Te?G(-Te):-G(Te),Ie=2*Ae-ne/3,we=-Ae-ne/3,[Ie,we].filter(oe);var Be=V(Re);return Ae=G(-Te+Be),pe=G(Te+Be),[Ae-pe-ne/3].filter(oe)},droots:function(ee){if(3===ee.length){var ae=ee[0],ie=ee[1],re=ee[2],oe=ae-2*ie+re;if(0!==oe){var ne=-V(ie*ie-ae*re),se=-ae+ie;return[-(ne+se)/oe,-(-ne+se)/oe]}return ie!==re&&0===oe?[(2*ie-re)/(2*(ie-re))]:[]}if(2===ee.length){var ae=ee[0],ie=ee[1];return ae===ie?[]:[ae/(ae-ie)]}},inflections:function(ee){if(4>ee.length)return[];var ae=$.align(ee,{p1:ee[0],p2:ee.slice(-1)[0]}),ie=ae[2].x*ae[1].y,re=ae[3].x*ae[1].y,oe=ae[1].x*ae[2].y,ne=ae[3].x*ae[2].y,se=18*(-3*ie+2*re+3*oe-ne),ue=18*(3*ie-re-3*oe),ce=18*(oe-ie);if($.approximately(se,0)){if(!$.approximately(ue,0)){var me=-ce/ue;if(0<=me&&1>=me)return[me]}return[]}var pe=_Mathsqrt(ue*ue-4*se*ce),ne=2*se;return $.approximately(ne,0)?[]:[(pe-ue)/ne,-(ue+pe)/ne].filter(function(ge){return 0<=ge&&1>=ge})},bboxoverlap:function(ee,ae){var ie=['x','y'],re=ie.length,oe,ne,se,ue,ce;for(oe=0;oe<re;oe++)if(ne=ie[oe],se=ee[ne].mid,ue=ae[ne].mid,ce=(ee[ne].size+ae[ne].size)/2,I(se-ue)>=ce)return!1;return!0},expandbox:function(ee,ae){ae.x.min<ee.x.min&&(ee.x.min=ae.x.min),ae.y.min<ee.y.min&&(ee.y.min=ae.y.min),ae.z&&ae.z.min<ee.z.min&&(ee.z.min=ae.z.min),ae.x.max>ee.x.max&&(ee.x.max=ae.x.max),ae.y.max>ee.y.max&&(ee.y.max=ae.y.max),ae.z&&ae.z.max>ee.z.max&&(ee.z.max=ae.z.max),ee.x.mid=(ee.x.min+ee.x.max)/2,ee.y.mid=(ee.y.min+ee.y.max)/2,ee.z&&(ee.z.mid=(ee.z.min+ee.z.max)/2),ee.x.size=ee.x.max-ee.x.min,ee.y.size=ee.y.max-ee.y.min,ee.z&&(ee.z.size=ee.z.max-ee.z.min)},pairiteration:function(ee,ae,ie){var re=ee.bbox(),oe=ae.bbox(),ne=1e5,se=ie||0.5;if(re.x.size+re.y.size<se&&oe.x.size+oe.y.size<se)return[(0|ne*(ee._t1+ee._t2)/2)/ne+'/'+(0|ne*(ae._t1+ae._t2)/2)/ne];var ue=ee.split(0.5),ce=ae.split(0.5),me=[{left:ue.left,right:ce.left},{left:ue.left,right:ce.right},{left:ue.right,right:ce.right},{left:ue.right,right:ce.left}];me=me.filter(function(pe){return $.bboxoverlap(pe.left.bbox(),pe.right.bbox())});var xe=[];return 0===me.length?xe:(me.forEach(function(pe){xe=xe.concat($.pairiteration(pe.left,pe.right,se))}),xe=xe.filter(function(pe,ge){return xe.indexOf(pe)===ge}),xe)},getccenter:function(ee,ae,ie){var re=ae.x-ee.x,oe=ae.y-ee.y,ne=ie.x-ae.x,se=ie.y-ae.y,ue=re*N(Z)-oe*P(Z),ce=re*P(Z)+oe*N(Z),me=ne*N(Z)-se*P(Z),xe=ne*P(Z)+se*N(Z),pe=(ee.x+ae.x)/2,ge=(ee.y+ae.y)/2,he=(ae.x+ie.x)/2,ve=(ae.y+ie.y)/2,Te=$.lli8(pe,ge,pe+ue,ge+ce,he,ve,he+me,ve+xe),Re=$.dist(Te,ee),Ae=X(ee.y-Te.y,ee.x-Te.x),Ie=X(ae.y-Te.y,ae.x-Te.x),we=X(ie.y-Te.y,ie.x-Te.x),Se;return Ae<we?((Ae>Ie||Ie>we)&&(Ae+=W),Ae>we&&(Se=we,we=Ae,Ae=Se)):we<Ie&&Ie<Ae?(Se=we,we=Ae,Ae=Se):we+=W,Te.s=Ae,Te.e=we,Te.r=Re,Te}};h.exports=$})()},function(h,F,T){var I=T(6),N={};N.create=function(){var P=new I.ARRAY_TYPE(9);return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=1,P[5]=0,P[6]=0,P[7]=0,P[8]=1,P},N.fromMat4=function(P,O){return P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[4],P[4]=O[5],P[5]=O[6],P[6]=O[8],P[7]=O[9],P[8]=O[10],P},N.clone=function(P){var O=new I.ARRAY_TYPE(9);return O[0]=P[0],O[1]=P[1],O[2]=P[2],O[3]=P[3],O[4]=P[4],O[5]=P[5],O[6]=P[6],O[7]=P[7],O[8]=P[8],O},N.copy=function(P,O){return P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[3],P[4]=O[4],P[5]=O[5],P[6]=O[6],P[7]=O[7],P[8]=O[8],P},N.fromValues=function(P,O,X,V,Y,G,H,W,Z){var K=new I.ARRAY_TYPE(9);return K[0]=P,K[1]=O,K[2]=X,K[3]=V,K[4]=Y,K[5]=G,K[6]=H,K[7]=W,K[8]=Z,K},N.set=function(P,O,X,V,Y,G,H,W,Z,K){return P[0]=O,P[1]=X,P[2]=V,P[3]=Y,P[4]=G,P[5]=H,P[6]=W,P[7]=Z,P[8]=K,P},N.identity=function(P){return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=1,P[5]=0,P[6]=0,P[7]=0,P[8]=1,P},N.transpose=function(P,O){if(P===O){var X=O[1],V=O[2],Y=O[5];P[1]=O[3],P[2]=O[6],P[3]=X,P[5]=O[7],P[6]=V,P[7]=Y}else P[0]=O[0],P[1]=O[3],P[2]=O[6],P[3]=O[1],P[4]=O[4],P[5]=O[7],P[6]=O[2],P[7]=O[5],P[8]=O[8];return P},N.invert=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=O[4],W=O[5],Z=O[6],K=O[7],Q=O[8],J=Q*H-W*K,$=-Q*G+W*Z,ee=K*G-H*Z,ae=X*J+V*$+Y*ee;return ae?(ae=1/ae,P[0]=J*ae,P[1]=(-Q*V+Y*K)*ae,P[2]=(W*V-Y*H)*ae,P[3]=$*ae,P[4]=(Q*X-Y*Z)*ae,P[5]=(-W*X+Y*G)*ae,P[6]=ee*ae,P[7]=(-K*X+V*Z)*ae,P[8]=(H*X-V*G)*ae,P):null},N.adjoint=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=O[4],W=O[5],Z=O[6],K=O[7],Q=O[8];return P[0]=H*Q-W*K,P[1]=Y*K-V*Q,P[2]=V*W-Y*H,P[3]=W*Z-G*Q,P[4]=X*Q-Y*Z,P[5]=Y*G-X*W,P[6]=G*K-H*Z,P[7]=V*Z-X*K,P[8]=X*H-V*G,P},N.determinant=function(P){var O=P[0],X=P[1],V=P[2],Y=P[3],G=P[4],H=P[5],W=P[6],Z=P[7],K=P[8];return O*(K*G-H*Z)+X*(-K*Y+H*W)+V*(Z*Y-G*W)},N.multiply=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=O[4],Z=O[5],K=O[6],Q=O[7],J=O[8],$=X[0],ee=X[1],ae=X[2],ie=X[3],re=X[4],oe=X[5],ne=X[6],se=X[7],ue=X[8];return P[0]=$*V+ee*H+ae*K,P[1]=$*Y+ee*W+ae*Q,P[2]=$*G+ee*Z+ae*J,P[3]=ie*V+re*H+oe*K,P[4]=ie*Y+re*W+oe*Q,P[5]=ie*G+re*Z+oe*J,P[6]=ne*V+se*H+ue*K,P[7]=ne*Y+se*W+ue*Q,P[8]=ne*G+se*Z+ue*J,P},N.mul=N.multiply,N.translate=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=O[4],Z=O[5],K=O[6],Q=O[7],J=O[8],$=X[0],ee=X[1];return P[0]=V,P[1]=Y,P[2]=G,P[3]=H,P[4]=W,P[5]=Z,P[6]=$*V+ee*H+K,P[7]=$*Y+ee*W+Q,P[8]=$*G+ee*Z+J,P},N.rotate=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=O[4],Z=O[5],K=O[6],Q=O[7],J=O[8],$=_Mathsin(X),ee=_Mathcos(X);return P[0]=ee*V+$*H,P[1]=ee*Y+$*W,P[2]=ee*G+$*Z,P[3]=ee*H-$*V,P[4]=ee*W-$*Y,P[5]=ee*Z-$*G,P[6]=K,P[7]=Q,P[8]=J,P},N.scale=function(P,O,X){var V=X[0],Y=X[1];return P[0]=V*O[0],P[1]=V*O[1],P[2]=V*O[2],P[3]=Y*O[3],P[4]=Y*O[4],P[5]=Y*O[5],P[6]=O[6],P[7]=O[7],P[8]=O[8],P},N.fromTranslation=function(P,O){return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=1,P[5]=0,P[6]=O[0],P[7]=O[1],P[8]=1,P},N.fromRotation=function(P,O){var X=_Mathsin(O),V=_Mathcos(O);return P[0]=V,P[1]=X,P[2]=0,P[3]=-X,P[4]=V,P[5]=0,P[6]=0,P[7]=0,P[8]=1,P},N.fromScaling=function(P,O){return P[0]=O[0],P[1]=0,P[2]=0,P[3]=0,P[4]=O[1],P[5]=0,P[6]=0,P[7]=0,P[8]=1,P},N.fromMat2d=function(P,O){return P[0]=O[0],P[1]=O[1],P[2]=0,P[3]=O[2],P[4]=O[3],P[5]=0,P[6]=O[4],P[7]=O[5],P[8]=1,P},N.fromQuat=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=X+X,W=V+V,Z=Y+Y,K=X*H,Q=V*H,J=V*W,$=Y*H,ee=Y*W,ae=Y*Z,ie=G*H,re=G*W,oe=G*Z;return P[0]=1-J-ae,P[3]=Q-oe,P[6]=$+re,P[1]=Q+oe,P[4]=1-K-ae,P[7]=ee-ie,P[2]=$-re,P[5]=ee+ie,P[8]=1-K-J,P},N.normalFromMat4=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=O[4],W=O[5],Z=O[6],K=O[7],Q=O[8],J=O[9],$=O[10],ee=O[11],ae=O[12],ie=O[13],re=O[14],oe=O[15],ne=X*W-V*H,se=X*Z-Y*H,ue=X*K-G*H,ce=V*Z-Y*W,me=V*K-G*W,xe=Y*K-G*Z,pe=Q*ie-J*ae,ge=Q*re-$*ae,he=Q*oe-ee*ae,ve=J*re-$*ie,Ee=J*oe-ee*ie,_e=$*oe-ee*re,ye=ne*_e-se*Ee+ue*ve+ce*he-me*ge+xe*pe;return ye?(ye=1/ye,P[0]=(W*_e-Z*Ee+K*ve)*ye,P[1]=(Z*he-H*_e-K*ge)*ye,P[2]=(H*Ee-W*he+K*pe)*ye,P[3]=(Y*Ee-V*_e-G*ve)*ye,P[4]=(X*_e-Y*he+G*ge)*ye,P[5]=(V*he-X*Ee-G*pe)*ye,P[6]=(ie*xe-re*me+oe*ce)*ye,P[7]=(re*ue-ae*xe-oe*se)*ye,P[8]=(ae*me-ie*ue+oe*ne)*ye,P):null},N.str=function(P){return'mat3('+P[0]+', '+P[1]+', '+P[2]+', '+P[3]+', '+P[4]+', '+P[5]+', '+P[6]+', '+P[7]+', '+P[8]+')'},N.frob=function(P){return _Mathsqrt(_Mathpow(P[0],2)+_Mathpow(P[1],2)+_Mathpow(P[2],2)+_Mathpow(P[3],2)+_Mathpow(P[4],2)+_Mathpow(P[5],2)+_Mathpow(P[6],2)+_Mathpow(P[7],2)+_Mathpow(P[8],2))},N.add=function(P,O,X){return P[0]=O[0]+X[0],P[1]=O[1]+X[1],P[2]=O[2]+X[2],P[3]=O[3]+X[3],P[4]=O[4]+X[4],P[5]=O[5]+X[5],P[6]=O[6]+X[6],P[7]=O[7]+X[7],P[8]=O[8]+X[8],P},N.subtract=function(P,O,X){return P[0]=O[0]-X[0],P[1]=O[1]-X[1],P[2]=O[2]-X[2],P[3]=O[3]-X[3],P[4]=O[4]-X[4],P[5]=O[5]-X[5],P[6]=O[6]-X[6],P[7]=O[7]-X[7],P[8]=O[8]-X[8],P},N.sub=N.subtract,N.multiplyScalar=function(P,O,X){return P[0]=O[0]*X,P[1]=O[1]*X,P[2]=O[2]*X,P[3]=O[3]*X,P[4]=O[4]*X,P[5]=O[5]*X,P[6]=O[6]*X,P[7]=O[7]*X,P[8]=O[8]*X,P},N.multiplyScalarAndAdd=function(P,O,X,V){return P[0]=O[0]+X[0]*V,P[1]=O[1]+X[1]*V,P[2]=O[2]+X[2]*V,P[3]=O[3]+X[3]*V,P[4]=O[4]+X[4]*V,P[5]=O[5]+X[5]*V,P[6]=O[6]+X[6]*V,P[7]=O[7]+X[7]*V,P[8]=O[8]+X[8]*V,P},N.exactEquals=function(P,O){return P[0]===O[0]&&P[1]===O[1]&&P[2]===O[2]&&P[3]===O[3]&&P[4]===O[4]&&P[5]===O[5]&&P[6]===O[6]&&P[7]===O[7]&&P[8]===O[8]},N.equals=function(P,O){var X=P[0],V=P[1],Y=P[2],G=P[3],H=P[4],W=P[5],Z=P[6],K=P[7],Q=P[8],J=O[0],$=O[1],ee=O[2],ae=O[3],ie=O[4],re=O[5],oe=P[6],ne=O[7],se=O[8];return _Mathabs(X-J)<=I.EPSILON*_Mathmax(1,_Mathabs(X),_Mathabs(J))&&_Mathabs(V-$)<=I.EPSILON*_Mathmax(1,_Mathabs(V),_Mathabs($))&&_Mathabs(Y-ee)<=I.EPSILON*_Mathmax(1,_Mathabs(Y),_Mathabs(ee))&&_Mathabs(G-ae)<=I.EPSILON*_Mathmax(1,_Mathabs(G),_Mathabs(ae))&&_Mathabs(H-ie)<=I.EPSILON*_Mathmax(1,_Mathabs(H),_Mathabs(ie))&&_Mathabs(W-re)<=I.EPSILON*_Mathmax(1,_Mathabs(W),_Mathabs(re))&&_Mathabs(Z-oe)<=I.EPSILON*_Mathmax(1,_Mathabs(Z),_Mathabs(oe))&&_Mathabs(K-ne)<=I.EPSILON*_Mathmax(1,_Mathabs(K),_Mathabs(ne))&&_Mathabs(Q-se)<=I.EPSILON*_Mathmax(1,_Mathabs(Q),_Mathabs(se))},h.exports=N},function(h,F,T){var I=T(6),N={};N.create=function(){var P=new I.ARRAY_TYPE(3);return P[0]=0,P[1]=0,P[2]=0,P},N.clone=function(P){var O=new I.ARRAY_TYPE(3);return O[0]=P[0],O[1]=P[1],O[2]=P[2],O},N.fromValues=function(P,O,X){var V=new I.ARRAY_TYPE(3);return V[0]=P,V[1]=O,V[2]=X,V},N.copy=function(P,O){return P[0]=O[0],P[1]=O[1],P[2]=O[2],P},N.set=function(P,O,X,V){return P[0]=O,P[1]=X,P[2]=V,P},N.add=function(P,O,X){return P[0]=O[0]+X[0],P[1]=O[1]+X[1],P[2]=O[2]+X[2],P},N.subtract=function(P,O,X){return P[0]=O[0]-X[0],P[1]=O[1]-X[1],P[2]=O[2]-X[2],P},N.sub=N.subtract,N.multiply=function(P,O,X){return P[0]=O[0]*X[0],P[1]=O[1]*X[1],P[2]=O[2]*X[2],P},N.mul=N.multiply,N.divide=function(P,O,X){return P[0]=O[0]/X[0],P[1]=O[1]/X[1],P[2]=O[2]/X[2],P},N.div=N.divide,N.ceil=function(P,O){return P[0]=_Mathceil(O[0]),P[1]=_Mathceil(O[1]),P[2]=_Mathceil(O[2]),P},N.floor=function(P,O){return P[0]=_Mathfloor(O[0]),P[1]=_Mathfloor(O[1]),P[2]=_Mathfloor(O[2]),P},N.min=function(P,O,X){return P[0]=_Mathmin(O[0],X[0]),P[1]=_Mathmin(O[1],X[1]),P[2]=_Mathmin(O[2],X[2]),P},N.max=function(P,O,X){return P[0]=_Mathmax(O[0],X[0]),P[1]=_Mathmax(O[1],X[1]),P[2]=_Mathmax(O[2],X[2]),P},N.round=function(P,O){return P[0]=_Mathround(O[0]),P[1]=_Mathround(O[1]),P[2]=_Mathround(O[2]),P},N.scale=function(P,O,X){return P[0]=O[0]*X,P[1]=O[1]*X,P[2]=O[2]*X,P},N.scaleAndAdd=function(P,O,X,V){return P[0]=O[0]+X[0]*V,P[1]=O[1]+X[1]*V,P[2]=O[2]+X[2]*V,P},N.distance=function(P,O){var X=O[0]-P[0],V=O[1]-P[1],Y=O[2]-P[2];return _Mathsqrt(X*X+V*V+Y*Y)},N.dist=N.distance,N.squaredDistance=function(P,O){var X=O[0]-P[0],V=O[1]-P[1],Y=O[2]-P[2];return X*X+V*V+Y*Y},N.sqrDist=N.squaredDistance,N.length=function(P){var O=P[0],X=P[1],V=P[2];return _Mathsqrt(O*O+X*X+V*V)},N.len=N.length,N.squaredLength=function(P){var O=P[0],X=P[1],V=P[2];return O*O+X*X+V*V},N.sqrLen=N.squaredLength,N.negate=function(P,O){return P[0]=-O[0],P[1]=-O[1],P[2]=-O[2],P},N.inverse=function(P,O){return P[0]=1/O[0],P[1]=1/O[1],P[2]=1/O[2],P},N.normalize=function(P,O){var X=O[0],V=O[1],Y=O[2],G=X*X+V*V+Y*Y;return 0<G&&(G=1/_Mathsqrt(G),P[0]=O[0]*G,P[1]=O[1]*G,P[2]=O[2]*G),P},N.dot=function(P,O){return P[0]*O[0]+P[1]*O[1]+P[2]*O[2]},N.cross=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=X[0],W=X[1],Z=X[2];return P[0]=Y*Z-G*W,P[1]=G*H-V*Z,P[2]=V*W-Y*H,P},N.lerp=function(P,O,X,V){var Y=O[0],G=O[1],H=O[2];return P[0]=Y+V*(X[0]-Y),P[1]=G+V*(X[1]-G),P[2]=H+V*(X[2]-H),P},N.hermite=function(P,O,X,V,Y,G){var H=G*G,W=H*(2*G-3)+1,Z=H*(G-2)+G,K=H*(G-1),Q=H*(3-2*G);return P[0]=O[0]*W+X[0]*Z+V[0]*K+Y[0]*Q,P[1]=O[1]*W+X[1]*Z+V[1]*K+Y[1]*Q,P[2]=O[2]*W+X[2]*Z+V[2]*K+Y[2]*Q,P},N.bezier=function(P,O,X,V,Y,G){var H=1-G,W=H*H,Z=G*G,K=W*H,Q=3*G*W,J=3*Z*H,$=Z*G;return P[0]=O[0]*K+X[0]*Q+V[0]*J+Y[0]*$,P[1]=O[1]*K+X[1]*Q+V[1]*J+Y[1]*$,P[2]=O[2]*K+X[2]*Q+V[2]*J+Y[2]*$,P},N.random=function(P,O){O=O||1;var X=2*I.RANDOM()*_MathPI,V=2*I.RANDOM()-1,Y=_Mathsqrt(1-V*V)*O;return P[0]=_Mathcos(X)*Y,P[1]=_Mathsin(X)*Y,P[2]=V*O,P},N.transformMat4=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=X[3]*V+X[7]*Y+X[11]*G+X[15];return H=H||1,P[0]=(X[0]*V+X[4]*Y+X[8]*G+X[12])/H,P[1]=(X[1]*V+X[5]*Y+X[9]*G+X[13])/H,P[2]=(X[2]*V+X[6]*Y+X[10]*G+X[14])/H,P},N.transformMat3=function(P,O,X){var V=O[0],Y=O[1],G=O[2];return P[0]=V*X[0]+Y*X[3]+G*X[6],P[1]=V*X[1]+Y*X[4]+G*X[7],P[2]=V*X[2]+Y*X[5]+G*X[8],P},N.transformQuat=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=X[0],W=X[1],Z=X[2],K=X[3],Q=K*V+W*G-Z*Y,J=K*Y+Z*V-H*G,$=K*G+H*Y-W*V,ee=-H*V-W*Y-Z*G;return P[0]=Q*K+ee*-H+J*-Z-$*-W,P[1]=J*K+ee*-W+$*-H-Q*-Z,P[2]=$*K+ee*-Z+Q*-W-J*-H,P},N.rotateX=function(P,O,X,V){var Y=[],G=[];return Y[0]=O[0]-X[0],Y[1]=O[1]-X[1],Y[2]=O[2]-X[2],G[0]=Y[0],G[1]=Y[1]*_Mathcos(V)-Y[2]*_Mathsin(V),G[2]=Y[1]*_Mathsin(V)+Y[2]*_Mathcos(V),P[0]=G[0]+X[0],P[1]=G[1]+X[1],P[2]=G[2]+X[2],P},N.rotateY=function(P,O,X,V){var Y=[],G=[];return Y[0]=O[0]-X[0],Y[1]=O[1]-X[1],Y[2]=O[2]-X[2],G[0]=Y[2]*_Mathsin(V)+Y[0]*_Mathcos(V),G[1]=Y[1],G[2]=Y[2]*_Mathcos(V)-Y[0]*_Mathsin(V),P[0]=G[0]+X[0],P[1]=G[1]+X[1],P[2]=G[2]+X[2],P},N.rotateZ=function(P,O,X,V){var Y=[],G=[];return Y[0]=O[0]-X[0],Y[1]=O[1]-X[1],Y[2]=O[2]-X[2],G[0]=Y[0]*_Mathcos(V)-Y[1]*_Mathsin(V),G[1]=Y[0]*_Mathsin(V)+Y[1]*_Mathcos(V),G[2]=Y[2],P[0]=G[0]+X[0],P[1]=G[1]+X[1],P[2]=G[2]+X[2],P},N.forEach=function(){var P=N.create();return function(O,X,V,Y,G,H){var W,Z;for(X||(X=3),V||(V=0),Z=Y?_Mathmin(Y*X+V,O.length):O.length,W=V;W<Z;W+=X)P[0]=O[W],P[1]=O[W+1],P[2]=O[W+2],G(P,P,H),O[W]=P[0],O[W+1]=P[1],O[W+2]=P[2];return O}}(),N.angle=function(P,O){var X=N.fromValues(P[0],P[1],P[2]),V=N.fromValues(O[0],O[1],O[2]);N.normalize(X,X),N.normalize(V,V);var Y=N.dot(X,V);return 1<Y?0:_Mathacos(Y)},N.str=function(P){return'vec3('+P[0]+', '+P[1]+', '+P[2]+')'},N.exactEquals=function(P,O){return P[0]===O[0]&&P[1]===O[1]&&P[2]===O[2]},N.equals=function(P,O){var X=P[0],V=P[1],Y=P[2],G=O[0],H=O[1],W=O[2];return _Mathabs(X-G)<=I.EPSILON*_Mathmax(1,_Mathabs(X),_Mathabs(G))&&_Mathabs(V-H)<=I.EPSILON*_Mathmax(1,_Mathabs(V),_Mathabs(H))&&_Mathabs(Y-W)<=I.EPSILON*_Mathmax(1,_Mathabs(Y),_Mathabs(W))},h.exports=N},function(h,F,T){var I=T(6),N={};N.create=function(){var P=new I.ARRAY_TYPE(4);return P[0]=0,P[1]=0,P[2]=0,P[3]=0,P},N.clone=function(P){var O=new I.ARRAY_TYPE(4);return O[0]=P[0],O[1]=P[1],O[2]=P[2],O[3]=P[3],O},N.fromValues=function(P,O,X,V){var Y=new I.ARRAY_TYPE(4);return Y[0]=P,Y[1]=O,Y[2]=X,Y[3]=V,Y},N.copy=function(P,O){return P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[3],P},N.set=function(P,O,X,V,Y){return P[0]=O,P[1]=X,P[2]=V,P[3]=Y,P},N.add=function(P,O,X){return P[0]=O[0]+X[0],P[1]=O[1]+X[1],P[2]=O[2]+X[2],P[3]=O[3]+X[3],P},N.subtract=function(P,O,X){return P[0]=O[0]-X[0],P[1]=O[1]-X[1],P[2]=O[2]-X[2],P[3]=O[3]-X[3],P},N.sub=N.subtract,N.multiply=function(P,O,X){return P[0]=O[0]*X[0],P[1]=O[1]*X[1],P[2]=O[2]*X[2],P[3]=O[3]*X[3],P},N.mul=N.multiply,N.divide=function(P,O,X){return P[0]=O[0]/X[0],P[1]=O[1]/X[1],P[2]=O[2]/X[2],P[3]=O[3]/X[3],P},N.div=N.divide,N.ceil=function(P,O){return P[0]=_Mathceil(O[0]),P[1]=_Mathceil(O[1]),P[2]=_Mathceil(O[2]),P[3]=_Mathceil(O[3]),P},N.floor=function(P,O){return P[0]=_Mathfloor(O[0]),P[1]=_Mathfloor(O[1]),P[2]=_Mathfloor(O[2]),P[3]=_Mathfloor(O[3]),P},N.min=function(P,O,X){return P[0]=_Mathmin(O[0],X[0]),P[1]=_Mathmin(O[1],X[1]),P[2]=_Mathmin(O[2],X[2]),P[3]=_Mathmin(O[3],X[3]),P},N.max=function(P,O,X){return P[0]=_Mathmax(O[0],X[0]),P[1]=_Mathmax(O[1],X[1]),P[2]=_Mathmax(O[2],X[2]),P[3]=_Mathmax(O[3],X[3]),P},N.round=function(P,O){return P[0]=_Mathround(O[0]),P[1]=_Mathround(O[1]),P[2]=_Mathround(O[2]),P[3]=_Mathround(O[3]),P},N.scale=function(P,O,X){return P[0]=O[0]*X,P[1]=O[1]*X,P[2]=O[2]*X,P[3]=O[3]*X,P},N.scaleAndAdd=function(P,O,X,V){return P[0]=O[0]+X[0]*V,P[1]=O[1]+X[1]*V,P[2]=O[2]+X[2]*V,P[3]=O[3]+X[3]*V,P},N.distance=function(P,O){var X=O[0]-P[0],V=O[1]-P[1],Y=O[2]-P[2],G=O[3]-P[3];return _Mathsqrt(X*X+V*V+Y*Y+G*G)},N.dist=N.distance,N.squaredDistance=function(P,O){var X=O[0]-P[0],V=O[1]-P[1],Y=O[2]-P[2],G=O[3]-P[3];return X*X+V*V+Y*Y+G*G},N.sqrDist=N.squaredDistance,N.length=function(P){var O=P[0],X=P[1],V=P[2],Y=P[3];return _Mathsqrt(O*O+X*X+V*V+Y*Y)},N.len=N.length,N.squaredLength=function(P){var O=P[0],X=P[1],V=P[2],Y=P[3];return O*O+X*X+V*V+Y*Y},N.sqrLen=N.squaredLength,N.negate=function(P,O){return P[0]=-O[0],P[1]=-O[1],P[2]=-O[2],P[3]=-O[3],P},N.inverse=function(P,O){return P[0]=1/O[0],P[1]=1/O[1],P[2]=1/O[2],P[3]=1/O[3],P},N.normalize=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=X*X+V*V+Y*Y+G*G;return 0<H&&(H=1/_Mathsqrt(H),P[0]=X*H,P[1]=V*H,P[2]=Y*H,P[3]=G*H),P},N.dot=function(P,O){return P[0]*O[0]+P[1]*O[1]+P[2]*O[2]+P[3]*O[3]},N.lerp=function(P,O,X,V){var Y=O[0],G=O[1],H=O[2],W=O[3];return P[0]=Y+V*(X[0]-Y),P[1]=G+V*(X[1]-G),P[2]=H+V*(X[2]-H),P[3]=W+V*(X[3]-W),P},N.random=function(P,O){return O=O||1,P[0]=I.RANDOM(),P[1]=I.RANDOM(),P[2]=I.RANDOM(),P[3]=I.RANDOM(),N.normalize(P,P),N.scale(P,P,O),P},N.transformMat4=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3];return P[0]=X[0]*V+X[4]*Y+X[8]*G+X[12]*H,P[1]=X[1]*V+X[5]*Y+X[9]*G+X[13]*H,P[2]=X[2]*V+X[6]*Y+X[10]*G+X[14]*H,P[3]=X[3]*V+X[7]*Y+X[11]*G+X[15]*H,P},N.transformQuat=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=X[0],W=X[1],Z=X[2],K=X[3],Q=K*V+W*G-Z*Y,J=K*Y+Z*V-H*G,$=K*G+H*Y-W*V,ee=-H*V-W*Y-Z*G;return P[0]=Q*K+ee*-H+J*-Z-$*-W,P[1]=J*K+ee*-W+$*-H-Q*-Z,P[2]=$*K+ee*-Z+Q*-W-J*-H,P[3]=O[3],P},N.forEach=function(){var P=N.create();return function(O,X,V,Y,G,H){var W,Z;for(X||(X=4),V||(V=0),Z=Y?_Mathmin(Y*X+V,O.length):O.length,W=V;W<Z;W+=X)P[0]=O[W],P[1]=O[W+1],P[2]=O[W+2],P[3]=O[W+3],G(P,P,H),O[W]=P[0],O[W+1]=P[1],O[W+2]=P[2],O[W+3]=P[3];return O}}(),N.str=function(P){return'vec4('+P[0]+', '+P[1]+', '+P[2]+', '+P[3]+')'},N.exactEquals=function(P,O){return P[0]===O[0]&&P[1]===O[1]&&P[2]===O[2]&&P[3]===O[3]},N.equals=function(P,O){var X=P[0],V=P[1],Y=P[2],G=P[3],H=O[0],W=O[1],Z=O[2],K=O[3];return _Mathabs(X-H)<=I.EPSILON*_Mathmax(1,_Mathabs(X),_Mathabs(H))&&_Mathabs(V-W)<=I.EPSILON*_Mathmax(1,_Mathabs(V),_Mathabs(W))&&_Mathabs(Y-Z)<=I.EPSILON*_Mathmax(1,_Mathabs(Y),_Mathabs(Z))&&_Mathabs(G-K)<=I.EPSILON*_Mathmax(1,_Mathabs(G),_Mathabs(K))},h.exports=N},function(h,F,T){'use strict';var I=T(11),N=T(2);const P='MODE_DRAG',O='MODE_PAN',X='MODE_ZOOM',V=new N.a(0,1,0),Y=1e-4;F.a=class{constructor(H,W){this._onTouchStart=($)=>{if($.preventDefault(),$.touches)switch($.touches.length){case 1:this._mode=P,this._offsetY=this._rotationY,this._offsetX=this._rotationX;break;case 2:{this._mode=X,this._radiusOffset=this._radius;break}default:this._mode=O,this._offsetY=this.target.y,this._offsetX=this.target.x;}else switch($.which){case 3:this._mode=O,this._offsetY=this.target.y,this._offsetX=this.target.x;break;default:this._mode=P,this._offsetY=this._rotationY,this._offsetX=this._rotationX;}this._startY=$.pageX/this._width,this._startX=$.pageY/this._height,this._targetOffset.copy(this.target),this._radiusOffset=this._radius,this.isDown=!0},this._onTouchMove=($)=>{if(this.isDown){switch(this._mode){case O:{if(!this.pan)return;const ee=$.pageX/this._width,ae=$.pageY/this._height;this._direction.copy(this._camera.position).subtract(this.target).normalize();const ie=this._direction.cross(V),re=this._targetOffset.x+-(this._startY-ee)*this.panSpeed*ie.x,oe=this._targetOffset.y+-(this._startX-ae)*this.panSpeed,ne=this._targetOffset.z+-(this._startY-ee)*this.panSpeed*ie.z;this.target.set(re,oe,ne);break}case X:{if(!this.zoom)return;const ee=$.touches[0].pageX-$.touches[1].pageX,ae=$.touches[0].pageY-$.touches[1].pageY,ie=_Mathsqrt(ee*ee+ae*ae),re=this._lastZoomDistance>ie?1:-1;this._zoomConstraint(100*re),this._lastZoomDistance=ie;break}default:{const ee=$.pageX/this._width,ae=$.pageY/this._height;this._rotationX=this._offsetX+-(this._startX-ae)*this.rotationSpeed,this._rotationY=this._offsetY+(this._startY-ee)*this.rotationSpeed,this._rotationX=T.i(I.clamp)(this._rotationX,-_MathPI/2,_MathPI/2)}}this.update()}},this._onTouchEnd=()=>{this.isDown=!1},this._onContextMenu=($)=>{$.preventDefault()},this._onMouseWheel=($)=>{let ee=0;$.wheelDelta?ee=$.wheelDelta:$.detail&&(ee=$.detail),this._zoomConstraint(-ee)},this._onKeypress=($)=>{switch($.keyCode){case 114:this.reset();break;default:}},this.rotationSpeed=5,this.panSpeed=10,this.zoom=!0,this.pan=!0,this.smoothing=!1,this.easing=0.1,this._camera=H,this._element=W,this._zoomMin=0.1,this._zoomMax=Infinity,this._radius=_Mathmax(H.position.x,H.position.z),this._radiusOffset=0,this._defaultRadius=_Mathmax(H.position.x,H.position.z),this._rotationX=_Mathatan(H.position.y-0,+this._radius-0),this._rotationY=_Mathatan(H.position.z-0,H.position.x-0),this._defaultRotationX=_Mathatan(H.position.y-0,+this._radius-0),this._defaultRotationY=_Mathatan(H.position.z-0,H.position.x-0);const Z=this._radius*_Mathsin(this._rotationX),K=this._radius*_Mathcos(this._rotationX),Q=_Mathsin(this._rotationY)*K,J=_Mathcos(this._rotationY)*K;this._x=Q,this._y=Z,this._z=J,this._offsetX=0,this._offsetY=0,this._offsetPanX=0,this._offsetPanY=0,this.target=new N.a,this._targetOffset=new N.a,this._direction=new N.a,this._lastZoomDistance=0,this._width=window.innerWidth,this._height=window.innerHeight,this._element.addEventListener('mousedown',this._onTouchStart,!1),this._element.addEventListener('mousemove',this._onTouchMove,!1),this._element.addEventListener('mouseup',this._onTouchEnd,!1),this._element.addEventListener('touchstart',this._onTouchStart,!1),this._element.addEventListener('touchmove',this._onTouchMove,!1),this._element.addEventListener('touchend',this._onTouchEnd,!1),this._element.addEventListener('contextmenu',this._onContextMenu,!1),window.addEventListener('mousewheel',this._onMouseWheel,!1),window.addEventListener('keypress',this._onKeypress,!1)}_zoomConstraint(H){if(this.zoom){this._radius+=H/1e3*3,this._radius=T.i(I.clamp)(this._radius,this._zoomMin,this._zoomMax),this.update()}}update(){const H=this._radius*_Mathsin(this._rotationX),W=this._radius*_Mathcos(this._rotationX),Z=_Mathsin(this._rotationY)*W,K=_Mathcos(this._rotationY)*W;this.smoothing?(this._x+=(Z-this._x)*this.easing,this._y+=(H-this._y)*this.easing,this._z+=(K-this._z)*this.easing,_Mathabs(this._x-Z)<Y&&(this._x=Z),_Mathabs(this._y-H)<Y&&(this._y=H),_Mathabs(this._z-K)<Y&&(this._z=K)):(this._x=Z,this._y=H,this._z=K),this._camera.position.set(this._x,this._y,this._z).add(this.target),this._camera.lookAt(this.target.x,this.target.y,this.target.z)}reset(){this.target.set(0,0,0),this._rotationY=this._defaultRotationY,this._rotationX=this._defaultRotationX,this._radius=this._defaultRadius,this.update()}dispose(){this._element.removeEventListener('mousedown',this._onTouchStart),this._element.removeEventListener('mousemove',this._onTouchMove),this._element.removeEventListener('mouseup',this._onTouchEnd),this._element.removeEventListener('touchstart',this._onTouchStart),this._element.removeEventListener('touchmove',this._onTouchMove),this._element.removeEventListener('touchend',this._onTouchEnd),this._element.removeEventListener('contextmenu',this._onContextMenu),window.removeEventListener('mousewheel',this._onMouseWheel),window.removeEventListener('keypress',this._onKeypress),this._camera=null,this._element=null}}},function(h,F,T){'use strict';var I=T(1),N=T.n(I),P=T(2);F.a=class{constructor(X){this.projectionMatrix=I.mat4.create(),this.isOrthographicCamera=!0,this.isPespectiveCamera=!1,this.near=0.1,this.far=100,this.fov=65,this.position=new P.a,this.target=new P.a,this.up=new P.a(0,1,0),Object.assign(this,X)}lookAt(X=0,V=0,Y=0){this.target.set(X,V,Y)}updateProjectionMatrix(){I.mat4.ortho(this.projectionMatrix,-1,1,-1,1,this.near,this.far)}}},function(h,F,T){'use strict';var I=T(1),N=T.n(I),P=T(7),O=T(2);F.a=class{constructor(V){this.projectionMatrix=I.mat4.create(),this.isPespectiveCamera=!0,this.isOrthographicCamera=!1,this.near=0.1,this.far=100,this.fov=70,this.ratio=P.RENDERER_DEFAULT_RATIO,this.position=new O.a,this.target=new O.a,this.up=new O.a(0,1,0),Object.assign(this,V)}lookAt(V=0,Y=0,G=0){this.target.set(V,Y,G)}updateProjectionMatrix(){I.mat4.perspective(this.projectionMatrix,this.fov,this.ratio,this.near,this.far)}}},function(h,F,T){'use strict';var I=T(1),N=T.n(I),P=T(2),O=T(16),X=T(28),V=T(11);const Y=I.mat4.create(),G=I.vec3.create(),H=new P.a;let W,Z;const K=new P.a,Q=new P.a,J=new P.a,$=new O.a,ee=new O.a,ae=new O.a;F.a=class{constructor(re,oe,ne,se){this.ray=new X.a,this.near=ne||0,this.far=se||Infinity}setFromCamera(re,oe,ne){ne&&ne.isPespectiveCamera&&(this.ray.origin.copy(ne.position),I.vec3.copy(G,[re.x,re.y,0.5]),I.mat4.multiply(Y,ne.projectionMatrix,oe.modelViewMatrix),I.mat4.invert(Y,Y),I.vec3.transformMat4(G,G,Y),I.vec3.sub(G,G,ne.position.v),I.vec3.normalize(G,G),H.set(G[0],G[1],G[2]),this.ray.direction.copy(H))}uvIntersection(re,oe,ne,se){return Z=T.i(V.barycoordFromPoint)(re.v,oe.v,ne.v,se.v),$.scale(Z.x),ee.scale(Z.y),ae.scale(Z.z),$.add(ee).add(ae),$.clone()}intersectObject(re){let oe,ne;for(let se=0;se<re.geometry.faces.length;se+=1)if(W=re.geometry.faces[se],I.vec3.copy(K.v,W.vertices[0].v),I.vec3.copy(Q.v,W.vertices[1].v),I.vec3.copy(J.v,W.vertices[2].v),I.vec3.transformMat4(K.v,K.v,re.modelMatrix),I.vec3.transformMat4(Q.v,Q.v,re.modelMatrix),I.vec3.transformMat4(J.v,J.v,re.modelMatrix),oe=this.ray.intersectTriangle(K,Q,J),oe){I.vec2.copy($.v,re.geometry.uvs[W.uvs[0]].v),I.vec2.copy(ee.v,re.geometry.uvs[W.uvs[1]].v),I.vec2.copy(ae.v,re.geometry.uvs[W.uvs[2]].v),ne=this.uvIntersection(oe,K,Q,J);break}return oe?{point:oe,uv:ne}:null}}},function(h,F,T){'use strict';var I=T(0),N=T(1),P=T.n(N),O=T(15);let X;F.a=class{constructor(Y){this.pixelRatio=Y.pixelRatio||1,this.width=Y.width*this.pixelRatio,this.height=Y.height*this.pixelRatio,this.ratio=this.width/this.height,this.viewport={x:0,y:0,width:this.width,height:this.height},this.autoClear=!0,this.setClearColor(),X=I.get(),this._frameBuffer=X.createFramebuffer(),X.bindFramebuffer(X.FRAMEBUFFER,this._frameBuffer),this.texture=X.createTexture(),X.bindTexture(X.TEXTURE_2D,this.texture),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR_MIPMAP_NEAREST),X.texImage2D(X.TEXTURE_2D,0,X.RGBA,this.width,this.height,0,X.RGBA,X.UNSIGNED_BYTE,null),this._renderBuffer=X.createRenderbuffer(),X.bindRenderbuffer(X.RENDERBUFFER,this._renderBuffer),X.renderbufferStorage(X.RENDERBUFFER,X.DEPTH_COMPONENT16,this.width,this.height),X.framebufferTexture2D(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_2D,this.texture,0),X.framebufferRenderbuffer(X.FRAMEBUFFER,X.DEPTH_ATTACHMENT,X.RENDERBUFFER,this._renderBuffer),X.bindTexture(X.TEXTURE_2D,null),X.bindRenderbuffer(X.RENDERBUFFER,null),X.bindFramebuffer(X.FRAMEBUFFER,null)}setClearColor(Y=0,G=0,H=0,W=1){X=I.get(),X.clearColor(Y,G,H,W)}setSize(Y,G){const H=Y*this.pixelRatio,W=G*this.pixelRatio;(H!==this.width||W!==this.height)&&(this.width=Y*this.pixelRatio,this.height=G*this.pixelRatio,this.ratio=this.width/this.height,X.bindTexture(X.TEXTURE_2D,this.texture),X.texImage2D(X.TEXTURE_2D,0,X.RGBA,this.width,this.height,0,X.RGBA,X.UNSIGNED_BYTE,null),X.bindTexture(X.TEXTURE_2D,null),X.bindRenderbuffer(X.RENDERBUFFER,this._renderBuffer),X.renderbufferStorage(X.RENDERBUFFER,X.DEPTH_COMPONENT16,this.width,this.height),X.bindRenderbuffer(X.RENDERBUFFER,null),this.setViewport(0,0,Y,G))}setSissorTest(Y=!1){X=I.get(),Y?X.enable(X.SCISSOR_TEST):X.disable(X.SCISSOR_TEST)}setSissor(Y,G,H,W){X=I.get(),X.scissor(Y*this.pixelRatio,G*this.pixelRatio,H*this.pixelRatio,W*this.pixelRatio)}setViewport(Y,G,H,W){this.viewport.x=Y*this.pixelRatio,this.viewport.y=G*this.pixelRatio,this.viewport.width=H*this.pixelRatio,this.viewport.height=W*this.pixelRatio}render(Y,G){X=I.get(),X.viewport(this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height),X.bindFramebuffer(X.FRAMEBUFFER,this._frameBuffer),this.autoClear&&X.clear(X.COLOR_BUFFER_BIT|X.DEPTH_BUFFER_BIT),N.mat4.identity(Y.modelViewMatrix),N.mat4.lookAt(Y.modelViewMatrix,G.position.v,G.target.v,G.up.v),Y.update(),X instanceof WebGL2RenderingContext&&O.updateProjectionView(X,G.projectionMatrix,Y.modelViewMatrix),Y.objects.forEach((H)=>{H.isInstanced?H.drawInstance(Y.modelViewMatrix,G.projectionMatrix,G):H.draw(Y.modelViewMatrix,G.projectionMatrix,G)}),X.bindTexture(X.TEXTURE_2D,this.texture),X.generateMipmap(X.TEXTURE_2D),X.bindTexture(X.TEXTURE_2D,null),X.bindFramebuffer(X.FRAMEBUFFER,null)}}},function(h,F,T){'use strict';var I=T(0),N=T(1),P=T.n(N),O=T(13),X=T(7),V=T(3),Y=T(15),G=T(29);const H=T(87);let W;F.a=class{constructor(K){this.width=X.RENDERER_DEFAULT_WIDTH,this.height=X.RENDERER_DEFAULT_HEIGHT,this.ratio=X.RENDERER_DEFAULT_WIDTH/X.RENDERER_DEFAULT_HEIGHT,this.preserveDrawingBuffer=!1,this.pixelRatio=1,this.prefferedContext=X.RENDERER_DEFAULT_CONTEXT,this.autoClear=!0,Object.assign(this,K),this.canvas=document.createElement('canvas'),this.canvas.width=this.width,this.canvas.height=this.height;const Q={preserveDrawingBuffer:this.preserveDrawingBuffer},J=T.i(G.a)();if(J){let $;if(J.webgl2&&this.prefferedContext===X.WEBGL2_CONTEXT){$=X.WEBGL2_CONTEXT;const ee=this.canvas.getContext('webgl2',Q);I.set(ee,$)}else{$=X.WEBGL_CONTEXT;const ee=this.canvas.getContext('webgl',Q)||this.canvas.getContext('experimental-webgl',Q);I.set(ee,$)}}else return void T.i(O.a)('Webgl not supported');T.i(O.b)(`%c${H.name} ${H.version} webgl${I.webgl2?2:''}`,'padding: 1px; background: #222; color: #ff00ff'),W=I.get(),V.set(W),I.webgl2&&Y.setup(),this.viewport={x:0,y:0,width:W.drawingBufferWidth,height:W.drawingBufferHeight},this.setClearColor(),W.enable(W.DEPTH_TEST)}setClearColor(K=0,Q=0,J=0,$=1){W=I.get(),W.clearColor(K,Q,J,$)}setSize(K,Q){const J=K*this.pixelRatio,$=Q*this.pixelRatio;(J!==this.width||$!==this.height)&&(this.width=K*this.pixelRatio,this.height=Q*this.pixelRatio,this.ratio=this.width/this.height,this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width=`${K}px`,this.canvas.style.height=`${Q}px`,this.setViewport(0,0,K,Q))}setDevicePixelRatio(K=1){this.pixelRatio=K||1,this.setSize(this.width,this.height)}setSissorTest(K=!1){W=I.get(),K?W.enable(W.SCISSOR_TEST):W.disable(W.SCISSOR_TEST)}setSissor(K,Q,J,$){W=I.get(),W.scissor(K*this.pixelRatio,Q*this.pixelRatio,J*this.pixelRatio,$*this.pixelRatio)}setViewport(K,Q,J,$){this.viewport.x=K*this.pixelRatio,this.viewport.y=Q*this.pixelRatio,this.viewport.width=J*this.pixelRatio,this.viewport.height=$*this.pixelRatio}render(K,Q){W=I.get(),W.viewport(this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height),this.autoClear&&W.clear(W.COLOR_BUFFER_BIT|W.DEPTH_BUFFER_BIT),N.mat4.identity(K.modelViewMatrix),N.mat4.lookAt(K.modelViewMatrix,Q.position.v,Q.target.v,Q.up.v),K.update(),W instanceof WebGL2RenderingContext&&Y.updateProjectionView(W,Q.projectionMatrix,K.modelViewMatrix),K.objects.forEach((J)=>{J.isInstanced?J.drawInstance(K.modelViewMatrix,Q.projectionMatrix,Q):J.draw(K.modelViewMatrix,Q.projectionMatrix,Q)})}}},function(h,F,T){'use strict';var I=T(1),N=T.n(I);F.a=class{constructor(){this.objects=[],this.pointLights=void 0,this.directionalLights=void 0,this.modelViewMatrix=I.mat4.create()}add(O){this.objects.push(O)}remove(O,X=!1){const V=this.objects.indexOf(O);-1!==V&&(this.objects.splice(V,1),X&&(O.dispose(),O=void 0))}update(){this.directionalLights&&(this.directionalLights.update(),this.directionalLights.bind()),this.pointLights&&(this.pointLights.update(),this.pointLights.bind())}}},function(h,F,T){'use strict';var I=T(0),N=T(14),P=T.n(N),O=T(20),X=T(19),V=T(21),Y=T(13);let G;F.a=class{constructor(W){this.onTextureLoaded=(Z)=>{this.image=Z,this.update(this.image),this.emit('loaded')},this.onTextureError=(Z)=>{T.i(Y.a)(Z),this.emit('error',Z)},P()(this),G=I.get(),this.src='',this.magFilter=G.NEAREST,this.minFilter=G.NEAREST,this.wrapS=G.CLAMP_TO_EDGE,this.wrapT=G.CLAMP_TO_EDGE,this.resizeToPow2=!1,Object.assign(this,W),this.texture=G.createTexture(),G.bindTexture(G.TEXTURE_2D,this.texture),G.texImage2D(G.TEXTURE_2D,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,this.placeholder()),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,this.magFilter),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,this.minFilter),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,this.wrapS),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,this.wrapT),G.bindTexture(G.TEXTURE_2D,null),this._isHdr='hdr'===this.src.split('.').pop(),this.load(this.src)}load(W){this._isHdr?T.i(X.a)(W).then(this.onTextureLoaded).catch(this.onTextureError):T.i(O.a)(W).then(this.onTextureLoaded).catch(this.onTextureError)}updateImage(W){this.src=W||this.src,this.load(this.src)}update(W){G=I.get(),G.bindTexture(G.TEXTURE_2D,this.texture),G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,!0),W instanceof V.a&&G instanceof WebGL2RenderingContext?G.texImage2D(G.TEXTURE_2D,0,G.RGBA16F,W.width,W.height,0,G.RGBA,G.FLOAT,W.data):G.texImage2D(G.TEXTURE_2D,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,this._resizeImage()),G.bindTexture(G.TEXTURE_2D,null)}placeholder(){const W=document.createElement('canvas');return W.width=1,W.height=1,W}_resizeImage(){if(!this.resizeToPow2||this.image instanceof V.a)return this.image;const W=Array(12).fill(0).map(($,ee)=>{return _Mathpow(2,ee+1)});W.forEach(($)=>{return this.image.width===$&&this.image.height===$&&this.image});const Z=_Mathmax(this.image.width,this.image.height),K=W.reduce(($,ee)=>{return _Mathabs(ee-Z)<_Mathabs($-Z)?ee:$}),Q=document.createElement('canvas'),J=Q.getContext('2d');return Q.width=K,Q.height=K,J.drawImage(this.image,0,0,K,K),Q}dispose(){G=I.get(),G.deleteTexture(this.texture),this.texture=null}}},function(h,F,T){'use strict';var I=T(0),N=T(14),P=T.n(N);let O;F.a=class{constructor(V){P()(this),O=I.get();O instanceof WebGL2RenderingContext&&(this.src=null,this.size=null,Object.assign(this,V),this.texture=O.createTexture(),O.activeTexture(O.TEXTURE0),O.bindTexture(O.TEXTURE_3D,this.texture),O.texParameteri(O.TEXTURE_3D,O.TEXTURE_BASE_LEVEL,0),O.texParameteri(O.TEXTURE_3D,O.TEXTURE_MAX_LEVEL,Math.log2(this.size)),O.texParameteri(O.TEXTURE_3D,O.TEXTURE_MIN_FILTER,O.LINEAR_MIPMAP_LINEAR),O.texParameteri(O.TEXTURE_3D,O.TEXTURE_MAG_FILTER,O.LINEAR),O.texImage3D(O.TEXTURE_3D,0,O.R8,this.size,this.size,this.size,0,O.RED,O.UNSIGNED_BYTE,this.src),O.generateMipmap(O.TEXTURE_3D))}dispose(){O=I.get();O instanceof WebGL2RenderingContext&&(O.deleteTexture(this.texture),this.texture=null)}}},function(h,F,T){'use strict';var I=T(0),N=T(14),P=T.n(N),O=T(20),X=T(19),V=T(21),Y=T(13);let G;F.a=class{constructor(W){this.onTextureLoaded=(Z)=>{this.images=Z,this.update(this.images),this.emit('loaded')},this.onTextureError=(Z)=>{T.i(Y.a)(Z),this.emit('error',Z)},P()(this),G=I.get(),this.src=[,,,,,,].fill(''),this.magFilter=G.LINEAR,this.minFilter=G.LINEAR,this.wrapS=G.CLAMP_TO_EDGE,this.wrapT=G.CLAMP_TO_EDGE,this.resizeToPow2=!1,Object.assign(this,W),this.texture=G.createTexture(),this.images=[],this.loaders=[],this.update(this.placeholder()),this._isHdr='hdr'===this.src[0].split('.').pop(),this.src.forEach((Z,K)=>{this.loaders[K]=this.load(this.src[K])}),Promise.all(this.loaders).then(this.onTextureLoaded).catch(this.onTextureError)}load(W){return this._isHdr?T.i(X.a)(W):T.i(O.a)(W)}update(W){G=I.get(),G.bindTexture(G.TEXTURE_CUBE_MAP,this.texture);const Z=[G.TEXTURE_CUBE_MAP_POSITIVE_X,G.TEXTURE_CUBE_MAP_NEGATIVE_X,G.TEXTURE_CUBE_MAP_POSITIVE_Y,G.TEXTURE_CUBE_MAP_NEGATIVE_Y,G.TEXTURE_CUBE_MAP_POSITIVE_Z,G.TEXTURE_CUBE_MAP_NEGATIVE_Z];for(let K=0;6>K;K+=1){const Q=this._isHdr?W[K]:this._resizeImage(W[K]);G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,!1),Q instanceof V.a?G instanceof WebGL2RenderingContext&&G.texImage2D(Z[K],0,G.RGBA16F,Q.width,Q.height,0,G.RGBA,G.FLOAT,Q.data):G.texImage2D(Z[K],0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,Q),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MAG_FILTER,this.magFilter),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MIN_FILTER,this.minFilter),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_S,this.wrapS),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_T,this.wrapT)}G.bindTexture(G.TEXTURE_CUBE_MAP,null)}placeholder(){const W=[];for(let Z=0;6>Z;Z+=1){const K=document.createElement('canvas');K.width=128,K.height=128,W.push(K)}return W}_resizeImage(W){if(!this.resizeToPow2||W instanceof V.a)return W;const Z=Array(12).fill(0).map((ee,ae)=>{return _Mathpow(2,ae+1)});Z.forEach((ee)=>{return W.width===ee&&W.height===ee&&W});const K=_Mathmax(W.width,W.height),Q=Z.reduce((ee,ae)=>{return _Mathabs(ae-K)<_Mathabs(ee-K)?ae:ee}),J=document.createElement('canvas'),$=J.getContext('2d');return J.width=Q,J.height=Q,$.drawImage(W,0,0,Q,Q),J}}},function(h,F,T){'use strict';var I=T(0),N=T(14),P=T.n(N);let O;F.a=class{constructor(V){this._onCanPlayThrough=()=>{this.emit('canplaythrough')},this._onEnded=()=>{this.emit('ended')},P()(this),O=I.get(),this.src='',this.magFilter=O.NEAREST,this.minFilter=O.NEAREST,this.wrapS=O.CLAMP_TO_EDGE,this.wrapT=O.CLAMP_TO_EDGE,this.loop=!1,this.autoplay=!0,Object.assign(this,V),this.video=document.createElement('video'),this.video.src=this.src,this.video.loop=this.loop,this.video.autoplay=this.autoplay,this.video.setAttribute('webkitplaysinline','webkitplaysinline'),this.video.setAttribute('playsinline','playsinline'),this.video.addEventListener('canplaythrough',this._onCanPlayThrough,!0),this.video.addEventListener('ended',this._onEnded,!0),this._currentTime=0,this.texture=O.createTexture(),O.bindTexture(O.TEXTURE_2D,this.texture),O.texImage2D(O.TEXTURE_2D,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,this.placeholder()),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,this.magFilter),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,this.minFilter),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_S,this.wrapS),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_T,this.wrapT),O.bindTexture(O.TEXTURE_2D,null)}update(){O=I.get(),this.video.readyState>=this.video.HAVE_CURRENT_DATA&&(this.video.currentTime!==this._currentTime&&(O.bindTexture(O.TEXTURE_2D,this.texture),O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,!0),O.texImage2D(O.TEXTURE_2D,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,this.video),O.bindTexture(O.TEXTURE_2D,null)),this._currentTime=this.video.currentTime)}placeholder(){const V=document.createElement('canvas');return V.width=1,V.height=1,V}}},function(h,F,T){'use strict';var I=T(4);class N extends I.a{constructor(P=1,O=1,X=1,V){const Y=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1];for(let Z=0;Z<Y.length;Z+=3)Y[Z]*=P,Y[Z+1]*=O,Y[Z+2]*=X;super(new Float32Array(Y),new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),V)}}F.a=N},function(h,F,T){'use strict';var I=T(4);class N extends I.a{constructor(P=1,O=1,X=1,V=1,Y='XY',G){let H=[],W=[],Z=[],K=[],Q=0;const J=P/X,$=O/V,ie=1/X,re=1/V;for(let oe=0;oe<V;oe+=1)for(let ne=0;ne<X;ne+=1){const se=J*ne+0.5*-P,ue=$*oe+0.5*-O,ce=ne/X,me=oe/V;switch(Y){case'XZ':{H=H.concat([se,0,ue]),H=H.concat([se+J,0,ue]),H=H.concat([se+J,0,ue+$]),H=H.concat([se,0,ue+$]),Z=Z.concat([0,1,0]),Z=Z.concat([0,1,0]),Z=Z.concat([0,1,0]),Z=Z.concat([0,1,0]),K=K.concat([ce,1-me]),K=K.concat([ce+ie,1-me]),K=K.concat([ce+ie,1-(me+re)]),K=K.concat([ce,1-(me+re)]);break}case'YZ':{H=H.concat([0,ue,se]),H=H.concat([0,ue,se+J]),H=H.concat([0,ue+$,se+J]),H=H.concat([0,ue+$,se]),Z=Z.concat([1,0,0]),Z=Z.concat([1,0,0]),Z=Z.concat([1,0,0]),Z=Z.concat([1,0,0]),K=K.concat([1-ce,me]),K=K.concat([1-(ce+ie),me]),K=K.concat([1-(ce+ie),me+re]),K=K.concat([1-ce,me+re]);break}default:H=H.concat([se,ue,0]),H=H.concat([se+J,ue,0]),H=H.concat([se+J,ue+$,0]),H=H.concat([se,ue+$,0]),Z=Z.concat([0,0,1]),Z=Z.concat([0,0,1]),Z=Z.concat([0,0,1]),Z=Z.concat([0,0,1]),K=K.concat([ce,me]),K=K.concat([ce+ie,me]),K=K.concat([ce+ie,me+re]),K=K.concat([ce,me+re]);}W.push(4*Q+0),W.push(4*Q+1),W.push(4*Q+2),W.push(4*Q+0),W.push(4*Q+2),W.push(4*Q+3),Q+=1}super(new Float32Array(H),new Uint16Array(W),new Float32Array(Z),new Float32Array(K),G)}}F.a=N},function(h,F,T){'use strict';function I(){return`${G.a}
	precision ${V.capabilities.precision} float;
	in vec3 vColor;
	out vec4 outgoingColor;

	void main(void){
		outgoingColor = vec4(vColor, 1.0);
	}
	`}function N(){return`
	precision ${V.capabilities.precision} float;
	varying vec3 vColor;

	void main(void){
		gl_FragColor = vec4(vColor, 1.0);
	}
	`}var P=T(8),O=T(9),X=T(0),V=T(3),Y=T(4),G=T(5),H=T(10);let W;const Z=`${G.a}
	layout (location = 0) in vec3 aVertexPosition;
	layout (location = 1) in vec3 aVertexColor;

	${H.a}

	uniform mat4 uModelMatrix;

	out vec3 vColor;

	void main(void){
		vColor = aVertexColor;
		gl_Position = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
	}
`,K=`
	attribute vec3 aVertexPosition;
	attribute vec3 aVertexColor;

	uniform mat4 uProjectionMatrix;
	uniform mat4 uViewMatrix;
	uniform mat4 uModelMatrix;

	varying vec3 vColor;

	void main(void){
		vColor = aVertexColor;
		gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
	}
`;class Q extends Y.a{constructor($){let ee=[];ee=ee.concat([0,0,0,$,0,0]),ee=ee.concat([0,0,0,0,$,0]),ee=ee.concat([0,0,0,0,0,$]);const ae=new Float32Array([1,0,0,1,0,0,0,1,0,0,1,0,0,0,1,0,0,1]);super(new Float32Array(ee),null,null,null,ae)}}class J extends P.a{constructor($=1){const ee=X.webgl2?Z:K,ae=X.webgl2?I():N();super(new Q($),new O.a({name:'AxisHelper',vertexShader:ee,fragmentShader:ae}))}draw($,ee){this.visible&&(W=X.get(),this.updateMatrix(),this.shader.program.bind(),this.shader.setUniforms($,ee,this.modelMatrix),V.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),W.drawArrays(W.LINES,0,this.geometry.attributes.aVertexPosition.numItems),V.extensions.vertexArrayObject&&this.vao.unbind())}}F.a=J},function(h,F,T){'use strict';function I(){return`${G.a}
	precision ${V.capabilities.precision} float;
	out vec4 outgoingColor;

	void main(void){
		outgoingColor = vec4(1.0, 1.0, 0.0, 1.0);
	}
	`}function N(){return`
	precision ${V.capabilities.precision} float;

	void main(void){
		gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
	}
	`}var P=T(8),O=T(9),X=T(0),V=T(3),Y=T(4),G=T(5),H=T(10),W=T(7);let Z;const K=`${G.a}
	${H.a}

	in vec3 aVertexPosition;

	uniform mat4 uModelMatrix;
	uniform mat3 uNormalMatrix;

	void main(void){
		gl_Position = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
	}
`,Q=`
	attribute vec3 aVertexPosition;

	uniform mat4 uProjectionMatrix;
	uniform mat4 uViewMatrix;
	uniform mat4 uModelMatrix;
	uniform mat3 uNormalMatrix;

	void main(void){
		gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
	}
`;class J extends Y.a{constructor(ae=0.5){function ie(ce,me=1){oe(-1*me,-1*me,ce),oe(-1*me,1*me,ce),oe(-1*me,1*me,ce),oe(1*me,1*me,ce),oe(1*me,1*me,ce),oe(1*me,-1*me,ce),oe(1*me,-1*me,ce),oe(-1*me,-1*me,ce)}let re=[];const oe=(ce,me,xe)=>{re=re.concat([ce,me,xe])},ne=3.5,se=0.5,ue=3;ie(0,se),ie(ne,ue),oe(-1*se,-1*se,0),oe(-1*ue,-1*ue,ne),oe(-1*se,1*se,0),oe(-1*ue,1*ue,ne),oe(1*se,1*se,0),oe(1*ue,1*ue,ne),oe(1*se,-1*se,0),oe(1*ue,-1*ue,ne),super(new Float32Array(re))}}class $ extends P.a{constructor(ee){const ae=X.webgl2?K:Q,ie=X.webgl2?I():N();super(new J(ee),new O.a({name:'CameraHelper',vertexShader:ae,fragmentShader:ie,drawType:W.DRAW_LINE_STRIP})),this.camera=ee}update(){this.position.copy(this.camera.position),this.lookAt(this.camera.target)}draw(ee,ae){this.visible&&(Z=X.get(),this.updateMatrix(),this.shader.program.bind(),this.shader.setUniforms(ee,ae,this.modelMatrix),V.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),Z.drawArrays(Z.LINES,0,this.geometry.attributes.aVertexPosition.numItems),V.extensions.vertexArrayObject&&this.vao.unbind())}}F.a=$},function(h,F,T){'use strict';function I(){return`${H.a}
	precision ${Y.capabilities.precision} float;
	out vec4 outgoingColor;

	void main(void){
		outgoingColor = vec4(vec3(0.5), 1.0);
	}
	`}function N(){return`
	precision ${Y.capabilities.precision} float;

	void main(void){
		gl_FragColor = vec4(vec3(0.5), 1.0);
	}
	`}var P=T(11),O=T(8),X=T(9),V=T(0),Y=T(3),G=T(4),H=T(5),W=T(10);let Z;const K=`${H.a}
	${W.a}

	in vec3 aVertexPosition;

	uniform mat4 uModelMatrix;

	void main(void){
		gl_Position = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
	}
`,Q=`
	attribute vec3 aVertexPosition;

	uniform mat4 uProjectionMatrix;
	uniform mat4 uViewMatrix;
	uniform mat4 uModelMatrix;

	void main(void){
		gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
	}
`;class J extends G.a{constructor(ee,ae){let ie=[];const re=0.5*ee;for(let oe=0;oe<ae+1;oe+=1){const ne=T.i(P.lerp)(-re,re,oe/ae),ce=T.i(P.lerp)(-re,re,oe/ae);ie=ie.concat([ne,0,-re,ce,0,re])}for(let oe=0;oe<ae+1;oe+=1){const ue=T.i(P.lerp)(-re,re,oe/ae),xe=T.i(P.lerp)(-re,re,oe/ae);ie=ie.concat([-re,0,ue,re,0,xe])}super(new Float32Array(ie))}}class $ extends O.a{constructor(ee=1,ae=10){const ie=V.webgl2?K:Q,re=V.webgl2?I():N();super(new J(ee,ae),new X.a({name:'GridHelper',vertexShader:ie,fragmentShader:re}))}draw(ee,ae){this.visible&&(Z=V.get(),this.updateMatrix(),this.shader.program.bind(),this.shader.setUniforms(ee,ae,this.modelMatrix),Y.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),Z.drawArrays(Z.LINES,0,this.geometry.attributes.aVertexPosition.numItems),Y.extensions.vertexArrayObject&&this.vao.unbind())}}F.a=$},function(h,F,T){'use strict';function I(){return`${G.a}
	precision ${V.capabilities.precision} float;
	out vec4 outgoingColor;

	void main(void){
		outgoingColor = vec4(1.0);
	}
	`}function N(){return`
	precision ${V.capabilities.precision} float;

	void main(void){
		gl_FragColor = vec4(1.0);
	}
	`}var P=T(8),O=T(9),X=T(0),V=T(3),Y=T(4),G=T(5),H=T(10);let W;const Z=`${G.a}
	${H.a}

	in vec3 aVertexPosition;

	uniform mat4 uModelMatrix;
	uniform mat3 uNormalMatrix;

	void main(void){
		gl_Position = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
	}
`,K=`
	attribute vec3 aVertexPosition;

	uniform mat4 uProjectionMatrix;
	uniform mat4 uViewMatrix;
	uniform mat4 uModelMatrix;
	uniform mat3 uNormalMatrix;

	void main(void){
		gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
	}
`;class Q extends Y.a{constructor($,ee=0.5){let ae=[];const ie=$.scale.x,re=$.scale.y,oe=$.scale.z,ne=$.geometry.bufferNormals.length/3;for(let se=0;se<ne;se+=1){const ue=3*se,ce=ie*$.geometry.bufferVertices[ue],me=re*$.geometry.bufferVertices[ue+1],xe=oe*$.geometry.bufferVertices[ue+2],pe=$.geometry.bufferNormals[ue],ge=$.geometry.bufferNormals[ue+1],he=$.geometry.bufferNormals[ue+2];ae=ae.concat([ce,me,xe,ce+ee*pe,me+ee*ge,xe+ee*he])}super(new Float32Array(ae))}}class J extends P.a{constructor($,ee=1){const ae=X.webgl2?Z:K,ie=X.webgl2?I():N();super(new Q($,ee),new O.a({name:'NormalsHelper',vertexShader:ae,fragmentShader:ie}))}draw($,ee){this.visible&&(W=X.get(),this.updateMatrix(),this.shader.program.bind(),this.shader.setUniforms($,ee,this.modelMatrix),V.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),W.drawArrays(W.LINES,0,this.geometry.attributes.aVertexPosition.numItems),V.extensions.vertexArrayObject&&this.vao.unbind())}}F.a=J},function(h,F,T){'use strict';function I(){return`${W.a}
	precision ${G.capabilities.precision} float;
	uniform vec3 uColor;
	out vec4 outgoingColor;

	void main(void){
		if(length(gl_PointCoord - 0.5) > 0.5) {
			discard;
		}
		outgoingColor = vec4(uColor, 1.0);
	}
	`}function N(){return`
	precision ${G.capabilities.precision} float;
	uniform vec3 uColor;

	void main(void){
		if(length(gl_PointCoord - 0.5) > 0.5) {
			discard;
		}
		gl_FragColor = vec4(uColor, 1.0);
	}
	`}var P=T(1),O=T.n(P),X=T(8),V=T(9),Y=T(0),G=T(3),H=T(4),W=T(5),Z=T(10),K=T(12),Q=T(11);let J;const $=`${W.a}
	${Z.a}

	in vec3 aVertexPosition;

	uniform mat4 uModelMatrix;
	uniform float uSize;

	void main(void){
		vec4 mvPosition = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
		gl_PointSize = uSize * (100.0 / length(mvPosition.xyz));
		gl_Position = mvPosition;
	}
`,ee=`
	attribute vec3 aVertexPosition;

	uniform mat4 uProjectionMatrix;
	uniform mat4 uViewMatrix;
	uniform mat4 uModelMatrix;
	uniform float uSize;

	void main(void){
		vec4 mvPosition = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
		gl_PointSize = uSize * (100.0 / length(mvPosition.xyz));
		gl_Position = mvPosition;
	}
`;class ae extends H.a{constructor(ne,se=0.5){let ue=[];const ce=ne.geometry.bufferVertices.length;for(let me=0;me<ce;me+=1)ue[me]=ne.geometry.bufferVertices[me];super(new Float32Array(ue))}}const ie=P.mat4.create(),re=P.mat4.create();class oe extends X.a{constructor(ne,se=1,ue=65280,ce='#ffffff'){const me=Y.webgl2?$:ee,xe=Y.webgl2?I():N();super(new ae(ne,se),new V.a({name:'VerticesHelper',vertexShader:me,fragmentShader:xe,uniforms:{uSize:{type:'f',value:se},uColor:{type:'3f',value:new K.a(ue).v}}})),this._labels=[],this._parentMesh=ne;let pe;const ge=(he)=>{pe=document.createElement('div'),pe.style.position='absolute',pe.style.pointerEvents='none',pe.style.color=ce,pe.style.fontSize='16px',this._labels.push({indice:he,element:pe}),document.body.appendChild(pe)};this._parentMesh.geometry.faces.forEach((he)=>{ge(he.indices[0]),ge(he.indices[1]),ge(he.indices[2])})}draw(ne,se){if(!this.visible)return;J=Y.get(),this.updateMatrix(),P.mat4.identity(ie),P.mat4.identity(re),P.mat4.mul(re,ne,this.modelMatrix),P.mat4.mul(ie,se,re);let ue,ce;this._labels.forEach((me)=>{ce=this._parentMesh.geometry.vertices[me.indice],ue=T.i(Q.from3DTo2D)(ce,ie),me.element.style.left=`${ue.x*window.innerWidth}px`,me.element.style.top=`${ue.y*window.innerHeight}px`,me.element.innerHTML=`${me.indice}`}),this.shader.program.bind(),this.shader.setUniforms(ne,se,this.modelMatrix),G.extensions.vertexArrayObject?this.vao.bind():(this.bindAttributes(),this.bindAttributesInstanced(),this.bindIndexBuffer()),J.drawArrays(J.POINTS,0,this.geometry.attributes.aVertexPosition.numItems),G.extensions.vertexArrayObject&&this.vao.unbind()}}F.a=oe},function(h,F,T){'use strict';var I=T(0),N=T(31),P=T(2),O=T(12);class X extends N.a{constructor(V={}){super(),this.uniforms={position:{type:'3f',value:new P.a(0,0,0).v},color:{type:'3f',value:new O.a(16777215).v},intensity:{type:'f',value:1}},Object.assign(this.uniforms,V),this.position=new P.a,I.webgl2&&(this.data=new Float32Array([...this.uniforms.position.value,0,...this.uniforms.color.value,0,this.uniforms.intensity.value,0,0,0]))}update(){I.webgl2?(this.setValues(this.position.v),this.setValues(this.uniforms.color.value,4),this.setValues([this.uniforms.intensity.value],8)):this.uniforms.position.value.set(this.position.v)}}F.a=X},function(h,F,T){'use strict';var I=T(0),N=T(17);let P;class O{constructor(X){if(this.lights=X,I.webgl2){const V=this.lights[0].data.length,Y=Array(X.length*V),G=new Float32Array(Y);this.uniformBuffer=new N.a(G),this._lightsData=new Float32Array(X[0].data.length*X.length)}}get length(){return this.lights.length}get(){return this.lights}update(){I.webgl2?(this.lights.forEach((X,V)=>{X.update(),this._lightsData.set(X.data,V*X.data.length)}),this.uniformBuffer.setValues(this._lightsData,0)):this.lights.forEach((X)=>{X.update()})}bind(){I.webgl2&&(P=I.get(),P.bindBufferBase(P.UNIFORM_BUFFER,1,this.uniformBuffer.buffer),P.bindBuffer(P.UNIFORM_BUFFER,this.uniformBuffer.buffer),P.bufferSubData(P.UNIFORM_BUFFER,0,this.uniformBuffer.data),P.bindBuffer(P.UNIFORM_BUFFER,null))}}F.a=O},function(h,F,T){'use strict';var I=T(0),N=T(31),P=T(2),O=T(12);class X extends N.a{constructor(V={}){super(),this.uniforms={position:{type:'3f',value:new P.a(0,0,0).v},color:{type:'3f',value:new O.a(16777215).v},specularColor:{type:'3f',value:new O.a(16777215).v},shininess:{type:'f',value:100},intensity:{type:'f',value:1}},Object.assign(this.uniforms,V),this.position=new P.a,I.webgl2&&(this.data=new Float32Array([...this.uniforms.position.value,0,...this.uniforms.color.value,0,...this.uniforms.specularColor.value,0,this.uniforms.shininess.value,0,0,0,this.uniforms.intensity.value,0,0,0]))}update(){I.webgl2?(this.setValues(this.position.v),this.setValues(this.uniforms.color.value,4),this.setValues(this.uniforms.specularColor.value,8),this.setValues([this.uniforms.shininess.value],12),this.setValues([this.uniforms.intensity.value],16)):this.uniforms.position.value.set(this.position.v)}}F.a=X},function(h,F,T){'use strict';var I=T(18);F.a=function(N){return new Promise((P,O)=>{T.i(I.a)(N).then((X)=>{const V=JSON.parse(X);P(V)}).catch(O)})}},function(h,F,T){'use strict';var I=T(18),N=T(30);F.a=function(P){return new Promise((O,X)=>{T.i(I.a)(P).then((V)=>{const Y=T.i(N.a)(V);O(Y)}).catch(X)})}},function(h,F,T){'use strict';var I=T(32),N=T(33),P=T(71),O=T(5),X=T(72),V=T(73),Y=T(74),G=T(34),H=T(75),W=T(76),Z=T(22),K=T(10),Q=T(77),J=T(78);F.a={Conditionals:I.a,DirectionalLights:N,EnvMapCube:P.a,EsVersion:O.a,Fog:X.a,Gamma:V.a,Matcap:Y.a,Math:G.a,Noise:H,Packing:W.a,PointLights:Z,ProjectionView:K.a,Tonemap:Q,Transpose:J.a}},function(h,F,T){'use strict';var I=T(91),N=T.n(I),P=T(80),O=T.n(P),X=T(14),V=T.n(X),Y=T(7),G=T(26),H=T(27),W=T(8),Z=T(9);class K{constructor($,ee,ae=50){this.origin=$,this.lookat=ee;let ie=[],re=[];$.forEach((oe)=>{ie=ie.concat(oe)}),ee.forEach((oe)=>{re=re.concat(oe)}),this.curves={origin:new O.a(ie),lookat:new O.a(re)}}get($=0){const ee=this.curves.origin.get($),ae=this.curves.lookat.get($);return{origin:ee,lookat:ae}}rebuild(){this.curves.origin.update(),this.curves.lookat.update()}destroy(){this.curves.origin=null,this.curves.lookat=null}}class Q{constructor($,ee,ae,ie=50,re=100,oe=!1,ne=!1,se=!1){this._rebuild=()=>{this.dolly.rebuild(),this.updateLine('origin',this.dolly.curves.origin.getLUT(this.steps)),this.updateLine('lookat',this.dolly.curves.lookat.getLUT(this.steps)),this.updatePoints('origin',this.dolly.curves.origin.points),this.updatePoints('lookat',this.dolly.curves.lookat.points),this.emit('rebuild')},V()(this),this.id=N()(),this.dolly=$,this.scene=ee,this.gui=ae.addFolder(`Dolly ${this.id}`),oe&&this.gui.open(),this.steps=ie,this.range=re,this.lines={origin:null,lookat:null},this.points={origin:[],lookat:[]},this.createPoints('origin',this.dolly.origin),this.createPoints('lookat',this.dolly.lookat),this.createLine('origin',this.dolly.curves.origin.getLUT(this.steps)),this.createLine('lookat',this.dolly.curves.lookat.getLUT(this.steps)),this.guiOrigin=this.gui.addFolder(`origin`),this.guiLookat=this.gui.addFolder(`lookat`),ne&&this.guiOrigin.open(),se&&this.guiLookat.open(),this.guiLookat.open(),this.dolly.curves.origin.points.forEach((ue,ce)=>{const me=this.guiOrigin.addFolder(`${ce}`);me.open(),me.add(ue,'x',-this.range,this.range).onChange(this._rebuild),me.add(ue,'y',-this.range,this.range).onChange(this._rebuild),me.add(ue,'z',-this.range,this.range).onChange(this._rebuild)}),this.dolly.curves.lookat.points.forEach((ue,ce)=>{const me=this.guiLookat.addFolder(`${ce}`);me.open(),me.add(ue,'x',-this.range,this.range).onChange(this._rebuild),me.add(ue,'y',-this.range,this.range).onChange(this._rebuild),me.add(ue,'z',-this.range,this.range).onChange(this._rebuild)})}flatten($){let ee=[];return $.forEach((ae)=>{ee=ee.concat([ae.x,ae.y,ae.z])}),ee}createPoints($,ee){ee.forEach((ae,ie)=>{this.points[$][ie]=new W.a(new H.a(0.2,4,5),new Z.a({drawType:Y.DRAW_LINES})),this.points[$][ie].position.set(ae.x,ae.y,ae.z),this.scene.add(this.points[$][ie])})}updatePoints($,ee){ee.forEach((ae,ie)=>{this.points[$][ie].position.set(ae.x,ae.y,ae.z)})}updateLine($,ee){const ae=this.lines[$].geometry.vertices.length/2;let ie=0,re,oe;for(let ne=0;ne<ae;ne+=1)ie=2*ne,ne<ae&&(re=ee[ne],oe=ee[ne+1],this.lines[$].geometry.vertices[ie].set(re.x,re.y,re.z),this.lines[$].geometry.vertices[ie+1].set(oe.x,oe.y,oe.z));this.lines[$].geometry.updateVertices()}createLine($,ee){const ae=new Float32Array(this.flatten(ee));this.lines[$]=new W.a(new G.a(ae),new Z.a({drawType:Y.DRAW_LINES})),this.scene.add(this.lines[$])}destroy(){Object.keys(this.lines).forEach(($)=>{this.scene.remove(this.lines[$],!0)}),Object.keys(this.points).forEach(($)=>{this.points[$].forEach((ee)=>{this.scene.remove(ee,!0)})}),this.scene=null}}F.a=class{constructor($){this.update=()=>{const{origin:ee,lookat:ae}=this.dollies[this.dolly].get(this.time);this.camera.position.set(ee.x,ee.y,ee.z),this.camera.lookAt(ae.x,ae.y,ae.z)},this.id=N()(),Object.assign(this,$),this.dollies=[],this.helpers=[],this.dolly='',this.time=0,this.gui&&(this.guiFolder=this.gui.addFolder(`Camera Dolly ${this.id}`),this.guiFolder.open(),this.guiFolder.add(this,'export'))}add($,ee){this.dollies[$]=new K(ee.origin,ee.lookat,this.curveSteps),this.set($),this.guiFolder&&(this.helpers[$]=new Q(this.dollies[$],this.scene,this.gui,this.curveSteps,this.guiSliderRange,this.guiOpen,this.guiOpenOrigin,this.guiOpenLookat),this.helpers[$].on('rebuild',this.update))}export(){const $=JSON.stringify({origin:this.dollies[this.dolly].curves.origin.points,lookat:this.dollies[this.dolly].curves.lookat.points},void 0,2);window.prompt('Copy to clipboard: Ctrl+C, Enter',$)}set($){this.dolly=$}destroy(){Object.keys(this.dollies).forEach(($)=>{this.dollies[$].destroy()}),Object.keys(this.helpers).forEach(($)=>{this.helpers[$].destroy()})}}},function(h,F){'use strict';let I,N;const P=window.performance||Date;F.a=class{constructor(X=!1){this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.isRunning=X}start(){this.startTime=P.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.isRunning=!0}stop(){this.getElapsedTime(),this.isRunning=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){return I=0,this.autoStart&&!this.isRunning&&this.start(),this.isRunning&&(N=P.now(),I=(N-this.oldTime)/1e3,this.oldTime=N,this.elapsedTime+=I),I}}},function(h,F,T){'use strict';var I=T(0),N=T(13);let P;F.a=class{constructor(){P=I.get(),this.program=P.createProgram(),this.created=!1,this.uniformBlocks={},this.attributeLocations={}}link(X,V,Y){if(this.compiledVertexShader=this.compile('vs',X),this.compiledFragmentShader=this.compile('fs',V),this.compiledVertexShader&&this.compiledFragmentShader){if(P.attachShader(this.program,this.compiledVertexShader),P.attachShader(this.program,this.compiledFragmentShader),Y instanceof Array&&P instanceof WebGL2RenderingContext&&P.transformFeedbackVaryings(this.program,Y,P.SEPARATE_ATTRIBS),P.linkProgram(this.program),P.validateProgram(this.program),!P.getProgramParameter(this.program,P.LINK_STATUS)){const G=P.getProgramInfoLog(this.program);T.i(N.a)('Failed to initialise shaders',G)}this.created=!0}}compile(X,V){P=I.get();let Y;return Y='vs'===X?P.createShader(P.VERTEX_SHADER):P.createShader(P.FRAGMENT_SHADER),P.shaderSource(Y,V),P.compileShader(Y),P.getShaderParameter(Y,P.COMPILE_STATUS)?Y:(T.i(N.a)('Failed to compile shader:',P.getShaderInfoLog(Y)),!1)}setAttributeLocation(X){P=I.get(),this.attributeLocations[X]=P.getAttribLocation(this.program,X),P.enableVertexAttribArray(this.attributeLocations[X])}setAttributePointer(X,V){P=I.get(),P.vertexAttribPointer(this.attributeLocations[X],V,P.FLOAT,!1,0,0)}setAttributeInstancedPointer(X,V){P=I.get(),P.vertexAttribPointer(this.attributeLocations[X],V,P.FLOAT,!1,0,0)}setUniformLocation(X,V){P=I.get(),X[V].location=P.getUniformLocation(this.program,V)}setUniformBlockLocation(X,V,Y){P=I.get(),P instanceof WebGL2RenderingContext&&(this.uniformBlocks[X]=P.getUniformBlockIndex(this.program,X),P.uniformBlockBinding(this.program,this.uniformBlocks[X],this.uniformBlocks[X]),P.bindBufferBase(P.UNIFORM_BUFFER,Y,V))}bind(){P=I.get(),P.useProgram(this.program)}dispose(){P=I.get();let X;Object.keys(this.attributeLocations).forEach((V)=>{X=this.attributeLocations[V],P.disableVertexAttribArray(X)}),P.detachShader(this.program,this.compiledVertexShader),P.detachShader(this.program,this.compiledFragmentShader),P.deleteProgram(this.program)}}},function(h,F,T){'use strict';var I=T(1),N=T.n(I),P=T(2);let O=I.vec3.create(),X=I.vec3.create();F.a=class{constructor(Y,G,H,W,Z,K){this.indices=[Y,G,H],this.vertices=[W,Z,K],this.uvs=[Y,G,H],this.normal=new P.a,this.updateFaceNormal()}updateFaceNormal(){I.vec3.set(O,0,0,0),I.vec3.set(X,0,0,0),I.vec3.subtract(O,this.vertices[2].v,this.vertices[1].v),I.vec3.subtract(X,this.vertices[0].v,this.vertices[1].v),I.vec3.cross(O,O,X),I.vec3.normalize(O,O),this.normal.set(O[0],O[1],O[2])}}},function(h,F,T){'use strict';Object.defineProperty(F,'__esModule',{value:!0});var I=T(3),N=T(7),P=T(0),O=T(8),X=T(23),V=T(41),Y=T(42),G=T(43),H=T(45),W=T(44),Z=T(46),K=T(9),Q=T(47),J=T(48),$=T(49),ee=T(50),ae=T(17),ie=T(15),re=T(24),oe=T(51),ne=T(25),se=T(4),ue=T(26),ce=T(52),me=T(27),xe=T(53),pe=T(54),ge=T(55),he=T(56),ve=T(57),Ee=T(59),_e=T(58),ye=T(60),Fe=T(12),Te=T(2),Re=T(16),Ae=T(28),Ie=T(11),we=T(63),Se=T(64),Le=T(65),ze=T(29),Me=T(30),Ne=T(40),Pe=T(18),Ue=T(19),De=T(20),Oe=T(61),Be=T(62);T.d(F,'Capabilities',function(){return I}),T.d(F,'Constants',function(){return N}),T.d(F,'GL',function(){return P}),T.d(F,'Mesh',function(){return O.a}),T.d(F,'Object3D',function(){return X.a}),T.d(F,'OrthographicCamera',function(){return V.a}),T.d(F,'PerspectiveCamera',function(){return Y.a}),T.d(F,'RayCaster',function(){return G.a}),T.d(F,'Renderer',function(){return H.a}),T.d(F,'RenderTarget',function(){return W.a}),T.d(F,'Scene',function(){return Z.a}),T.d(F,'Shader',function(){return K.a}),T.d(F,'Texture',function(){return Q.a}),T.d(F,'Texture3d',function(){return J.a}),T.d(F,'TextureCube',function(){return $.a}),T.d(F,'TextureVideo',function(){return ee.a}),T.d(F,'UniformBuffer',function(){return ae.a}),T.d(F,'UniformBuffers',function(){return ie}),T.d(F,'Vao',function(){return re.a}),T.d(F,'Clock',function(){return Le.a}),T.d(F,'CameraDolly',function(){return Se.a}),T.d(F,'Detect',function(){return ze.a}),T.d(F,'ObjParser',function(){return Me.a}),T.d(F,'BoxGeometry',function(){return oe.a}),T.d(F,'LineGeometry',function(){return ue.a}),T.d(F,'BufferAttribute',function(){return ne.a}),T.d(F,'Geometry',function(){return se.a}),T.d(F,'PlaneGeometry',function(){return ce.a}),T.d(F,'SphereGeometry',function(){return me.a}),T.d(F,'AxisHelper',function(){return xe.a}),T.d(F,'CameraHelper',function(){return pe.a}),T.d(F,'GridHelper',function(){return ge.a}),T.d(F,'NormalsHelper',function(){return he.a}),T.d(F,'VerticesHelper',function(){return ve.a}),T.d(F,'Lights',function(){return Ee.a}),T.d(F,'DirectionalLight',function(){return _e.a}),T.d(F,'PointLight',function(){return ye.a}),T.d(F,'Color',function(){return Fe.a}),T.d(F,'Vector3',function(){return Te.a}),T.d(F,'Vector2',function(){return Re.a}),T.d(F,'Ray',function(){return Ae.a}),T.d(F,'MathUtils',function(){return Ie}),T.d(F,'ShaderChunks',function(){return we.a}),T.d(F,'OrbitControls',function(){return Ne.a}),T.d(F,'FileLoader',function(){return Pe.a}),T.d(F,'HdrLoader',function(){return Ue.a}),T.d(F,'ImageLoader',function(){return De.a}),T.d(F,'JsonLoader',function(){return Oe.a}),T.d(F,'ObjLoader',function(){return Be.a})},function(h,F,T){'use strict';var I=T(5),N=T(22),P=T(33),O=T(32);T.d(F,'a',function(){return X}),T.d(F,'b',function(){return V});const X=`${I.a}
	#HOOK_PRECISION
	#HOOK_DEFINES

	layout(std140) uniform;

	in vec3 vDiffuse;
	in vec3 vPosition;

	#ifdef normals
	in vec3 vNormal;
	#endif

	#ifdef uv
	in vec2 vUv;
	#endif

	#ifdef directionalLights
	${P.directionalLightsEs300}
	#endif

	// Lighting
	#ifdef pointLights
	${N.pointLightsInEs300}
	#endif

	out vec4 outgoingColor;

	${O.b}

	#HOOK_FRAGMENT_PRE

	void main(void){

		vec3 color = vDiffuse;

		#ifdef normals
		vec3 normal = normalize(vNormal);
		#endif

		#HOOK_FRAGMENT_MAIN

		#ifdef directionalLights
		for (int i = 0; i < #HOOK_DIRECTIONAL_LIGHTS; i++) {
			float directionalLight = dot(normal, normalize(uDirectionalLights[i].position.xyz));
			vec3 directionalColor = uDirectionalLights[i].color.rgb * directionalLight;
			color += whenGreaterThan(directionalLight, 0.0) * (directionalColor * uDirectionalLights[i].intensity.x);
		}
		#endif

		#ifdef pointLights
		for (int i = 0; i < #HOOK_POINT_LIGHTS; i++) {
			vec3 pointLightSurfaceToLightDirection = normalize(vPointLightSurfaceToLightDirection[i]);
			vec3 pointLightSurfaceToCameraDirection = normalize(vPointLightSurfaceToCameraDirection[i]);
			vec3 halfVector = normalize(pointLightSurfaceToLightDirection + pointLightSurfaceToCameraDirection);

			float pointLight = max(dot(normal, pointLightSurfaceToLightDirection), 0.0);
			vec3 pointLightColor = uPointLights[i].color.rgb * pointLight;
			color += pointLight * pointLightColor;
			float specular = max(pow(dot(normal, halfVector), uPointLights[i].shininess.x), 0.0);
			color += specular * uPointLights[i].specularColor.rgb;
		}
		#endif

		outgoingColor = vec4(color.rgb, 1.0);

		#HOOK_FRAGMENT_END
	}
`,V=`
	#HOOK_PRECISION
	#HOOK_DEFINES

	varying vec3 vDiffuse;
	varying vec3 vPosition;

	#ifdef normals
	varying vec3 vNormal;
	#endif

	#ifdef uv
	varying vec2 vUv;
	#endif

	#ifdef directionalLights
	${P.directionalLightsEs100}
	#endif

	// Lighting
	#ifdef pointLights
	${N.pointLightsEs100}
	#endif

	${O.b}

	#HOOK_FRAGMENT_PRE

	void main(void){

		vec3 color = vDiffuse;

		#ifdef normals
		vec3 normal = normalize(vNormal);
		#endif

		#HOOK_FRAGMENT_MAIN

		#ifdef directionalLights
		for (int i = 0; i < #HOOK_DIRECTIONAL_LIGHTS; i++) {
			float directionalLight = dot(normal, normalize(uDirectionalLights[i].position));
			vec3 directionalColor = uDirectionalLights[i].color * directionalLight;
			color += whenGreaterThan(directionalLight, 0.0) * (directionalColor * uDirectionalLights[i].intensity);
		}
		#endif

		#ifdef pointLights
		for (int i = 0; i < #HOOK_POINT_LIGHTS; i++) {
			vec3 pointLightSurfaceToLightDirection = normalize(vPointLightSurfaceToLightDirection[i]);
			vec3 pointLightSurfaceToCameraDirection = normalize(vPointLightSurfaceToCameraDirection[i]);
			vec3 halfVector = normalize(pointLightSurfaceToLightDirection + pointLightSurfaceToCameraDirection);

			float pointLight = max(dot(normal, pointLightSurfaceToLightDirection), 0.0);
			vec3 pointLightColor = uPointLights[i].color * pointLight;
			color += pointLight * pointLightColor;
			float specular = max(pow(dot(normal, halfVector), uPointLights[i].shininess), 0.0);
			color += specular * uPointLights[i].specularColor;
		}
		#endif

		gl_FragColor = vec4(color.rgb, 1.0);

		#HOOK_FRAGMENT_END
	}
`},function(h,F,T){'use strict';var I=T(5),N=T(22),P=T(34),O=T(10);T.d(F,'a',function(){return X}),T.d(F,'b',function(){return V});const X=`${I.a}
	${P.b}
	${P.c}
	#HOOK_DEFINES

	layout(std140) uniform;

	${O.a}

	uniform mat4 uProjectionMatrix;
	uniform mat4 uViewMatrix;
	uniform mat4 uViewMatrixInverse;
	uniform mat4 uModelMatrix;
	uniform mat4 uModelMatrixInverse;
	uniform mat3 uNormalMatrix;

	in vec3 aVertexPosition;
	out vec3 vPosition;
	out vec4 vWorldPosition;

	// Camera
	uniform vec3 uCameraPosition;

	#ifdef vertexColors
	in vec3 aVertexColor;
	#endif

	// Color
	uniform vec3 uDiffuse;
	out vec3 vDiffuse;

	// Normal
	#ifdef normals
	in vec3 aVertexNormal;
	out vec3 vNormal;
	#endif

	// Uv
	#ifdef uv
	in vec2 aUv;
	out vec2 vUv;
	#endif

	// Lighting
	#ifdef pointLights
	${N.pointLightsOutEs300}
	#endif

	#HOOK_VERTEX_PRE

	void main(void){

		vDiffuse = uDiffuse;

		// Override for custom positioning
		vec3 transformed = vec3(0.0);

		#ifdef vertexColors
		vDiffuse = aVertexColor;
		#endif

		#ifdef uv
		vUv = aUv;
		#endif

		#HOOK_VERTEX_MAIN

		#ifdef normals
		vNormal = uNormalMatrix * aVertexNormal;
		#endif

		// Vertex position + offset
		vPosition = aVertexPosition + transformed;

		// Calculate world position of vertex with transformed
		vWorldPosition = uModelMatrix * vec4(aVertexPosition + transformed, 1.0);

		#ifdef pointLights
		for (int i = 0; i < #HOOK_POINT_LIGHTS; i++) {
			// Calculate directional vector of surface to the light
			vPointLightSurfaceToLightDirection[i] = uPointLights[i].position.xyz - vWorldPosition.xyz;
			// Calculate directional vector of camera to the surface
			vPointLightSurfaceToCameraDirection[i] = uCameraPosition - vWorldPosition.xyz;
		}
		#endif

		gl_Position = uProjectionView.projectionMatrix * uProjectionView.viewMatrix * uModelMatrix * vec4(vPosition, 1.0);

		#HOOK_VERTEX_END
	}
`,V=`

	${P.b}
	${P.c}
	#HOOK_DEFINES

	// Position
	uniform mat4 uProjectionMatrix;
	uniform mat4 uViewMatrix;
	uniform mat4 uViewMatrixInverse;
	uniform mat4 uModelMatrix;
	uniform mat4 uModelMatrixInverse;
	uniform mat3 uNormalMatrix;
	attribute vec3 aVertexPosition;
	varying vec3 vPosition;
	varying vec4 vWorldPosition;

	// Camera
	uniform vec3 uCameraPosition;

	#ifdef vertexColors
	attribute vec3 aVertexColor;
	#endif

	// Color
	uniform vec3 uDiffuse;
	varying vec3 vDiffuse;

	// Normal
	#ifdef normals
	attribute vec3 aVertexNormal;
	varying vec3 vNormal;
	#endif

	// Uv
	#ifdef uv
	attribute vec2 aUv;
	varying vec2 vUv;
	#endif

	// Lighting
	#ifdef pointLights
	${N.pointLightsEs100}
	#endif

	#HOOK_VERTEX_PRE

	void main(void){

		vDiffuse = uDiffuse;

		// Override for custom positioning
		vec3 transformed = vec3(0.0);

		#ifdef vertexColors
		vDiffuse = aVertexColor;
		#endif

		#ifdef uv
		vUv = aUv;
		#endif

		#HOOK_VERTEX_MAIN

		#ifdef normals
		vNormal = uNormalMatrix * aVertexNormal;
		#endif

		// Vertex position + offset
		vPosition = aVertexPosition + transformed;

		// Calculate world position of vertex with transformed
		vWorldPosition = uModelMatrix * vec4(aVertexPosition + transformed, 1.0);

		#ifdef pointLights
		for (int i = 0; i < #HOOK_POINT_LIGHTS; i++) {
			// Calculate word position of vertex
			vec3 surfaceWorldPosition = (uModelMatrix * vec4(aVertexPosition, 1.0)).xyz;
			// Calculate directional vector of surface to the light
			vPointLightSurfaceToLightDirection[i] = uPointLights[i].position - vPosition;
			// Calculate directional vector of camera to the surface
			vPointLightSurfaceToCameraDirection[i] = uCameraPosition - vPosition;
		}
		#endif

		gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(vPosition, 1.0);

		#HOOK_VERTEX_END
	}
`},function(h,F){'use strict';F.a=`
/**
 * Samples cubemap environment map
 * @param  {vec3} wcNormal - normal in the world coordinate space
 * @param  {float} - flipEnvMap    -1.0 for left handed coorinate system oriented texture (usual case)
 *                                  1.0 for right handed coorinate system oriented texture
 * @return {vec4} - cubemap texture coordinate
 */
vec3 envMapCube(vec3 wcNormal, float flipEnvMap) {
	return vec3(flipEnvMap * wcNormal.x, wcNormal.y, wcNormal.z);
}

vec3 envMapCube(vec3 wcNormal) {
 //-1.0 for left handed coorinate system oriented texture (usual case)
 return envMapCube(wcNormal, -1.0);
}
`},function(h,F){'use strict';const I=`
float fogLinear(const float dist, const float start, const float end) {
  return 1.0 - clamp((end - dist) / (end - start), 0.0, 1.0);
}
`,N=`
float fogExp(
  const float dist,
  const float density
) {
  return 1.0 - clamp(exp(-density * dist), 0.0, 1.0);
}
`,P=`
float fogExp2(
  const float dist,
  const float density
) {
  const float LOG2 = -1.442695;
  float d = density * dist;
  return 1.0 - clamp(exp2(d * d * LOG2), 0.0, 1.0);
}
`;F.a={linear:I,exp:N,exp2:P}},function(h,F){'use strict';F.a=`
	const float gamma = 2.2;

	float toGamma(float v) {
	  return pow(v, 1.0 / gamma);
	}

	vec2 toGamma(vec2 v) {
	  return pow(v, vec2(1.0 / gamma));
	}

	vec3 toGamma(vec3 v) {
	  return pow(v, vec3(1.0 / gamma));
	}

	vec4 toGamma(vec4 v) {
	  return vec4(toGamma(v.rgb), v.a);
	}
`},function(h,F){'use strict';F.a=`
vec2 matcap(vec3 eye, vec3 normal) {
  vec3 reflected = reflect(eye, normal);
  float m = 2.8284271247461903 * sqrt( reflected.z+1.0 );
  return reflected.xy / m + 0.5;
}
`},function(h,F){'use strict';Object.defineProperty(F,'__esModule',{value:!0});const I=`
//
// GLSL textureless classic 2D noise "cnoise",
// with an RSL-style periodic variant "pnoise".
// Author:  Stefan Gustavson (stefan.gustavson@liu.se)
// Version: 2011-08-22
//
// Many thanks to Ian McEwan of Ashima Arts for the
// ideas for permutation and gradient selection.
//
// Copyright (c) 2011 Stefan Gustavson. All rights reserved.
// Distributed under the MIT license. See LICENSE file.
// https://github.com/ashima/webgl-noise
//

vec4 mod289(vec4 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 permute(vec4 x)
{
  return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

vec2 fade(vec2 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

// Classic Perlin noise
float classicNoise2D(vec2 P)
{
  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);
  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);
  Pi = mod289(Pi); // To avoid truncation effects in permutation
  vec4 ix = Pi.xzxz;
  vec4 iy = Pi.yyww;
  vec4 fx = Pf.xzxz;
  vec4 fy = Pf.yyww;

  vec4 i = permute(permute(ix) + iy);

  vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;
  vec4 gy = abs(gx) - 0.5 ;
  vec4 tx = floor(gx + 0.5);
  gx = gx - tx;

  vec2 g00 = vec2(gx.x,gy.x);
  vec2 g10 = vec2(gx.y,gy.y);
  vec2 g01 = vec2(gx.z,gy.z);
  vec2 g11 = vec2(gx.w,gy.w);

  vec4 norm = taylorInvSqrt(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));
  g00 *= norm.x;
  g01 *= norm.y;
  g10 *= norm.z;
  g11 *= norm.w;

  float n00 = dot(g00, vec2(fx.x, fy.x));
  float n10 = dot(g10, vec2(fx.y, fy.y));
  float n01 = dot(g01, vec2(fx.z, fy.z));
  float n11 = dot(g11, vec2(fx.w, fy.w));

  vec2 fade_xy = fade(Pf.xy);
  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);
  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);
  return 2.3 * n_xy;
}
`;F.classicNoise2D=I;const N=`
//
// GLSL textureless classic 3D noise "cnoise",
// with an RSL-style periodic variant "pnoise".
// Author:  Stefan Gustavson (stefan.gustavson@liu.se)
// Version: 2011-10-11
//
// Many thanks to Ian McEwan of Ashima Arts for the
// ideas for permutation and gradient selection.
//
// Copyright (c) 2011 Stefan Gustavson. All rights reserved.
// Distributed under the MIT license. See LICENSE file.
// https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 mod289(vec4 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 permute(vec4 x)
{
  return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

// Classic Perlin noise
float classicNoise3D(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
  return 2.2 * n_xyz;
}
`;F.classicNoise3D=N;const P=`
//
// GLSL textureless classic 4D noise "cnoise",
// with an RSL-style periodic variant "pnoise".
// Author:  Stefan Gustavson (stefan.gustavson@liu.se)
// Version: 2011-08-22
//
// Many thanks to Ian McEwan of Ashima Arts for the
// ideas for permutation and gradient selection.
//
// Copyright (c) 2011 Stefan Gustavson. All rights reserved.
// Distributed under the MIT license. See LICENSE file.
// https://github.com/ashima/webgl-noise
//

vec4 mod289(vec4 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 permute(vec4 x)
{
  return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

vec4 fade(vec4 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

// Classic Perlin noise
float classicNoise4D(vec4 P)
{
  vec4 Pi0 = floor(P); // Integer part for indexing
  vec4 Pi1 = Pi0 + 1.0; // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec4 Pf0 = fract(P); // Fractional part for interpolation
  vec4 Pf1 = Pf0 - 1.0; // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = vec4(Pi0.zzzz);
  vec4 iz1 = vec4(Pi1.zzzz);
  vec4 iw0 = vec4(Pi0.wwww);
  vec4 iw1 = vec4(Pi1.wwww);

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);
  vec4 ixy00 = permute(ixy0 + iw0);
  vec4 ixy01 = permute(ixy0 + iw1);
  vec4 ixy10 = permute(ixy1 + iw0);
  vec4 ixy11 = permute(ixy1 + iw1);

  vec4 gx00 = ixy00 * (1.0 / 7.0);
  vec4 gy00 = floor(gx00) * (1.0 / 7.0);
  vec4 gz00 = floor(gy00) * (1.0 / 6.0);
  gx00 = fract(gx00) - 0.5;
  gy00 = fract(gy00) - 0.5;
  gz00 = fract(gz00) - 0.5;
  vec4 gw00 = vec4(0.75) - abs(gx00) - abs(gy00) - abs(gz00);
  vec4 sw00 = step(gw00, vec4(0.0));
  gx00 -= sw00 * (step(0.0, gx00) - 0.5);
  gy00 -= sw00 * (step(0.0, gy00) - 0.5);

  vec4 gx01 = ixy01 * (1.0 / 7.0);
  vec4 gy01 = floor(gx01) * (1.0 / 7.0);
  vec4 gz01 = floor(gy01) * (1.0 / 6.0);
  gx01 = fract(gx01) - 0.5;
  gy01 = fract(gy01) - 0.5;
  gz01 = fract(gz01) - 0.5;
  vec4 gw01 = vec4(0.75) - abs(gx01) - abs(gy01) - abs(gz01);
  vec4 sw01 = step(gw01, vec4(0.0));
  gx01 -= sw01 * (step(0.0, gx01) - 0.5);
  gy01 -= sw01 * (step(0.0, gy01) - 0.5);

  vec4 gx10 = ixy10 * (1.0 / 7.0);
  vec4 gy10 = floor(gx10) * (1.0 / 7.0);
  vec4 gz10 = floor(gy10) * (1.0 / 6.0);
  gx10 = fract(gx10) - 0.5;
  gy10 = fract(gy10) - 0.5;
  gz10 = fract(gz10) - 0.5;
  vec4 gw10 = vec4(0.75) - abs(gx10) - abs(gy10) - abs(gz10);
  vec4 sw10 = step(gw10, vec4(0.0));
  gx10 -= sw10 * (step(0.0, gx10) - 0.5);
  gy10 -= sw10 * (step(0.0, gy10) - 0.5);

  vec4 gx11 = ixy11 * (1.0 / 7.0);
  vec4 gy11 = floor(gx11) * (1.0 / 7.0);
  vec4 gz11 = floor(gy11) * (1.0 / 6.0);
  gx11 = fract(gx11) - 0.5;
  gy11 = fract(gy11) - 0.5;
  gz11 = fract(gz11) - 0.5;
  vec4 gw11 = vec4(0.75) - abs(gx11) - abs(gy11) - abs(gz11);
  vec4 sw11 = step(gw11, vec4(0.0));
  gx11 -= sw11 * (step(0.0, gx11) - 0.5);
  gy11 -= sw11 * (step(0.0, gy11) - 0.5);

  vec4 g0000 = vec4(gx00.x,gy00.x,gz00.x,gw00.x);
  vec4 g1000 = vec4(gx00.y,gy00.y,gz00.y,gw00.y);
  vec4 g0100 = vec4(gx00.z,gy00.z,gz00.z,gw00.z);
  vec4 g1100 = vec4(gx00.w,gy00.w,gz00.w,gw00.w);
  vec4 g0010 = vec4(gx10.x,gy10.x,gz10.x,gw10.x);
  vec4 g1010 = vec4(gx10.y,gy10.y,gz10.y,gw10.y);
  vec4 g0110 = vec4(gx10.z,gy10.z,gz10.z,gw10.z);
  vec4 g1110 = vec4(gx10.w,gy10.w,gz10.w,gw10.w);
  vec4 g0001 = vec4(gx01.x,gy01.x,gz01.x,gw01.x);
  vec4 g1001 = vec4(gx01.y,gy01.y,gz01.y,gw01.y);
  vec4 g0101 = vec4(gx01.z,gy01.z,gz01.z,gw01.z);
  vec4 g1101 = vec4(gx01.w,gy01.w,gz01.w,gw01.w);
  vec4 g0011 = vec4(gx11.x,gy11.x,gz11.x,gw11.x);
  vec4 g1011 = vec4(gx11.y,gy11.y,gz11.y,gw11.y);
  vec4 g0111 = vec4(gx11.z,gy11.z,gz11.z,gw11.z);
  vec4 g1111 = vec4(gx11.w,gy11.w,gz11.w,gw11.w);

  vec4 norm00 = taylorInvSqrt(vec4(dot(g0000, g0000), dot(g0100, g0100), dot(g1000, g1000), dot(g1100, g1100)));
  g0000 *= norm00.x;
  g0100 *= norm00.y;
  g1000 *= norm00.z;
  g1100 *= norm00.w;

  vec4 norm01 = taylorInvSqrt(vec4(dot(g0001, g0001), dot(g0101, g0101), dot(g1001, g1001), dot(g1101, g1101)));
  g0001 *= norm01.x;
  g0101 *= norm01.y;
  g1001 *= norm01.z;
  g1101 *= norm01.w;

  vec4 norm10 = taylorInvSqrt(vec4(dot(g0010, g0010), dot(g0110, g0110), dot(g1010, g1010), dot(g1110, g1110)));
  g0010 *= norm10.x;
  g0110 *= norm10.y;
  g1010 *= norm10.z;
  g1110 *= norm10.w;

  vec4 norm11 = taylorInvSqrt(vec4(dot(g0011, g0011), dot(g0111, g0111), dot(g1011, g1011), dot(g1111, g1111)));
  g0011 *= norm11.x;
  g0111 *= norm11.y;
  g1011 *= norm11.z;
  g1111 *= norm11.w;

  float n0000 = dot(g0000, Pf0);
  float n1000 = dot(g1000, vec4(Pf1.x, Pf0.yzw));
  float n0100 = dot(g0100, vec4(Pf0.x, Pf1.y, Pf0.zw));
  float n1100 = dot(g1100, vec4(Pf1.xy, Pf0.zw));
  float n0010 = dot(g0010, vec4(Pf0.xy, Pf1.z, Pf0.w));
  float n1010 = dot(g1010, vec4(Pf1.x, Pf0.y, Pf1.z, Pf0.w));
  float n0110 = dot(g0110, vec4(Pf0.x, Pf1.yz, Pf0.w));
  float n1110 = dot(g1110, vec4(Pf1.xyz, Pf0.w));
  float n0001 = dot(g0001, vec4(Pf0.xyz, Pf1.w));
  float n1001 = dot(g1001, vec4(Pf1.x, Pf0.yz, Pf1.w));
  float n0101 = dot(g0101, vec4(Pf0.x, Pf1.y, Pf0.z, Pf1.w));
  float n1101 = dot(g1101, vec4(Pf1.xy, Pf0.z, Pf1.w));
  float n0011 = dot(g0011, vec4(Pf0.xy, Pf1.zw));
  float n1011 = dot(g1011, vec4(Pf1.x, Pf0.y, Pf1.zw));
  float n0111 = dot(g0111, vec4(Pf0.x, Pf1.yzw));
  float n1111 = dot(g1111, Pf1);

  vec4 fade_xyzw = fade(Pf0);
  vec4 n_0w = mix(vec4(n0000, n1000, n0100, n1100), vec4(n0001, n1001, n0101, n1101), fade_xyzw.w);
  vec4 n_1w = mix(vec4(n0010, n1010, n0110, n1110), vec4(n0011, n1011, n0111, n1111), fade_xyzw.w);
  vec4 n_zw = mix(n_0w, n_1w, fade_xyzw.z);
  vec2 n_yzw = mix(n_zw.xy, n_zw.zw, fade_xyzw.y);
  float n_xyzw = mix(n_yzw.x, n_yzw.y, fade_xyzw.x);
  return 2.2 * n_xyzw;
}
`;F.classicNoise4D=P;const O=`
//
// GLSL textureless classic 2D noise "cnoise",
// with an RSL-style periodic variant "pnoise".
// Author:  Stefan Gustavson (stefan.gustavson@liu.se)
// Version: 2011-08-22
//
// Many thanks to Ian McEwan of Ashima Arts for the
// ideas for permutation and gradient selection.
//
// Copyright (c) 2011 Stefan Gustavson. All rights reserved.
// Distributed under the MIT license. See LICENSE file.
// https://github.com/ashima/webgl-noise
//

vec4 mod289(vec4 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 permute(vec4 x)
{
  return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

vec2 fade(vec2 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

// Classic Perlin noise, periodic variant
float periodicNoise2D(vec2 P, vec2 rep)
{
  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);
  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);
  Pi = mod(Pi, rep.xyxy); // To create noise with explicit period
  Pi = mod289(Pi);        // To avoid truncation effects in permutation
  vec4 ix = Pi.xzxz;
  vec4 iy = Pi.yyww;
  vec4 fx = Pf.xzxz;
  vec4 fy = Pf.yyww;

  vec4 i = permute(permute(ix) + iy);

  vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;
  vec4 gy = abs(gx) - 0.5 ;
  vec4 tx = floor(gx + 0.5);
  gx = gx - tx;

  vec2 g00 = vec2(gx.x,gy.x);
  vec2 g10 = vec2(gx.y,gy.y);
  vec2 g01 = vec2(gx.z,gy.z);
  vec2 g11 = vec2(gx.w,gy.w);

  vec4 norm = taylorInvSqrt(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));
  g00 *= norm.x;
  g01 *= norm.y;
  g10 *= norm.z;
  g11 *= norm.w;

  float n00 = dot(g00, vec2(fx.x, fy.x));
  float n10 = dot(g10, vec2(fx.y, fy.y));
  float n01 = dot(g01, vec2(fx.z, fy.z));
  float n11 = dot(g11, vec2(fx.w, fy.w));

  vec2 fade_xy = fade(Pf.xy);
  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);
  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);
  return 2.3 * n_xy;
}
`;F.periodicNoise2D=O;const X=`
//
// GLSL textureless classic 3D noise "cnoise",
// with an RSL-style periodic variant "pnoise".
// Author:  Stefan Gustavson (stefan.gustavson@liu.se)
// Version: 2011-10-11
//
// Many thanks to Ian McEwan of Ashima Arts for the
// ideas for permutation and gradient selection.
//
// Copyright (c) 2011 Stefan Gustavson. All rights reserved.
// Distributed under the MIT license. See LICENSE file.
// https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 mod289(vec4 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 permute(vec4 x)
{
  return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

// Classic Perlin noise, periodic variant
float periodicNoise3D(vec3 P, vec3 rep)
{
  vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
  vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
  return 2.2 * n_xyz;
}
`;F.periodicNoise3D=X;const V=`
//
// GLSL textureless classic 4D noise "cnoise",
// with an RSL-style periodic variant "pnoise".
// Author:  Stefan Gustavson (stefan.gustavson@liu.se)
// Version: 2011-08-22
//
// Many thanks to Ian McEwan of Ashima Arts for the
// ideas for permutation and gradient selection.
//
// Copyright (c) 2011 Stefan Gustavson. All rights reserved.
// Distributed under the MIT license. See LICENSE file.
// https://github.com/ashima/webgl-noise
//

vec4 mod289(vec4 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 permute(vec4 x)
{
  return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

vec4 fade(vec4 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

// Classic Perlin noise, periodic version
float periodicNoise4D(vec4 P, vec4 rep)
{
  vec4 Pi0 = mod(floor(P), rep); // Integer part modulo rep
  vec4 Pi1 = mod(Pi0 + 1.0, rep); // Integer part + 1 mod rep
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec4 Pf0 = fract(P); // Fractional part for interpolation
  vec4 Pf1 = Pf0 - 1.0; // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = vec4(Pi0.zzzz);
  vec4 iz1 = vec4(Pi1.zzzz);
  vec4 iw0 = vec4(Pi0.wwww);
  vec4 iw1 = vec4(Pi1.wwww);

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);
  vec4 ixy00 = permute(ixy0 + iw0);
  vec4 ixy01 = permute(ixy0 + iw1);
  vec4 ixy10 = permute(ixy1 + iw0);
  vec4 ixy11 = permute(ixy1 + iw1);

  vec4 gx00 = ixy00 * (1.0 / 7.0);
  vec4 gy00 = floor(gx00) * (1.0 / 7.0);
  vec4 gz00 = floor(gy00) * (1.0 / 6.0);
  gx00 = fract(gx00) - 0.5;
  gy00 = fract(gy00) - 0.5;
  gz00 = fract(gz00) - 0.5;
  vec4 gw00 = vec4(0.75) - abs(gx00) - abs(gy00) - abs(gz00);
  vec4 sw00 = step(gw00, vec4(0.0));
  gx00 -= sw00 * (step(0.0, gx00) - 0.5);
  gy00 -= sw00 * (step(0.0, gy00) - 0.5);

  vec4 gx01 = ixy01 * (1.0 / 7.0);
  vec4 gy01 = floor(gx01) * (1.0 / 7.0);
  vec4 gz01 = floor(gy01) * (1.0 / 6.0);
  gx01 = fract(gx01) - 0.5;
  gy01 = fract(gy01) - 0.5;
  gz01 = fract(gz01) - 0.5;
  vec4 gw01 = vec4(0.75) - abs(gx01) - abs(gy01) - abs(gz01);
  vec4 sw01 = step(gw01, vec4(0.0));
  gx01 -= sw01 * (step(0.0, gx01) - 0.5);
  gy01 -= sw01 * (step(0.0, gy01) - 0.5);

  vec4 gx10 = ixy10 * (1.0 / 7.0);
  vec4 gy10 = floor(gx10) * (1.0 / 7.0);
  vec4 gz10 = floor(gy10) * (1.0 / 6.0);
  gx10 = fract(gx10) - 0.5;
  gy10 = fract(gy10) - 0.5;
  gz10 = fract(gz10) - 0.5;
  vec4 gw10 = vec4(0.75) - abs(gx10) - abs(gy10) - abs(gz10);
  vec4 sw10 = step(gw10, vec4(0.0));
  gx10 -= sw10 * (step(0.0, gx10) - 0.5);
  gy10 -= sw10 * (step(0.0, gy10) - 0.5);

  vec4 gx11 = ixy11 * (1.0 / 7.0);
  vec4 gy11 = floor(gx11) * (1.0 / 7.0);
  vec4 gz11 = floor(gy11) * (1.0 / 6.0);
  gx11 = fract(gx11) - 0.5;
  gy11 = fract(gy11) - 0.5;
  gz11 = fract(gz11) - 0.5;
  vec4 gw11 = vec4(0.75) - abs(gx11) - abs(gy11) - abs(gz11);
  vec4 sw11 = step(gw11, vec4(0.0));
  gx11 -= sw11 * (step(0.0, gx11) - 0.5);
  gy11 -= sw11 * (step(0.0, gy11) - 0.5);

  vec4 g0000 = vec4(gx00.x,gy00.x,gz00.x,gw00.x);
  vec4 g1000 = vec4(gx00.y,gy00.y,gz00.y,gw00.y);
  vec4 g0100 = vec4(gx00.z,gy00.z,gz00.z,gw00.z);
  vec4 g1100 = vec4(gx00.w,gy00.w,gz00.w,gw00.w);
  vec4 g0010 = vec4(gx10.x,gy10.x,gz10.x,gw10.x);
  vec4 g1010 = vec4(gx10.y,gy10.y,gz10.y,gw10.y);
  vec4 g0110 = vec4(gx10.z,gy10.z,gz10.z,gw10.z);
  vec4 g1110 = vec4(gx10.w,gy10.w,gz10.w,gw10.w);
  vec4 g0001 = vec4(gx01.x,gy01.x,gz01.x,gw01.x);
  vec4 g1001 = vec4(gx01.y,gy01.y,gz01.y,gw01.y);
  vec4 g0101 = vec4(gx01.z,gy01.z,gz01.z,gw01.z);
  vec4 g1101 = vec4(gx01.w,gy01.w,gz01.w,gw01.w);
  vec4 g0011 = vec4(gx11.x,gy11.x,gz11.x,gw11.x);
  vec4 g1011 = vec4(gx11.y,gy11.y,gz11.y,gw11.y);
  vec4 g0111 = vec4(gx11.z,gy11.z,gz11.z,gw11.z);
  vec4 g1111 = vec4(gx11.w,gy11.w,gz11.w,gw11.w);

  vec4 norm00 = taylorInvSqrt(vec4(dot(g0000, g0000), dot(g0100, g0100), dot(g1000, g1000), dot(g1100, g1100)));
  g0000 *= norm00.x;
  g0100 *= norm00.y;
  g1000 *= norm00.z;
  g1100 *= norm00.w;

  vec4 norm01 = taylorInvSqrt(vec4(dot(g0001, g0001), dot(g0101, g0101), dot(g1001, g1001), dot(g1101, g1101)));
  g0001 *= norm01.x;
  g0101 *= norm01.y;
  g1001 *= norm01.z;
  g1101 *= norm01.w;

  vec4 norm10 = taylorInvSqrt(vec4(dot(g0010, g0010), dot(g0110, g0110), dot(g1010, g1010), dot(g1110, g1110)));
  g0010 *= norm10.x;
  g0110 *= norm10.y;
  g1010 *= norm10.z;
  g1110 *= norm10.w;

  vec4 norm11 = taylorInvSqrt(vec4(dot(g0011, g0011), dot(g0111, g0111), dot(g1011, g1011), dot(g1111, g1111)));
  g0011 *= norm11.x;
  g0111 *= norm11.y;
  g1011 *= norm11.z;
  g1111 *= norm11.w;

  float n0000 = dot(g0000, Pf0);
  float n1000 = dot(g1000, vec4(Pf1.x, Pf0.yzw));
  float n0100 = dot(g0100, vec4(Pf0.x, Pf1.y, Pf0.zw));
  float n1100 = dot(g1100, vec4(Pf1.xy, Pf0.zw));
  float n0010 = dot(g0010, vec4(Pf0.xy, Pf1.z, Pf0.w));
  float n1010 = dot(g1010, vec4(Pf1.x, Pf0.y, Pf1.z, Pf0.w));
  float n0110 = dot(g0110, vec4(Pf0.x, Pf1.yz, Pf0.w));
  float n1110 = dot(g1110, vec4(Pf1.xyz, Pf0.w));
  float n0001 = dot(g0001, vec4(Pf0.xyz, Pf1.w));
  float n1001 = dot(g1001, vec4(Pf1.x, Pf0.yz, Pf1.w));
  float n0101 = dot(g0101, vec4(Pf0.x, Pf1.y, Pf0.z, Pf1.w));
  float n1101 = dot(g1101, vec4(Pf1.xy, Pf0.z, Pf1.w));
  float n0011 = dot(g0011, vec4(Pf0.xy, Pf1.zw));
  float n1011 = dot(g1011, vec4(Pf1.x, Pf0.y, Pf1.zw));
  float n0111 = dot(g0111, vec4(Pf0.x, Pf1.yzw));
  float n1111 = dot(g1111, Pf1);

  vec4 fade_xyzw = fade(Pf0);
  vec4 n_0w = mix(vec4(n0000, n1000, n0100, n1100), vec4(n0001, n1001, n0101, n1101), fade_xyzw.w);
  vec4 n_1w = mix(vec4(n0010, n1010, n0110, n1110), vec4(n0011, n1011, n0111, n1111), fade_xyzw.w);
  vec4 n_zw = mix(n_0w, n_1w, fade_xyzw.z);
  vec2 n_yzw = mix(n_zw.xy, n_zw.zw, fade_xyzw.y);
  float n_xyzw = mix(n_yzw.x, n_yzw.y, fade_xyzw.x);
  return 2.2 * n_xyzw;
}
`;F.periodicNoise4D=V;const Y=`
//
// Description : Array and textureless GLSL 2D simplex noise function.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float simplexNoise2D(vec2 v)
  {
  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                     -0.577350269189626,  // -1.0 + 2.0 * C.x
                      0.024390243902439); // 1.0 / 41.0
// First corner
  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

// Other corners
  vec2 i1;
  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0
  //i1.y = 1.0 - i1.x;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  // x0 = x0 - 0.0 + 0.0 * C.xx ;
  // x1 = x0 - i1 + 1.0 * C.xx ;
  // x2 = x0 - 1.0 + 2.0 * C.xx ;
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

// Permutations
  i = mod289(i); // Avoid truncation effects in permutation
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
    + i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

// Gradients: 41 points uniformly over a line, mapped onto a diamond.
// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

// Normalise gradients implicitly by scaling m
// Approximation of: m *= inversesqrt( a0*a0 + h*h );
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

// Compute final noise value at P
  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}
`;F.simplexNoise2D=Y;const G=`
//
// Description : Array and textureless GLSL 2D/3D/4D simplex
//               noise functions.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 mod289(vec4 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 permute(vec4 x) {
     return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

float simplexNoise3D(vec3 v)
  {
  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);

// First corner
  vec3 i  = floor(v + dot(v, C.yyy) );
  vec3 x0 =   v - i + dot(i, C.xxx) ;

// Other corners
  vec3 g = step(x0.yzx, x0.xyz);
  vec3 l = 1.0 - g;
  vec3 i1 = min( g.xyz, l.zxy );
  vec3 i2 = max( g.xyz, l.zxy );

  //   x0 = x0 - 0.0 + 0.0 * C.xxx;
  //   x1 = x0 - i1  + 1.0 * C.xxx;
  //   x2 = x0 - i2  + 2.0 * C.xxx;
  //   x3 = x0 - 1.0 + 3.0 * C.xxx;
  vec3 x1 = x0 - i1 + C.xxx;
  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y

// Permutations
  i = mod289(i);
  vec4 p = permute( permute( permute(
             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));

// Gradients: 7x7 points over a square, mapped onto an octahedron.
// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
  float n_ = 0.142857142857; // 1.0/7.0
  vec3  ns = n_ * D.wyz - D.xzx;

  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)

  vec4 x_ = floor(j * ns.z);
  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)

  vec4 x = x_ *ns.x + ns.yyyy;
  vec4 y = y_ *ns.x + ns.yyyy;
  vec4 h = 1.0 - abs(x) - abs(y);

  vec4 b0 = vec4( x.xy, y.xy );
  vec4 b1 = vec4( x.zw, y.zw );

  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;
  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;
  vec4 s0 = floor(b0)*2.0 + 1.0;
  vec4 s1 = floor(b1)*2.0 + 1.0;
  vec4 sh = -step(h, vec4(0.0));

  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;

  vec3 p0 = vec3(a0.xy,h.x);
  vec3 p1 = vec3(a0.zw,h.y);
  vec3 p2 = vec3(a1.xy,h.z);
  vec3 p3 = vec3(a1.zw,h.w);

//Normalise gradients
  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
  p0 *= norm.x;
  p1 *= norm.y;
  p2 *= norm.z;
  p3 *= norm.w;

// Mix final noise value
  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
  m = m * m;
  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                dot(p2,x2), dot(p3,x3) ) );
  }
`;F.simplexNoise3D=G;const H=`
//
// Description : Array and textureless GLSL 2D/3D/4D simplex
//               noise functions.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//

vec4 mod289(vec4 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0; }

float mod289(float x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0; }

vec4 permute(vec4 x) {
     return mod289(((x*34.0)+1.0)*x);
}

float permute(float x) {
     return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

float taylorInvSqrt(float r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

vec4 grad4(float j, vec4 ip)
  {
  const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);
  vec4 p,s;

  p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;
  p.w = 1.5 - dot(abs(p.xyz), ones.xyz);
  s = vec4(lessThan(p, vec4(0.0)));
  p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;

  return p;
  }

// (sqrt(5) - 1)/4 = F4, used once below
#define F4 0.309016994374947451

float simplexNoise4D(vec4 v)
  {
  const vec4  C = vec4( 0.138196601125011,  // (5 - sqrt(5))/20  G4
                        0.276393202250021,  // 2 * G4
                        0.414589803375032,  // 3 * G4
                       -0.447213595499958); // -1 + 4 * G4

// First corner
  vec4 i  = floor(v + dot(v, vec4(F4)) );
  vec4 x0 = v -   i + dot(i, C.xxxx);

// Other corners

// Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)
  vec4 i0;
  vec3 isX = step( x0.yzw, x0.xxx );
  vec3 isYZ = step( x0.zww, x0.yyz );
//  i0.x = dot( isX, vec3( 1.0 ) );
  i0.x = isX.x + isX.y + isX.z;
  i0.yzw = 1.0 - isX;
//  i0.y += dot( isYZ.xy, vec2( 1.0 ) );
  i0.y += isYZ.x + isYZ.y;
  i0.zw += 1.0 - isYZ.xy;
  i0.z += isYZ.z;
  i0.w += 1.0 - isYZ.z;

  // i0 now contains the unique values 0,1,2,3 in each channel
  vec4 i3 = clamp( i0, 0.0, 1.0 );
  vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );
  vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );

  //  x0 = x0 - 0.0 + 0.0 * C.xxxx
  //  x1 = x0 - i1  + 1.0 * C.xxxx
  //  x2 = x0 - i2  + 2.0 * C.xxxx
  //  x3 = x0 - i3  + 3.0 * C.xxxx
  //  x4 = x0 - 1.0 + 4.0 * C.xxxx
  vec4 x1 = x0 - i1 + C.xxxx;
  vec4 x2 = x0 - i2 + C.yyyy;
  vec4 x3 = x0 - i3 + C.zzzz;
  vec4 x4 = x0 + C.wwww;

// Permutations
  i = mod289(i);
  float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);
  vec4 j1 = permute( permute( permute( permute (
             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))
           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))
           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))
           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));

// Gradients: 7x7x6 points over a cube, mapped onto a 4-cross polytope
// 7*7*6 = 294, which is close to the ring size 17*17 = 289.
  vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;

  vec4 p0 = grad4(j0,   ip);
  vec4 p1 = grad4(j1.x, ip);
  vec4 p2 = grad4(j1.y, ip);
  vec4 p3 = grad4(j1.z, ip);
  vec4 p4 = grad4(j1.w, ip);

// Normalise gradients
  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
  p0 *= norm.x;
  p1 *= norm.y;
  p2 *= norm.z;
  p3 *= norm.w;
  p4 *= taylorInvSqrt(dot(p4,p4));

// Mix contributions from the five corners
  vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);
  vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);
  m0 = m0 * m0;
  m1 = m1 * m1;
  return 49.0 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 )))
               + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;

  }
`;F.simplexNoise4D=H},function(h,F){'use strict';const I=`
	vec3 packNormalToRGB(const in vec3 normal) {
	  return normalize(normal) * 0.5 + 0.5;
	}
`;F.a={packNormalToRGB:I}},function(h,F){'use strict';Object.defineProperty(F,'__esModule',{value:!0});const I=`
	vec3 tonemapReinhard(vec3 color) {
	  return color / (color + vec3(1.0));
	}
`;F.tonemapReinhard=I},function(h,F){'use strict';F.a=`
	float transpose(float m) {
	  return m;
	}

	mat2 transpose(mat2 m) {
	  return mat2(m[0][0], m[1][0],
	              m[0][1], m[1][1]);
	}

	mat3 transpose(mat3 m) {
	  return mat3(m[0][0], m[1][0], m[2][0],
	              m[0][1], m[1][1], m[2][1],
	              m[0][2], m[1][2], m[2][2]);
	}

	mat4 transpose(mat4 m) {
	  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],
	              m[0][1], m[1][1], m[2][1], m[3][1],
	              m[0][2], m[1][2], m[2][2], m[3][2],
	              m[0][3], m[1][3], m[2][3], m[3][3]);
	}
`},function(h,F,T){'use strict';var N=T(0),P=T(5);F.a=function(Z,K){if(N.webgl2)return Z;const Q='vertex'===K?H:W;return Q.forEach((J)=>{Z='function'==typeof J.replace?J.replace(Z):Z.replace(J.match,J.replace)}),Z};const O=(Z)=>{return new RegExp(`\\b${Z}\\b`,'gi')},X=(Z)=>{return new RegExp(`${Z}`,'gi')},V=[{match:O('in'),replace:'attribute'},{match:O('out'),replace:'varying'}],Y=[{match:O('in'),replace:'varying'},{match:X('out vec4 outgoingColor;'),replace:''},{match:O('outgoingColor'),replace:'gl_FragColor'},{match:O('texture'),replace:function(Z){const K=/\btexture\b/gi,Q=/\btexture\b/i,J=new RegExp(/texture\(([^)]+)\)/,'i'),$=Z.match(K);let ee='';if(null===$)return Z;for(let ae=0,ie;ae<$.length;ae++){if(ie=Z.match(J)[0],ie){const re=ie.replace('texture(','').split(',')[0];let oe=Z.match(`(.*?) ${re}`,'i')[1];switch(oe=oe.split(' ')[1],oe){case'sampler2D':{ee='texture2D';break}case'samplerCube':{ee='textureCube';break}default:}}Z=Z.replace(Q,ee)}return Z}}],G=[{match:X(P.a),replace:''}],H=[...G,...V],W=[...G,...Y]},function(h,F,T){h.exports=T(35)},function(h,F,T){(function(){'use strict';var I=T(36),N=function(P){this.curves=[],this._3d=!1,!P||(this.curves=P,this._3d=this.curves[0]._3d)};N.prototype={valueOf:function(){return this.toString()},toString:function(){return'['+this.curves.map(function(P){return I.pointsToString(P.points)}).join(', ')+']'},addCurve:function(P){this.curves.push(P),this._3d=this._3d||P._3d},length:function(){return this.curves.map(function(P){return P.length()}).reduce(function(P,O){return P+O})},curve:function(P){return this.curves[P]},bbox:function(){for(var P=this.curves,O=P[0].bbox(),X=1;X<P.length;X++)I.expandbox(O,P[X].bbox());return O},offset:function(P){var O=[];return this.curves.forEach(function(X){O=O.concat(X.offset(P))}),new N(O)}},h.exports=N})()},function(h,F,T){var I=T(6),N={};N.create=function(){var P=new I.ARRAY_TYPE(4);return P[0]=1,P[1]=0,P[2]=0,P[3]=1,P},N.clone=function(P){var O=new I.ARRAY_TYPE(4);return O[0]=P[0],O[1]=P[1],O[2]=P[2],O[3]=P[3],O},N.copy=function(P,O){return P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[3],P},N.identity=function(P){return P[0]=1,P[1]=0,P[2]=0,P[3]=1,P},N.fromValues=function(P,O,X,V){var Y=new I.ARRAY_TYPE(4);return Y[0]=P,Y[1]=O,Y[2]=X,Y[3]=V,Y},N.set=function(P,O,X,V,Y){return P[0]=O,P[1]=X,P[2]=V,P[3]=Y,P},N.transpose=function(P,O){if(P===O){var X=O[1];P[1]=O[2],P[2]=X}else P[0]=O[0],P[1]=O[2],P[2]=O[1],P[3]=O[3];return P},N.invert=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=X*G-Y*V;return H?(H=1/H,P[0]=G*H,P[1]=-V*H,P[2]=-Y*H,P[3]=X*H,P):null},N.adjoint=function(P,O){var X=O[0];return P[0]=O[3],P[1]=-O[1],P[2]=-O[2],P[3]=X,P},N.determinant=function(P){return P[0]*P[3]-P[2]*P[1]},N.multiply=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=X[0],Z=X[1],K=X[2],Q=X[3];return P[0]=V*W+G*Z,P[1]=Y*W+H*Z,P[2]=V*K+G*Q,P[3]=Y*K+H*Q,P},N.mul=N.multiply,N.rotate=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=_Mathsin(X),Z=_Mathcos(X);return P[0]=V*Z+G*W,P[1]=Y*Z+H*W,P[2]=V*-W+G*Z,P[3]=Y*-W+H*Z,P},N.scale=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=X[0],Z=X[1];return P[0]=V*W,P[1]=Y*W,P[2]=G*Z,P[3]=H*Z,P},N.fromRotation=function(P,O){var X=_Mathsin(O),V=_Mathcos(O);return P[0]=V,P[1]=X,P[2]=-X,P[3]=V,P},N.fromScaling=function(P,O){return P[0]=O[0],P[1]=0,P[2]=0,P[3]=O[1],P},N.str=function(P){return'mat2('+P[0]+', '+P[1]+', '+P[2]+', '+P[3]+')'},N.frob=function(P){return _Mathsqrt(_Mathpow(P[0],2)+_Mathpow(P[1],2)+_Mathpow(P[2],2)+_Mathpow(P[3],2))},N.LDU=function(P,O,X,V){return P[2]=V[2]/V[0],X[0]=V[0],X[1]=V[1],X[3]=V[3]-P[2]*X[1],[P,O,X]},N.add=function(P,O,X){return P[0]=O[0]+X[0],P[1]=O[1]+X[1],P[2]=O[2]+X[2],P[3]=O[3]+X[3],P},N.subtract=function(P,O,X){return P[0]=O[0]-X[0],P[1]=O[1]-X[1],P[2]=O[2]-X[2],P[3]=O[3]-X[3],P},N.sub=N.subtract,N.exactEquals=function(P,O){return P[0]===O[0]&&P[1]===O[1]&&P[2]===O[2]&&P[3]===O[3]},N.equals=function(P,O){var X=P[0],V=P[1],Y=P[2],G=P[3],H=O[0],W=O[1],Z=O[2],K=O[3];return _Mathabs(X-H)<=I.EPSILON*_Mathmax(1,_Mathabs(X),_Mathabs(H))&&_Mathabs(V-W)<=I.EPSILON*_Mathmax(1,_Mathabs(V),_Mathabs(W))&&_Mathabs(Y-Z)<=I.EPSILON*_Mathmax(1,_Mathabs(Y),_Mathabs(Z))&&_Mathabs(G-K)<=I.EPSILON*_Mathmax(1,_Mathabs(G),_Mathabs(K))},N.multiplyScalar=function(P,O,X){return P[0]=O[0]*X,P[1]=O[1]*X,P[2]=O[2]*X,P[3]=O[3]*X,P},N.multiplyScalarAndAdd=function(P,O,X,V){return P[0]=O[0]+X[0]*V,P[1]=O[1]+X[1]*V,P[2]=O[2]+X[2]*V,P[3]=O[3]+X[3]*V,P},h.exports=N},function(h,F,T){var I=T(6),N={};N.create=function(){var P=new I.ARRAY_TYPE(6);return P[0]=1,P[1]=0,P[2]=0,P[3]=1,P[4]=0,P[5]=0,P},N.clone=function(P){var O=new I.ARRAY_TYPE(6);return O[0]=P[0],O[1]=P[1],O[2]=P[2],O[3]=P[3],O[4]=P[4],O[5]=P[5],O},N.copy=function(P,O){return P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[3],P[4]=O[4],P[5]=O[5],P},N.identity=function(P){return P[0]=1,P[1]=0,P[2]=0,P[3]=1,P[4]=0,P[5]=0,P},N.fromValues=function(P,O,X,V,Y,G){var H=new I.ARRAY_TYPE(6);return H[0]=P,H[1]=O,H[2]=X,H[3]=V,H[4]=Y,H[5]=G,H},N.set=function(P,O,X,V,Y,G,H){return P[0]=O,P[1]=X,P[2]=V,P[3]=Y,P[4]=G,P[5]=H,P},N.invert=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=O[4],W=O[5],Z=X*G-V*Y;return Z?(Z=1/Z,P[0]=G*Z,P[1]=-V*Z,P[2]=-Y*Z,P[3]=X*Z,P[4]=(Y*W-G*H)*Z,P[5]=(V*H-X*W)*Z,P):null},N.determinant=function(P){return P[0]*P[3]-P[1]*P[2]},N.multiply=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=O[4],Z=O[5],K=X[0],Q=X[1],J=X[2],$=X[3],ee=X[4],ae=X[5];return P[0]=V*K+G*Q,P[1]=Y*K+H*Q,P[2]=V*J+G*$,P[3]=Y*J+H*$,P[4]=V*ee+G*ae+W,P[5]=Y*ee+H*ae+Z,P},N.mul=N.multiply,N.rotate=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=O[4],Z=O[5],K=_Mathsin(X),Q=_Mathcos(X);return P[0]=V*Q+G*K,P[1]=Y*Q+H*K,P[2]=V*-K+G*Q,P[3]=Y*-K+H*Q,P[4]=W,P[5]=Z,P},N.scale=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=O[4],Z=O[5],K=X[0],Q=X[1];return P[0]=V*K,P[1]=Y*K,P[2]=G*Q,P[3]=H*Q,P[4]=W,P[5]=Z,P},N.translate=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=O[4],Z=O[5],K=X[0],Q=X[1];return P[0]=V,P[1]=Y,P[2]=G,P[3]=H,P[4]=V*K+G*Q+W,P[5]=Y*K+H*Q+Z,P},N.fromRotation=function(P,O){var X=_Mathsin(O),V=_Mathcos(O);return P[0]=V,P[1]=X,P[2]=-X,P[3]=V,P[4]=0,P[5]=0,P},N.fromScaling=function(P,O){return P[0]=O[0],P[1]=0,P[2]=0,P[3]=O[1],P[4]=0,P[5]=0,P},N.fromTranslation=function(P,O){return P[0]=1,P[1]=0,P[2]=0,P[3]=1,P[4]=O[0],P[5]=O[1],P},N.str=function(P){return'mat2d('+P[0]+', '+P[1]+', '+P[2]+', '+P[3]+', '+P[4]+', '+P[5]+')'},N.frob=function(P){return _Mathsqrt(_Mathpow(P[0],2)+_Mathpow(P[1],2)+_Mathpow(P[2],2)+_Mathpow(P[3],2)+_Mathpow(P[4],2)+_Mathpow(P[5],2)+1)},N.add=function(P,O,X){return P[0]=O[0]+X[0],P[1]=O[1]+X[1],P[2]=O[2]+X[2],P[3]=O[3]+X[3],P[4]=O[4]+X[4],P[5]=O[5]+X[5],P},N.subtract=function(P,O,X){return P[0]=O[0]-X[0],P[1]=O[1]-X[1],P[2]=O[2]-X[2],P[3]=O[3]-X[3],P[4]=O[4]-X[4],P[5]=O[5]-X[5],P},N.sub=N.subtract,N.multiplyScalar=function(P,O,X){return P[0]=O[0]*X,P[1]=O[1]*X,P[2]=O[2]*X,P[3]=O[3]*X,P[4]=O[4]*X,P[5]=O[5]*X,P},N.multiplyScalarAndAdd=function(P,O,X,V){return P[0]=O[0]+X[0]*V,P[1]=O[1]+X[1]*V,P[2]=O[2]+X[2]*V,P[3]=O[3]+X[3]*V,P[4]=O[4]+X[4]*V,P[5]=O[5]+X[5]*V,P},N.exactEquals=function(P,O){return P[0]===O[0]&&P[1]===O[1]&&P[2]===O[2]&&P[3]===O[3]&&P[4]===O[4]&&P[5]===O[5]},N.equals=function(P,O){var X=P[0],V=P[1],Y=P[2],G=P[3],H=P[4],W=P[5],Z=O[0],K=O[1],Q=O[2],J=O[3],$=O[4],ee=O[5];return _Mathabs(X-Z)<=I.EPSILON*_Mathmax(1,_Mathabs(X),_Mathabs(Z))&&_Mathabs(V-K)<=I.EPSILON*_Mathmax(1,_Mathabs(V),_Mathabs(K))&&_Mathabs(Y-Q)<=I.EPSILON*_Mathmax(1,_Mathabs(Y),_Mathabs(Q))&&_Mathabs(G-J)<=I.EPSILON*_Mathmax(1,_Mathabs(G),_Mathabs(J))&&_Mathabs(H-$)<=I.EPSILON*_Mathmax(1,_Mathabs(H),_Mathabs($))&&_Mathabs(W-ee)<=I.EPSILON*_Mathmax(1,_Mathabs(W),_Mathabs(ee))},h.exports=N},function(h,F,T){var I=T(6),N={scalar:{},SIMD:{}};N.create=function(){var P=new I.ARRAY_TYPE(16);return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},N.clone=function(P){var O=new I.ARRAY_TYPE(16);return O[0]=P[0],O[1]=P[1],O[2]=P[2],O[3]=P[3],O[4]=P[4],O[5]=P[5],O[6]=P[6],O[7]=P[7],O[8]=P[8],O[9]=P[9],O[10]=P[10],O[11]=P[11],O[12]=P[12],O[13]=P[13],O[14]=P[14],O[15]=P[15],O},N.copy=function(P,O){return P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[3],P[4]=O[4],P[5]=O[5],P[6]=O[6],P[7]=O[7],P[8]=O[8],P[9]=O[9],P[10]=O[10],P[11]=O[11],P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15],P},N.fromValues=function(P,O,X,V,Y,G,H,W,Z,K,Q,J,$,ee,ae,ie){var re=new I.ARRAY_TYPE(16);return re[0]=P,re[1]=O,re[2]=X,re[3]=V,re[4]=Y,re[5]=G,re[6]=H,re[7]=W,re[8]=Z,re[9]=K,re[10]=Q,re[11]=J,re[12]=$,re[13]=ee,re[14]=ae,re[15]=ie,re},N.set=function(P,O,X,V,Y,G,H,W,Z,K,Q,J,$,ee,ae,ie,re){return P[0]=O,P[1]=X,P[2]=V,P[3]=Y,P[4]=G,P[5]=H,P[6]=W,P[7]=Z,P[8]=K,P[9]=Q,P[10]=J,P[11]=$,P[12]=ee,P[13]=ae,P[14]=ie,P[15]=re,P},N.identity=function(P){return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},N.scalar.transpose=function(P,O){if(P===O){var X=O[1],V=O[2],Y=O[3],G=O[6],H=O[7],W=O[11];P[1]=O[4],P[2]=O[8],P[3]=O[12],P[4]=X,P[6]=O[9],P[7]=O[13],P[8]=V,P[9]=G,P[11]=O[14],P[12]=Y,P[13]=H,P[14]=W}else P[0]=O[0],P[1]=O[4],P[2]=O[8],P[3]=O[12],P[4]=O[1],P[5]=O[5],P[6]=O[9],P[7]=O[13],P[8]=O[2],P[9]=O[6],P[10]=O[10],P[11]=O[14],P[12]=O[3],P[13]=O[7],P[14]=O[11],P[15]=O[15];return P},N.SIMD.transpose=function(P,O){var X,V,Y,G,H,W,Z,K,Q,J;return X=SIMD.Float32x4.load(O,0),V=SIMD.Float32x4.load(O,4),Y=SIMD.Float32x4.load(O,8),G=SIMD.Float32x4.load(O,12),H=SIMD.Float32x4.shuffle(X,V,0,1,4,5),W=SIMD.Float32x4.shuffle(Y,G,0,1,4,5),Z=SIMD.Float32x4.shuffle(H,W,0,2,4,6),K=SIMD.Float32x4.shuffle(H,W,1,3,5,7),SIMD.Float32x4.store(P,0,Z),SIMD.Float32x4.store(P,4,K),H=SIMD.Float32x4.shuffle(X,V,2,3,6,7),W=SIMD.Float32x4.shuffle(Y,G,2,3,6,7),Q=SIMD.Float32x4.shuffle(H,W,0,2,4,6),J=SIMD.Float32x4.shuffle(H,W,1,3,5,7),SIMD.Float32x4.store(P,8,Q),SIMD.Float32x4.store(P,12,J),P},N.transpose=I.USE_SIMD?N.SIMD.transpose:N.scalar.transpose,N.scalar.invert=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=O[4],W=O[5],Z=O[6],K=O[7],Q=O[8],J=O[9],$=O[10],ee=O[11],ae=O[12],ie=O[13],re=O[14],oe=O[15],ne=X*W-V*H,se=X*Z-Y*H,ue=X*K-G*H,ce=V*Z-Y*W,me=V*K-G*W,xe=Y*K-G*Z,pe=Q*ie-J*ae,ge=Q*re-$*ae,he=Q*oe-ee*ae,ve=J*re-$*ie,Ee=J*oe-ee*ie,_e=$*oe-ee*re,ye=ne*_e-se*Ee+ue*ve+ce*he-me*ge+xe*pe;return ye?(ye=1/ye,P[0]=(W*_e-Z*Ee+K*ve)*ye,P[1]=(Y*Ee-V*_e-G*ve)*ye,P[2]=(ie*xe-re*me+oe*ce)*ye,P[3]=($*me-J*xe-ee*ce)*ye,P[4]=(Z*he-H*_e-K*ge)*ye,P[5]=(X*_e-Y*he+G*ge)*ye,P[6]=(re*ue-ae*xe-oe*se)*ye,P[7]=(Q*xe-$*ue+ee*se)*ye,P[8]=(H*Ee-W*he+K*pe)*ye,P[9]=(V*he-X*Ee-G*pe)*ye,P[10]=(ae*me-ie*ue+oe*ne)*ye,P[11]=(J*ue-Q*me-ee*ne)*ye,P[12]=(W*ge-H*ve-Z*pe)*ye,P[13]=(X*ve-V*ge+Y*pe)*ye,P[14]=(ie*se-ae*ce-re*ne)*ye,P[15]=(Q*ce-J*se+$*ne)*ye,P):null},N.SIMD.invert=function(P,O){var $=SIMD.Float32x4.load(O,0),ee=SIMD.Float32x4.load(O,4),ae=SIMD.Float32x4.load(O,8),ie=SIMD.Float32x4.load(O,12),X,V,Y,G,H,W,Z,K,Q,J;return(H=SIMD.Float32x4.shuffle($,ee,0,1,4,5),V=SIMD.Float32x4.shuffle(ae,ie,0,1,4,5),X=SIMD.Float32x4.shuffle(H,V,0,2,4,6),V=SIMD.Float32x4.shuffle(V,H,1,3,5,7),H=SIMD.Float32x4.shuffle($,ee,2,3,6,7),G=SIMD.Float32x4.shuffle(ae,ie,2,3,6,7),Y=SIMD.Float32x4.shuffle(H,G,0,2,4,6),G=SIMD.Float32x4.shuffle(G,H,1,3,5,7),H=SIMD.Float32x4.mul(Y,G),H=SIMD.Float32x4.swizzle(H,1,0,3,2),W=SIMD.Float32x4.mul(V,H),Z=SIMD.Float32x4.mul(X,H),H=SIMD.Float32x4.swizzle(H,2,3,0,1),W=SIMD.Float32x4.sub(SIMD.Float32x4.mul(V,H),W),Z=SIMD.Float32x4.sub(SIMD.Float32x4.mul(X,H),Z),Z=SIMD.Float32x4.swizzle(Z,2,3,0,1),H=SIMD.Float32x4.mul(V,Y),H=SIMD.Float32x4.swizzle(H,1,0,3,2),W=SIMD.Float32x4.add(SIMD.Float32x4.mul(G,H),W),Q=SIMD.Float32x4.mul(X,H),H=SIMD.Float32x4.swizzle(H,2,3,0,1),W=SIMD.Float32x4.sub(W,SIMD.Float32x4.mul(G,H)),Q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(X,H),Q),Q=SIMD.Float32x4.swizzle(Q,2,3,0,1),H=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(V,2,3,0,1),G),H=SIMD.Float32x4.swizzle(H,1,0,3,2),Y=SIMD.Float32x4.swizzle(Y,2,3,0,1),W=SIMD.Float32x4.add(SIMD.Float32x4.mul(Y,H),W),K=SIMD.Float32x4.mul(X,H),H=SIMD.Float32x4.swizzle(H,2,3,0,1),W=SIMD.Float32x4.sub(W,SIMD.Float32x4.mul(Y,H)),K=SIMD.Float32x4.sub(SIMD.Float32x4.mul(X,H),K),K=SIMD.Float32x4.swizzle(K,2,3,0,1),H=SIMD.Float32x4.mul(X,V),H=SIMD.Float32x4.swizzle(H,1,0,3,2),K=SIMD.Float32x4.add(SIMD.Float32x4.mul(G,H),K),Q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Y,H),Q),H=SIMD.Float32x4.swizzle(H,2,3,0,1),K=SIMD.Float32x4.sub(SIMD.Float32x4.mul(G,H),K),Q=SIMD.Float32x4.sub(Q,SIMD.Float32x4.mul(Y,H)),H=SIMD.Float32x4.mul(X,G),H=SIMD.Float32x4.swizzle(H,1,0,3,2),Z=SIMD.Float32x4.sub(Z,SIMD.Float32x4.mul(Y,H)),K=SIMD.Float32x4.add(SIMD.Float32x4.mul(V,H),K),H=SIMD.Float32x4.swizzle(H,2,3,0,1),Z=SIMD.Float32x4.add(SIMD.Float32x4.mul(Y,H),Z),K=SIMD.Float32x4.sub(K,SIMD.Float32x4.mul(V,H)),H=SIMD.Float32x4.mul(X,Y),H=SIMD.Float32x4.swizzle(H,1,0,3,2),Z=SIMD.Float32x4.add(SIMD.Float32x4.mul(G,H),Z),Q=SIMD.Float32x4.sub(Q,SIMD.Float32x4.mul(V,H)),H=SIMD.Float32x4.swizzle(H,2,3,0,1),Z=SIMD.Float32x4.sub(Z,SIMD.Float32x4.mul(G,H)),Q=SIMD.Float32x4.add(SIMD.Float32x4.mul(V,H),Q),J=SIMD.Float32x4.mul(X,W),J=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(J,2,3,0,1),J),J=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(J,1,0,3,2),J),H=SIMD.Float32x4.reciprocalApproximation(J),J=SIMD.Float32x4.sub(SIMD.Float32x4.add(H,H),SIMD.Float32x4.mul(J,SIMD.Float32x4.mul(H,H))),J=SIMD.Float32x4.swizzle(J,0,0,0,0),!J)?null:(SIMD.Float32x4.store(P,0,SIMD.Float32x4.mul(J,W)),SIMD.Float32x4.store(P,4,SIMD.Float32x4.mul(J,Z)),SIMD.Float32x4.store(P,8,SIMD.Float32x4.mul(J,K)),SIMD.Float32x4.store(P,12,SIMD.Float32x4.mul(J,Q)),P)},N.invert=I.USE_SIMD?N.SIMD.invert:N.scalar.invert,N.scalar.adjoint=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=O[4],W=O[5],Z=O[6],K=O[7],Q=O[8],J=O[9],$=O[10],ee=O[11],ae=O[12],ie=O[13],re=O[14],oe=O[15];return P[0]=W*($*oe-ee*re)-J*(Z*oe-K*re)+ie*(Z*ee-K*$),P[1]=-(V*($*oe-ee*re)-J*(Y*oe-G*re)+ie*(Y*ee-G*$)),P[2]=V*(Z*oe-K*re)-W*(Y*oe-G*re)+ie*(Y*K-G*Z),P[3]=-(V*(Z*ee-K*$)-W*(Y*ee-G*$)+J*(Y*K-G*Z)),P[4]=-(H*($*oe-ee*re)-Q*(Z*oe-K*re)+ae*(Z*ee-K*$)),P[5]=X*($*oe-ee*re)-Q*(Y*oe-G*re)+ae*(Y*ee-G*$),P[6]=-(X*(Z*oe-K*re)-H*(Y*oe-G*re)+ae*(Y*K-G*Z)),P[7]=X*(Z*ee-K*$)-H*(Y*ee-G*$)+Q*(Y*K-G*Z),P[8]=H*(J*oe-ee*ie)-Q*(W*oe-K*ie)+ae*(W*ee-K*J),P[9]=-(X*(J*oe-ee*ie)-Q*(V*oe-G*ie)+ae*(V*ee-G*J)),P[10]=X*(W*oe-K*ie)-H*(V*oe-G*ie)+ae*(V*K-G*W),P[11]=-(X*(W*ee-K*J)-H*(V*ee-G*J)+Q*(V*K-G*W)),P[12]=-(H*(J*re-$*ie)-Q*(W*re-Z*ie)+ae*(W*$-Z*J)),P[13]=X*(J*re-$*ie)-Q*(V*re-Y*ie)+ae*(V*$-Y*J),P[14]=-(X*(W*re-Z*ie)-H*(V*re-Y*ie)+ae*(V*Z-Y*W)),P[15]=X*(W*$-Z*J)-H*(V*$-Y*J)+Q*(V*Z-Y*W),P},N.SIMD.adjoint=function(P,O){var X=SIMD.Float32x4.load(O,0),V=SIMD.Float32x4.load(O,4),Y=SIMD.Float32x4.load(O,8),G=SIMD.Float32x4.load(O,12),X,V,Y,G,H,W,Z,K,Q,J,$,ee,ae;return Q=SIMD.Float32x4.shuffle(X,V,0,1,4,5),W=SIMD.Float32x4.shuffle(Y,G,0,1,4,5),H=SIMD.Float32x4.shuffle(Q,W,0,2,4,6),W=SIMD.Float32x4.shuffle(W,Q,1,3,5,7),Q=SIMD.Float32x4.shuffle(X,V,2,3,6,7),K=SIMD.Float32x4.shuffle(Y,G,2,3,6,7),Z=SIMD.Float32x4.shuffle(Q,K,0,2,4,6),K=SIMD.Float32x4.shuffle(K,Q,1,3,5,7),Q=SIMD.Float32x4.mul(Z,K),Q=SIMD.Float32x4.swizzle(Q,1,0,3,2),J=SIMD.Float32x4.mul(W,Q),$=SIMD.Float32x4.mul(H,Q),Q=SIMD.Float32x4.swizzle(Q,2,3,0,1),J=SIMD.Float32x4.sub(SIMD.Float32x4.mul(W,Q),J),$=SIMD.Float32x4.sub(SIMD.Float32x4.mul(H,Q),$),$=SIMD.Float32x4.swizzle($,2,3,0,1),Q=SIMD.Float32x4.mul(W,Z),Q=SIMD.Float32x4.swizzle(Q,1,0,3,2),J=SIMD.Float32x4.add(SIMD.Float32x4.mul(K,Q),J),ae=SIMD.Float32x4.mul(H,Q),Q=SIMD.Float32x4.swizzle(Q,2,3,0,1),J=SIMD.Float32x4.sub(J,SIMD.Float32x4.mul(K,Q)),ae=SIMD.Float32x4.sub(SIMD.Float32x4.mul(H,Q),ae),ae=SIMD.Float32x4.swizzle(ae,2,3,0,1),Q=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(W,2,3,0,1),K),Q=SIMD.Float32x4.swizzle(Q,1,0,3,2),Z=SIMD.Float32x4.swizzle(Z,2,3,0,1),J=SIMD.Float32x4.add(SIMD.Float32x4.mul(Z,Q),J),ee=SIMD.Float32x4.mul(H,Q),Q=SIMD.Float32x4.swizzle(Q,2,3,0,1),J=SIMD.Float32x4.sub(J,SIMD.Float32x4.mul(Z,Q)),ee=SIMD.Float32x4.sub(SIMD.Float32x4.mul(H,Q),ee),ee=SIMD.Float32x4.swizzle(ee,2,3,0,1),Q=SIMD.Float32x4.mul(H,W),Q=SIMD.Float32x4.swizzle(Q,1,0,3,2),ee=SIMD.Float32x4.add(SIMD.Float32x4.mul(K,Q),ee),ae=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Z,Q),ae),Q=SIMD.Float32x4.swizzle(Q,2,3,0,1),ee=SIMD.Float32x4.sub(SIMD.Float32x4.mul(K,Q),ee),ae=SIMD.Float32x4.sub(ae,SIMD.Float32x4.mul(Z,Q)),Q=SIMD.Float32x4.mul(H,K),Q=SIMD.Float32x4.swizzle(Q,1,0,3,2),$=SIMD.Float32x4.sub($,SIMD.Float32x4.mul(Z,Q)),ee=SIMD.Float32x4.add(SIMD.Float32x4.mul(W,Q),ee),Q=SIMD.Float32x4.swizzle(Q,2,3,0,1),$=SIMD.Float32x4.add(SIMD.Float32x4.mul(Z,Q),$),ee=SIMD.Float32x4.sub(ee,SIMD.Float32x4.mul(W,Q)),Q=SIMD.Float32x4.mul(H,Z),Q=SIMD.Float32x4.swizzle(Q,1,0,3,2),$=SIMD.Float32x4.add(SIMD.Float32x4.mul(K,Q),$),ae=SIMD.Float32x4.sub(ae,SIMD.Float32x4.mul(W,Q)),Q=SIMD.Float32x4.swizzle(Q,2,3,0,1),$=SIMD.Float32x4.sub($,SIMD.Float32x4.mul(K,Q)),ae=SIMD.Float32x4.add(SIMD.Float32x4.mul(W,Q),ae),SIMD.Float32x4.store(P,0,J),SIMD.Float32x4.store(P,4,$),SIMD.Float32x4.store(P,8,ee),SIMD.Float32x4.store(P,12,ae),P},N.adjoint=I.USE_SIMD?N.SIMD.adjoint:N.scalar.adjoint,N.determinant=function(P){var O=P[0],X=P[1],V=P[2],Y=P[3],G=P[4],H=P[5],W=P[6],Z=P[7],K=P[8],Q=P[9],J=P[10],$=P[11],ee=P[12],ae=P[13],ie=P[14],re=P[15];return(O*H-X*G)*(J*re-$*ie)-(O*W-V*G)*(Q*re-$*ae)+(O*Z-Y*G)*(Q*ie-J*ae)+(X*W-V*H)*(K*re-$*ee)-(X*Z-Y*H)*(K*ie-J*ee)+(V*Z-Y*W)*(K*ae-Q*ee)},N.SIMD.multiply=function(P,O,X){var V=SIMD.Float32x4.load(O,0),Y=SIMD.Float32x4.load(O,4),G=SIMD.Float32x4.load(O,8),H=SIMD.Float32x4.load(O,12),W=SIMD.Float32x4.load(X,0),Z=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(W,0,0,0,0),V),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(W,1,1,1,1),Y),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(W,2,2,2,2),G),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(W,3,3,3,3),H))));SIMD.Float32x4.store(P,0,Z);var K=SIMD.Float32x4.load(X,4),Q=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(K,0,0,0,0),V),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(K,1,1,1,1),Y),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(K,2,2,2,2),G),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(K,3,3,3,3),H))));SIMD.Float32x4.store(P,4,Q);var J=SIMD.Float32x4.load(X,8),$=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(J,0,0,0,0),V),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(J,1,1,1,1),Y),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(J,2,2,2,2),G),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(J,3,3,3,3),H))));SIMD.Float32x4.store(P,8,$);var ee=SIMD.Float32x4.load(X,12),ae=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(ee,0,0,0,0),V),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(ee,1,1,1,1),Y),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(ee,2,2,2,2),G),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(ee,3,3,3,3),H))));return SIMD.Float32x4.store(P,12,ae),P},N.scalar.multiply=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=O[4],Z=O[5],K=O[6],Q=O[7],J=O[8],$=O[9],ee=O[10],ae=O[11],ie=O[12],re=O[13],oe=O[14],ne=O[15],se=X[0],ue=X[1],ce=X[2],me=X[3];return P[0]=se*V+ue*W+ce*J+me*ie,P[1]=se*Y+ue*Z+ce*$+me*re,P[2]=se*G+ue*K+ce*ee+me*oe,P[3]=se*H+ue*Q+ce*ae+me*ne,se=X[4],ue=X[5],ce=X[6],me=X[7],P[4]=se*V+ue*W+ce*J+me*ie,P[5]=se*Y+ue*Z+ce*$+me*re,P[6]=se*G+ue*K+ce*ee+me*oe,P[7]=se*H+ue*Q+ce*ae+me*ne,se=X[8],ue=X[9],ce=X[10],me=X[11],P[8]=se*V+ue*W+ce*J+me*ie,P[9]=se*Y+ue*Z+ce*$+me*re,P[10]=se*G+ue*K+ce*ee+me*oe,P[11]=se*H+ue*Q+ce*ae+me*ne,se=X[12],ue=X[13],ce=X[14],me=X[15],P[12]=se*V+ue*W+ce*J+me*ie,P[13]=se*Y+ue*Z+ce*$+me*re,P[14]=se*G+ue*K+ce*ee+me*oe,P[15]=se*H+ue*Q+ce*ae+me*ne,P},N.multiply=I.USE_SIMD?N.SIMD.multiply:N.scalar.multiply,N.mul=N.multiply,N.scalar.translate=function(P,O,X){var V=X[0],Y=X[1],G=X[2],H,W,Z,K,Q,J,$,ee,ae,ie,re,oe;return O===P?(P[12]=O[0]*V+O[4]*Y+O[8]*G+O[12],P[13]=O[1]*V+O[5]*Y+O[9]*G+O[13],P[14]=O[2]*V+O[6]*Y+O[10]*G+O[14],P[15]=O[3]*V+O[7]*Y+O[11]*G+O[15]):(H=O[0],W=O[1],Z=O[2],K=O[3],Q=O[4],J=O[5],$=O[6],ee=O[7],ae=O[8],ie=O[9],re=O[10],oe=O[11],P[0]=H,P[1]=W,P[2]=Z,P[3]=K,P[4]=Q,P[5]=J,P[6]=$,P[7]=ee,P[8]=ae,P[9]=ie,P[10]=re,P[11]=oe,P[12]=H*V+Q*Y+ae*G+O[12],P[13]=W*V+J*Y+ie*G+O[13],P[14]=Z*V+$*Y+re*G+O[14],P[15]=K*V+ee*Y+oe*G+O[15]),P},N.SIMD.translate=function(P,O,X){var V=SIMD.Float32x4.load(O,0),Y=SIMD.Float32x4.load(O,4),G=SIMD.Float32x4.load(O,8),H=SIMD.Float32x4.load(O,12),W=SIMD.Float32x4(X[0],X[1],X[2],0);O!==P&&(P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[3],P[4]=O[4],P[5]=O[5],P[6]=O[6],P[7]=O[7],P[8]=O[8],P[9]=O[9],P[10]=O[10],P[11]=O[11]),V=SIMD.Float32x4.mul(V,SIMD.Float32x4.swizzle(W,0,0,0,0)),Y=SIMD.Float32x4.mul(Y,SIMD.Float32x4.swizzle(W,1,1,1,1)),G=SIMD.Float32x4.mul(G,SIMD.Float32x4.swizzle(W,2,2,2,2));var Z=SIMD.Float32x4.add(V,SIMD.Float32x4.add(Y,SIMD.Float32x4.add(G,H)));return SIMD.Float32x4.store(P,12,Z),P},N.translate=I.USE_SIMD?N.SIMD.translate:N.scalar.translate,N.scalar.scale=function(P,O,X){var V=X[0],Y=X[1],G=X[2];return P[0]=O[0]*V,P[1]=O[1]*V,P[2]=O[2]*V,P[3]=O[3]*V,P[4]=O[4]*Y,P[5]=O[5]*Y,P[6]=O[6]*Y,P[7]=O[7]*Y,P[8]=O[8]*G,P[9]=O[9]*G,P[10]=O[10]*G,P[11]=O[11]*G,P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15],P},N.SIMD.scale=function(P,O,X){var H=SIMD.Float32x4(X[0],X[1],X[2],0),V,Y,G;return V=SIMD.Float32x4.load(O,0),SIMD.Float32x4.store(P,0,SIMD.Float32x4.mul(V,SIMD.Float32x4.swizzle(H,0,0,0,0))),Y=SIMD.Float32x4.load(O,4),SIMD.Float32x4.store(P,4,SIMD.Float32x4.mul(Y,SIMD.Float32x4.swizzle(H,1,1,1,1))),G=SIMD.Float32x4.load(O,8),SIMD.Float32x4.store(P,8,SIMD.Float32x4.mul(G,SIMD.Float32x4.swizzle(H,2,2,2,2))),P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15],P},N.scale=I.USE_SIMD?N.SIMD.scale:N.scalar.scale,N.rotate=function(P,O,X,V){var Y=V[0],G=V[1],H=V[2],W=_Mathsqrt(Y*Y+G*G+H*H),Z,K,Q,J,$,ee,ae,ie,re,oe,ne,se,ue,ce,me,xe,pe,ge,he,ve,Ee,_e,ye,Fe;return _Mathabs(W)<I.EPSILON?null:(W=1/W,Y*=W,G*=W,H*=W,Z=_Mathsin(X),K=_Mathcos(X),Q=1-K,J=O[0],$=O[1],ee=O[2],ae=O[3],ie=O[4],re=O[5],oe=O[6],ne=O[7],se=O[8],ue=O[9],ce=O[10],me=O[11],xe=Y*Y*Q+K,pe=G*Y*Q+H*Z,ge=H*Y*Q-G*Z,he=Y*G*Q-H*Z,ve=G*G*Q+K,Ee=H*G*Q+Y*Z,_e=Y*H*Q+G*Z,ye=G*H*Q-Y*Z,Fe=H*H*Q+K,P[0]=J*xe+ie*pe+se*ge,P[1]=$*xe+re*pe+ue*ge,P[2]=ee*xe+oe*pe+ce*ge,P[3]=ae*xe+ne*pe+me*ge,P[4]=J*he+ie*ve+se*Ee,P[5]=$*he+re*ve+ue*Ee,P[6]=ee*he+oe*ve+ce*Ee,P[7]=ae*he+ne*ve+me*Ee,P[8]=J*_e+ie*ye+se*Fe,P[9]=$*_e+re*ye+ue*Fe,P[10]=ee*_e+oe*ye+ce*Fe,P[11]=ae*_e+ne*ye+me*Fe,O!==P&&(P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15]),P)},N.scalar.rotateX=function(P,O,X){var V=_Mathsin(X),Y=_Mathcos(X),G=O[4],H=O[5],W=O[6],Z=O[7],K=O[8],Q=O[9],J=O[10],$=O[11];return O!==P&&(P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[3],P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15]),P[4]=G*Y+K*V,P[5]=H*Y+Q*V,P[6]=W*Y+J*V,P[7]=Z*Y+$*V,P[8]=K*Y-G*V,P[9]=Q*Y-H*V,P[10]=J*Y-W*V,P[11]=$*Y-Z*V,P},N.SIMD.rotateX=function(P,O,X){var V=SIMD.Float32x4.splat(_Mathsin(X)),Y=SIMD.Float32x4.splat(_Mathcos(X));O!==P&&(P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[3],P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15]);var G=SIMD.Float32x4.load(O,4),H=SIMD.Float32x4.load(O,8);return SIMD.Float32x4.store(P,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(G,Y),SIMD.Float32x4.mul(H,V))),SIMD.Float32x4.store(P,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(H,Y),SIMD.Float32x4.mul(G,V))),P},N.rotateX=I.USE_SIMD?N.SIMD.rotateX:N.scalar.rotateX,N.scalar.rotateY=function(P,O,X){var V=_Mathsin(X),Y=_Mathcos(X),G=O[0],H=O[1],W=O[2],Z=O[3],K=O[8],Q=O[9],J=O[10],$=O[11];return O!==P&&(P[4]=O[4],P[5]=O[5],P[6]=O[6],P[7]=O[7],P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15]),P[0]=G*Y-K*V,P[1]=H*Y-Q*V,P[2]=W*Y-J*V,P[3]=Z*Y-$*V,P[8]=G*V+K*Y,P[9]=H*V+Q*Y,P[10]=W*V+J*Y,P[11]=Z*V+$*Y,P},N.SIMD.rotateY=function(P,O,X){var V=SIMD.Float32x4.splat(_Mathsin(X)),Y=SIMD.Float32x4.splat(_Mathcos(X));O!==P&&(P[4]=O[4],P[5]=O[5],P[6]=O[6],P[7]=O[7],P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15]);var G=SIMD.Float32x4.load(O,0),H=SIMD.Float32x4.load(O,8);return SIMD.Float32x4.store(P,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(G,Y),SIMD.Float32x4.mul(H,V))),SIMD.Float32x4.store(P,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(G,V),SIMD.Float32x4.mul(H,Y))),P},N.rotateY=I.USE_SIMD?N.SIMD.rotateY:N.scalar.rotateY,N.scalar.rotateZ=function(P,O,X){var V=_Mathsin(X),Y=_Mathcos(X),G=O[0],H=O[1],W=O[2],Z=O[3],K=O[4],Q=O[5],J=O[6],$=O[7];return O!==P&&(P[8]=O[8],P[9]=O[9],P[10]=O[10],P[11]=O[11],P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15]),P[0]=G*Y+K*V,P[1]=H*Y+Q*V,P[2]=W*Y+J*V,P[3]=Z*Y+$*V,P[4]=K*Y-G*V,P[5]=Q*Y-H*V,P[6]=J*Y-W*V,P[7]=$*Y-Z*V,P},N.SIMD.rotateZ=function(P,O,X){var V=SIMD.Float32x4.splat(_Mathsin(X)),Y=SIMD.Float32x4.splat(_Mathcos(X));O!==P&&(P[8]=O[8],P[9]=O[9],P[10]=O[10],P[11]=O[11],P[12]=O[12],P[13]=O[13],P[14]=O[14],P[15]=O[15]);var G=SIMD.Float32x4.load(O,0),H=SIMD.Float32x4.load(O,4);return SIMD.Float32x4.store(P,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(G,Y),SIMD.Float32x4.mul(H,V))),SIMD.Float32x4.store(P,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(H,Y),SIMD.Float32x4.mul(G,V))),P},N.rotateZ=I.USE_SIMD?N.SIMD.rotateZ:N.scalar.rotateZ,N.fromTranslation=function(P,O){return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=O[0],P[13]=O[1],P[14]=O[2],P[15]=1,P},N.fromScaling=function(P,O){return P[0]=O[0],P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=O[1],P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=O[2],P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},N.fromRotation=function(P,O,X){var V=X[0],Y=X[1],G=X[2],H=_Mathsqrt(V*V+Y*Y+G*G),W,Z,K;return _Mathabs(H)<I.EPSILON?null:(H=1/H,V*=H,Y*=H,G*=H,W=_Mathsin(O),Z=_Mathcos(O),K=1-Z,P[0]=V*V*K+Z,P[1]=Y*V*K+G*W,P[2]=G*V*K-Y*W,P[3]=0,P[4]=V*Y*K-G*W,P[5]=Y*Y*K+Z,P[6]=G*Y*K+V*W,P[7]=0,P[8]=V*G*K+Y*W,P[9]=Y*G*K-V*W,P[10]=G*G*K+Z,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P)},N.fromXRotation=function(P,O){var X=_Mathsin(O),V=_Mathcos(O);return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=V,P[6]=X,P[7]=0,P[8]=0,P[9]=-X,P[10]=V,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},N.fromYRotation=function(P,O){var X=_Mathsin(O),V=_Mathcos(O);return P[0]=V,P[1]=0,P[2]=-X,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=X,P[9]=0,P[10]=V,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},N.fromZRotation=function(P,O){var X=_Mathsin(O),V=_Mathcos(O);return P[0]=V,P[1]=X,P[2]=0,P[3]=0,P[4]=-X,P[5]=V,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},N.fromRotationTranslation=function(P,O,X){var V=O[0],Y=O[1],G=O[2],H=O[3],W=V+V,Z=Y+Y,K=G+G,Q=V*W,J=V*Z,$=V*K,ee=Y*Z,ae=Y*K,ie=G*K,re=H*W,oe=H*Z,ne=H*K;return P[0]=1-(ee+ie),P[1]=J+ne,P[2]=$-oe,P[3]=0,P[4]=J-ne,P[5]=1-(Q+ie),P[6]=ae+re,P[7]=0,P[8]=$+oe,P[9]=ae-re,P[10]=1-(Q+ee),P[11]=0,P[12]=X[0],P[13]=X[1],P[14]=X[2],P[15]=1,P},N.getTranslation=function(P,O){return P[0]=O[12],P[1]=O[13],P[2]=O[14],P},N.getRotation=function(P,O){var X=O[0]+O[5]+O[10],V=0;return 0<X?(V=2*_Mathsqrt(X+1),P[3]=0.25*V,P[0]=(O[6]-O[9])/V,P[1]=(O[8]-O[2])/V,P[2]=(O[1]-O[4])/V):O[0]>O[5]&O[0]>O[10]?(V=2*_Mathsqrt(1+O[0]-O[5]-O[10]),P[3]=(O[6]-O[9])/V,P[0]=0.25*V,P[1]=(O[1]+O[4])/V,P[2]=(O[8]+O[2])/V):O[5]>O[10]?(V=2*_Mathsqrt(1+O[5]-O[0]-O[10]),P[3]=(O[8]-O[2])/V,P[0]=(O[1]+O[4])/V,P[1]=0.25*V,P[2]=(O[6]+O[9])/V):(V=2*_Mathsqrt(1+O[10]-O[0]-O[5]),P[3]=(O[1]-O[4])/V,P[0]=(O[8]+O[2])/V,P[1]=(O[6]+O[9])/V,P[2]=0.25*V),P},N.fromRotationTranslationScale=function(P,O,X,V){var Y=O[0],G=O[1],H=O[2],W=O[3],Z=Y+Y,K=G+G,Q=H+H,J=Y*Z,$=Y*K,ee=Y*Q,ae=G*K,ie=G*Q,re=H*Q,oe=W*Z,ne=W*K,se=W*Q,ue=V[0],ce=V[1],me=V[2];return P[0]=(1-(ae+re))*ue,P[1]=($+se)*ue,P[2]=(ee-ne)*ue,P[3]=0,P[4]=($-se)*ce,P[5]=(1-(J+re))*ce,P[6]=(ie+oe)*ce,P[7]=0,P[8]=(ee+ne)*me,P[9]=(ie-oe)*me,P[10]=(1-(J+ae))*me,P[11]=0,P[12]=X[0],P[13]=X[1],P[14]=X[2],P[15]=1,P},N.fromRotationTranslationScaleOrigin=function(P,O,X,V,Y){var G=O[0],H=O[1],W=O[2],Z=O[3],K=G+G,Q=H+H,J=W+W,$=G*K,ee=G*Q,ae=G*J,ie=H*Q,re=H*J,oe=W*J,ne=Z*K,se=Z*Q,ue=Z*J,ce=V[0],me=V[1],xe=V[2],pe=Y[0],ge=Y[1],he=Y[2];return P[0]=(1-(ie+oe))*ce,P[1]=(ee+ue)*ce,P[2]=(ae-se)*ce,P[3]=0,P[4]=(ee-ue)*me,P[5]=(1-($+oe))*me,P[6]=(re+ne)*me,P[7]=0,P[8]=(ae+se)*xe,P[9]=(re-ne)*xe,P[10]=(1-($+ie))*xe,P[11]=0,P[12]=X[0]+pe-(P[0]*pe+P[4]*ge+P[8]*he),P[13]=X[1]+ge-(P[1]*pe+P[5]*ge+P[9]*he),P[14]=X[2]+he-(P[2]*pe+P[6]*ge+P[10]*he),P[15]=1,P},N.fromQuat=function(P,O){var X=O[0],V=O[1],Y=O[2],G=O[3],H=X+X,W=V+V,Z=Y+Y,K=X*H,Q=V*H,J=V*W,$=Y*H,ee=Y*W,ae=Y*Z,ie=G*H,re=G*W,oe=G*Z;return P[0]=1-J-ae,P[1]=Q+oe,P[2]=$-re,P[3]=0,P[4]=Q-oe,P[5]=1-K-ae,P[6]=ee+ie,P[7]=0,P[8]=$+re,P[9]=ee-ie,P[10]=1-K-J,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},N.frustum=function(P,O,X,V,Y,G,H){var W=1/(X-O),Z=1/(Y-V),K=1/(G-H);return P[0]=2*G*W,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=2*G*Z,P[6]=0,P[7]=0,P[8]=(X+O)*W,P[9]=(Y+V)*Z,P[10]=(H+G)*K,P[11]=-1,P[12]=0,P[13]=0,P[14]=2*(H*G)*K,P[15]=0,P},N.perspective=function(P,O,X,V,Y){var G=1/_Mathtan(O/2),H=1/(V-Y);return P[0]=G/X,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=G,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=(Y+V)*H,P[11]=-1,P[12]=0,P[13]=0,P[14]=2*Y*V*H,P[15]=0,P},N.perspectiveFromFieldOfView=function(P,O,X,V){var Y=_Mathtan(O.upDegrees*_MathPI/180),G=_Mathtan(O.downDegrees*_MathPI/180),H=_Mathtan(O.leftDegrees*_MathPI/180),W=_Mathtan(O.rightDegrees*_MathPI/180),Z=2/(H+W),K=2/(Y+G);return P[0]=Z,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=K,P[6]=0,P[7]=0,P[8]=-(0.5*((H-W)*Z)),P[9]=0.5*((Y-G)*K),P[10]=V/(X-V),P[11]=-1,P[12]=0,P[13]=0,P[14]=V*X/(X-V),P[15]=0,P},N.ortho=function(P,O,X,V,Y,G,H){var W=1/(O-X),Z=1/(V-Y),K=1/(G-H);return P[0]=-2*W,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=-2*Z,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=2*K,P[11]=0,P[12]=(O+X)*W,P[13]=(Y+V)*Z,P[14]=(H+G)*K,P[15]=1,P},N.lookAt=function(P,O,X,V){var ae=O[0],ie=O[1],re=O[2],oe=V[0],ne=V[1],se=V[2],ue=X[0],ce=X[1],me=X[2],Y,G,H,W,Z,K,Q,J,$,ee;return _Mathabs(ae-ue)<I.EPSILON&&_Mathabs(ie-ce)<I.EPSILON&&_Mathabs(re-me)<I.EPSILON?N.identity(P):(Q=ae-ue,J=ie-ce,$=re-me,ee=1/_Mathsqrt(Q*Q+J*J+$*$),Q*=ee,J*=ee,$*=ee,Y=ne*$-se*J,G=se*Q-oe*$,H=oe*J-ne*Q,ee=_Mathsqrt(Y*Y+G*G+H*H),ee?(ee=1/ee,Y*=ee,G*=ee,H*=ee):(Y=0,G=0,H=0),W=J*H-$*G,Z=$*Y-Q*H,K=Q*G-J*Y,ee=_Mathsqrt(W*W+Z*Z+K*K),ee?(ee=1/ee,W*=ee,Z*=ee,K*=ee):(W=0,Z=0,K=0),P[0]=Y,P[1]=W,P[2]=Q,P[3]=0,P[4]=G,P[5]=Z,P[6]=J,P[7]=0,P[8]=H,P[9]=K,P[10]=$,P[11]=0,P[12]=-(Y*ae+G*ie+H*re),P[13]=-(W*ae+Z*ie+K*re),P[14]=-(Q*ae+J*ie+$*re),P[15]=1,P)},N.str=function(P){return'mat4('+P[0]+', '+P[1]+', '+P[2]+', '+P[3]+', '+P[4]+', '+P[5]+', '+P[6]+', '+P[7]+', '+P[8]+', '+P[9]+', '+P[10]+', '+P[11]+', '+P[12]+', '+P[13]+', '+P[14]+', '+P[15]+')'},N.frob=function(P){return _Mathsqrt(_Mathpow(P[0],2)+_Mathpow(P[1],2)+_Mathpow(P[2],2)+_Mathpow(P[3],2)+_Mathpow(P[4],2)+_Mathpow(P[5],2)+_Mathpow(P[6],2)+_Mathpow(P[7],2)+_Mathpow(P[8],2)+_Mathpow(P[9],2)+_Mathpow(P[10],2)+_Mathpow(P[11],2)+_Mathpow(P[12],2)+_Mathpow(P[13],2)+_Mathpow(P[14],2)+_Mathpow(P[15],2))},N.add=function(P,O,X){return P[0]=O[0]+X[0],P[1]=O[1]+X[1],P[2]=O[2]+X[2],P[3]=O[3]+X[3],P[4]=O[4]+X[4],P[5]=O[5]+X[5],P[6]=O[6]+X[6],P[7]=O[7]+X[7],P[8]=O[8]+X[8],P[9]=O[9]+X[9],P[10]=O[10]+X[10],P[11]=O[11]+X[11],P[12]=O[12]+X[12],P[13]=O[13]+X[13],P[14]=O[14]+X[14],P[15]=O[15]+X[15],P},N.subtract=function(P,O,X){return P[0]=O[0]-X[0],P[1]=O[1]-X[1],P[2]=O[2]-X[2],P[3]=O[3]-X[3],P[4]=O[4]-X[4],P[5]=O[5]-X[5],P[6]=O[6]-X[6],P[7]=O[7]-X[7],P[8]=O[8]-X[8],P[9]=O[9]-X[9],P[10]=O[10]-X[10],P[11]=O[11]-X[11],P[12]=O[12]-X[12],P[13]=O[13]-X[13],P[14]=O[14]-X[14],P[15]=O[15]-X[15],P},N.sub=N.subtract,N.multiplyScalar=function(P,O,X){return P[0]=O[0]*X,P[1]=O[1]*X,P[2]=O[2]*X,P[3]=O[3]*X,P[4]=O[4]*X,P[5]=O[5]*X,P[6]=O[6]*X,P[7]=O[7]*X,P[8]=O[8]*X,P[9]=O[9]*X,P[10]=O[10]*X,P[11]=O[11]*X,P[12]=O[12]*X,P[13]=O[13]*X,P[14]=O[14]*X,P[15]=O[15]*X,P},N.multiplyScalarAndAdd=function(P,O,X,V){return P[0]=O[0]+X[0]*V,P[1]=O[1]+X[1]*V,P[2]=O[2]+X[2]*V,P[3]=O[3]+X[3]*V,P[4]=O[4]+X[4]*V,P[5]=O[5]+X[5]*V,P[6]=O[6]+X[6]*V,P[7]=O[7]+X[7]*V,P[8]=O[8]+X[8]*V,P[9]=O[9]+X[9]*V,P[10]=O[10]+X[10]*V,P[11]=O[11]+X[11]*V,P[12]=O[12]+X[12]*V,P[13]=O[13]+X[13]*V,P[14]=O[14]+X[14]*V,P[15]=O[15]+X[15]*V,P},N.exactEquals=function(P,O){return P[0]===O[0]&&P[1]===O[1]&&P[2]===O[2]&&P[3]===O[3]&&P[4]===O[4]&&P[5]===O[5]&&P[6]===O[6]&&P[7]===O[7]&&P[8]===O[8]&&P[9]===O[9]&&P[10]===O[10]&&P[11]===O[11]&&P[12]===O[12]&&P[13]===O[13]&&P[14]===O[14]&&P[15]===O[15]},N.equals=function(P,O){var X=P[0],V=P[1],Y=P[2],G=P[3],H=P[4],W=P[5],Z=P[6],K=P[7],Q=P[8],J=P[9],$=P[10],ee=P[11],ae=P[12],ie=P[13],re=P[14],oe=P[15],ne=O[0],se=O[1],ue=O[2],ce=O[3],me=O[4],xe=O[5],pe=O[6],ge=O[7],he=O[8],ve=O[9],Ee=O[10],_e=O[11],ye=O[12],Fe=O[13],Te=O[14],Re=O[15];return _Mathabs(X-ne)<=I.EPSILON*_Mathmax(1,_Mathabs(X),_Mathabs(ne))&&_Mathabs(V-se)<=I.EPSILON*_Mathmax(1,_Mathabs(V),_Mathabs(se))&&_Mathabs(Y-ue)<=I.EPSILON*_Mathmax(1,_Mathabs(Y),_Mathabs(ue))&&_Mathabs(G-ce)<=I.EPSILON*_Mathmax(1,_Mathabs(G),_Mathabs(ce))&&_Mathabs(H-me)<=I.EPSILON*_Mathmax(1,_Mathabs(H),_Mathabs(me))&&_Mathabs(W-xe)<=I.EPSILON*_Mathmax(1,_Mathabs(W),_Mathabs(xe))&&_Mathabs(Z-pe)<=I.EPSILON*_Mathmax(1,_Mathabs(Z),_Mathabs(pe))&&_Mathabs(K-ge)<=I.EPSILON*_Mathmax(1,_Mathabs(K),_Mathabs(ge))&&_Mathabs(Q-he)<=I.EPSILON*_Mathmax(1,_Mathabs(Q),_Mathabs(he))&&_Mathabs(J-ve)<=I.EPSILON*_Mathmax(1,_Mathabs(J),_Mathabs(ve))&&_Mathabs($-Ee)<=I.EPSILON*_Mathmax(1,_Mathabs($),_Mathabs(Ee))&&_Mathabs(ee-_e)<=I.EPSILON*_Mathmax(1,_Mathabs(ee),_Mathabs(_e))&&_Mathabs(ae-ye)<=I.EPSILON*_Mathmax(1,_Mathabs(ae),_Mathabs(ye))&&_Mathabs(ie-Fe)<=I.EPSILON*_Mathmax(1,_Mathabs(ie),_Mathabs(Fe))&&_Mathabs(re-Te)<=I.EPSILON*_Mathmax(1,_Mathabs(re),_Mathabs(Te))&&_Mathabs(oe-Re)<=I.EPSILON*_Mathmax(1,_Mathabs(oe),_Mathabs(Re))},h.exports=N},function(h,F,T){var I=T(6),N=T(37),P=T(38),O=T(39),X={};X.create=function(){var V=new I.ARRAY_TYPE(4);return V[0]=0,V[1]=0,V[2]=0,V[3]=1,V},X.rotationTo=function(){var V=P.create(),Y=P.fromValues(1,0,0),G=P.fromValues(0,1,0);return function(H,W,Z){var K=P.dot(W,Z);return-0.999999>K?(P.cross(V,Y,W),1e-6>P.length(V)&&P.cross(V,G,W),P.normalize(V,V),X.setAxisAngle(H,V,Math.PI),H):0.999999<K?(H[0]=0,H[1]=0,H[2]=0,H[3]=1,H):(P.cross(V,W,Z),H[0]=V[0],H[1]=V[1],H[2]=V[2],H[3]=1+K,X.normalize(H,H))}}(),X.setAxes=function(){var V=N.create();return function(Y,G,H,W){return V[0]=H[0],V[3]=H[1],V[6]=H[2],V[1]=W[0],V[4]=W[1],V[7]=W[2],V[2]=-G[0],V[5]=-G[1],V[8]=-G[2],X.normalize(Y,X.fromMat3(Y,V))}}(),X.clone=O.clone,X.fromValues=O.fromValues,X.copy=O.copy,X.set=O.set,X.identity=function(V){return V[0]=0,V[1]=0,V[2]=0,V[3]=1,V},X.setAxisAngle=function(V,Y,G){G*=0.5;var H=_Mathsin(G);return V[0]=H*Y[0],V[1]=H*Y[1],V[2]=H*Y[2],V[3]=_Mathcos(G),V},X.getAxisAngle=function(V,Y){var G=2*_Mathacos(Y[3]),H=_Mathsin(G/2);return 0==H?(V[0]=1,V[1]=0,V[2]=0):(V[0]=Y[0]/H,V[1]=Y[1]/H,V[2]=Y[2]/H),G},X.add=O.add,X.multiply=function(V,Y,G){var H=Y[0],W=Y[1],Z=Y[2],K=Y[3],Q=G[0],J=G[1],$=G[2],ee=G[3];return V[0]=H*ee+K*Q+W*$-Z*J,V[1]=W*ee+K*J+Z*Q-H*$,V[2]=Z*ee+K*$+H*J-W*Q,V[3]=K*ee-H*Q-W*J-Z*$,V},X.mul=X.multiply,X.scale=O.scale,X.rotateX=function(V,Y,G){G*=0.5;var H=Y[0],W=Y[1],Z=Y[2],K=Y[3],Q=_Mathsin(G),J=_Mathcos(G);return V[0]=H*J+K*Q,V[1]=W*J+Z*Q,V[2]=Z*J-W*Q,V[3]=K*J-H*Q,V},X.rotateY=function(V,Y,G){G*=0.5;var H=Y[0],W=Y[1],Z=Y[2],K=Y[3],Q=_Mathsin(G),J=_Mathcos(G);return V[0]=H*J-Z*Q,V[1]=W*J+K*Q,V[2]=Z*J+H*Q,V[3]=K*J-W*Q,V},X.rotateZ=function(V,Y,G){G*=0.5;var H=Y[0],W=Y[1],Z=Y[2],K=Y[3],Q=_Mathsin(G),J=_Mathcos(G);return V[0]=H*J+W*Q,V[1]=W*J-H*Q,V[2]=Z*J+K*Q,V[3]=K*J-Z*Q,V},X.calculateW=function(V,Y){var G=Y[0],H=Y[1],W=Y[2];return V[0]=G,V[1]=H,V[2]=W,V[3]=_Mathsqrt(_Mathabs(1-G*G-H*H-W*W)),V},X.dot=O.dot,X.lerp=O.lerp,X.slerp=function(V,Y,G,H){var W=Y[0],Z=Y[1],K=Y[2],Q=Y[3],J=G[0],$=G[1],ee=G[2],ae=G[3],ie,re,oe,ne,se;return re=W*J+Z*$+K*ee+Q*ae,0>re&&(re=-re,J=-J,$=-$,ee=-ee,ae=-ae),1e-6<1-re?(ie=_Mathacos(re),oe=_Mathsin(ie),ne=_Mathsin((1-H)*ie)/oe,se=_Mathsin(H*ie)/oe):(ne=1-H,se=H),V[0]=ne*W+se*J,V[1]=ne*Z+se*$,V[2]=ne*K+se*ee,V[3]=ne*Q+se*ae,V},X.sqlerp=function(){var V=X.create(),Y=X.create();return function(G,H,W,Z,K,Q){return X.slerp(V,H,K,Q),X.slerp(Y,W,Z,Q),X.slerp(G,V,Y,2*Q*(1-Q)),G}}(),X.invert=function(V,Y){var G=Y[0],H=Y[1],W=Y[2],Z=Y[3],K=G*G+H*H+W*W+Z*Z,Q=K?1/K:0;return V[0]=-G*Q,V[1]=-H*Q,V[2]=-W*Q,V[3]=Z*Q,V},X.conjugate=function(V,Y){return V[0]=-Y[0],V[1]=-Y[1],V[2]=-Y[2],V[3]=Y[3],V},X.length=O.length,X.len=X.length,X.squaredLength=O.squaredLength,X.sqrLen=X.squaredLength,X.normalize=O.normalize,X.fromMat3=function(V,Y){var G=Y[0]+Y[4]+Y[8],H;if(0<G)H=_Mathsqrt(G+1),V[3]=0.5*H,H=0.5/H,V[0]=(Y[5]-Y[7])*H,V[1]=(Y[6]-Y[2])*H,V[2]=(Y[1]-Y[3])*H;else{var W=0;Y[4]>Y[0]&&(W=1),Y[8]>Y[3*W+W]&&(W=2);var Z=(W+1)%3,K=(W+2)%3;H=_Mathsqrt(Y[3*W+W]-Y[3*Z+Z]-Y[3*K+K]+1),V[W]=0.5*H,H=0.5/H,V[3]=(Y[3*Z+K]-Y[3*K+Z])*H,V[Z]=(Y[3*Z+W]+Y[3*W+Z])*H,V[K]=(Y[3*K+W]+Y[3*W+K])*H}return V},X.str=function(V){return'quat('+V[0]+', '+V[1]+', '+V[2]+', '+V[3]+')'},X.exactEquals=O.exactEquals,X.equals=O.equals,h.exports=X},function(h,F,T){var I=T(6),N={};N.create=function(){var P=new I.ARRAY_TYPE(2);return P[0]=0,P[1]=0,P},N.clone=function(P){var O=new I.ARRAY_TYPE(2);return O[0]=P[0],O[1]=P[1],O},N.fromValues=function(P,O){var X=new I.ARRAY_TYPE(2);return X[0]=P,X[1]=O,X},N.copy=function(P,O){return P[0]=O[0],P[1]=O[1],P},N.set=function(P,O,X){return P[0]=O,P[1]=X,P},N.add=function(P,O,X){return P[0]=O[0]+X[0],P[1]=O[1]+X[1],P},N.subtract=function(P,O,X){return P[0]=O[0]-X[0],P[1]=O[1]-X[1],P},N.sub=N.subtract,N.multiply=function(P,O,X){return P[0]=O[0]*X[0],P[1]=O[1]*X[1],P},N.mul=N.multiply,N.divide=function(P,O,X){return P[0]=O[0]/X[0],P[1]=O[1]/X[1],P},N.div=N.divide,N.ceil=function(P,O){return P[0]=_Mathceil(O[0]),P[1]=_Mathceil(O[1]),P},N.floor=function(P,O){return P[0]=_Mathfloor(O[0]),P[1]=_Mathfloor(O[1]),P},N.min=function(P,O,X){return P[0]=_Mathmin(O[0],X[0]),P[1]=_Mathmin(O[1],X[1]),P},N.max=function(P,O,X){return P[0]=_Mathmax(O[0],X[0]),P[1]=_Mathmax(O[1],X[1]),P},N.round=function(P,O){return P[0]=_Mathround(O[0]),P[1]=_Mathround(O[1]),P},N.scale=function(P,O,X){return P[0]=O[0]*X,P[1]=O[1]*X,P},N.scaleAndAdd=function(P,O,X,V){return P[0]=O[0]+X[0]*V,P[1]=O[1]+X[1]*V,P},N.distance=function(P,O){var X=O[0]-P[0],V=O[1]-P[1];return _Mathsqrt(X*X+V*V)},N.dist=N.distance,N.squaredDistance=function(P,O){var X=O[0]-P[0],V=O[1]-P[1];return X*X+V*V},N.sqrDist=N.squaredDistance,N.length=function(P){var O=P[0],X=P[1];return _Mathsqrt(O*O+X*X)},N.len=N.length,N.squaredLength=function(P){var O=P[0],X=P[1];return O*O+X*X},N.sqrLen=N.squaredLength,N.negate=function(P,O){return P[0]=-O[0],P[1]=-O[1],P},N.inverse=function(P,O){return P[0]=1/O[0],P[1]=1/O[1],P},N.normalize=function(P,O){var X=O[0],V=O[1],Y=X*X+V*V;return 0<Y&&(Y=1/_Mathsqrt(Y),P[0]=O[0]*Y,P[1]=O[1]*Y),P},N.dot=function(P,O){return P[0]*O[0]+P[1]*O[1]},N.cross=function(P,O,X){var V=O[0]*X[1]-O[1]*X[0];return P[0]=P[1]=0,P[2]=V,P},N.lerp=function(P,O,X,V){var Y=O[0],G=O[1];return P[0]=Y+V*(X[0]-Y),P[1]=G+V*(X[1]-G),P},N.random=function(P,O){O=O||1;var X=2*I.RANDOM()*_MathPI;return P[0]=_Mathcos(X)*O,P[1]=_Mathsin(X)*O,P},N.transformMat2=function(P,O,X){var V=O[0],Y=O[1];return P[0]=X[0]*V+X[2]*Y,P[1]=X[1]*V+X[3]*Y,P},N.transformMat2d=function(P,O,X){var V=O[0],Y=O[1];return P[0]=X[0]*V+X[2]*Y+X[4],P[1]=X[1]*V+X[3]*Y+X[5],P},N.transformMat3=function(P,O,X){var V=O[0],Y=O[1];return P[0]=X[0]*V+X[3]*Y+X[6],P[1]=X[1]*V+X[4]*Y+X[7],P},N.transformMat4=function(P,O,X){var V=O[0],Y=O[1];return P[0]=X[0]*V+X[4]*Y+X[12],P[1]=X[1]*V+X[5]*Y+X[13],P},N.forEach=function(){var P=N.create();return function(O,X,V,Y,G,H){var W,Z;for(X||(X=2),V||(V=0),Z=Y?_Mathmin(Y*X+V,O.length):O.length,W=V;W<Z;W+=X)P[0]=O[W],P[1]=O[W+1],G(P,P,H),O[W]=P[0],O[W+1]=P[1];return O}}(),N.str=function(P){return'vec2('+P[0]+', '+P[1]+')'},N.exactEquals=function(P,O){return P[0]===O[0]&&P[1]===O[1]},N.equals=function(P,O){var X=P[0],V=P[1],Y=O[0],G=O[1];return _Mathabs(X-Y)<=I.EPSILON*_Mathmax(1,_Mathabs(X),_Mathabs(Y))&&_Mathabs(V-G)<=I.EPSILON*_Mathmax(1,_Mathabs(V),_Mathabs(G))},h.exports=N},function(h){h.exports={name:'ixviii.medium',version:'0.2.0',description:'Personal webgl toolkit.',main:'lib/ixviii.medium.js',scripts:{start:'concurrently \'npm run server\' \'npm run examples:js\' \'npm run examples:html\'',server:'live-server ./examples --port 3000 --quiet --watch ./examples --watch ./src --wait 0','examples:js':'webpack --config webpack.config.examples.js --colors --watch','examples:html':'node ./pug.config.js','examples:build':'webpack --config webpack.config.examples.js --colors; node ./pug.config.js',build:'NODE_ENV=production npm run lint; webpack --config webpack.config.build.js --colors; NODE_ENV=production webpack --config webpack.config.build.js --colors',prepublish:'npm run docs; npm run build','prettier:examples':'prettier --write --single-quote --print-width 80 \'./examples/src/js/**/*.js\'','lint:examples':'eslint --ext .js ./examples/src ./internals --cache','lint:src':'tslint ./src/**/*.ts',lint:'npm run lint:src; npm run lint:examples;',docs:'typedoc --target es6 --tsconfig ./tsconfig.json --ignoreCompilerErrors --theme default --name Medium --out ./docs ./src',precommit:'npm run lint'},repository:{type:'git',url:'https://github.com/amelierosser/medium.git'},author:'Amelie Rosser <amelierosser1986@gmail.com> (https://www.ixviii.io)',license:'MIT',bugs:{url:'https://github.com/amelierosser/medium/issues'},homepage:'https://github.com/amelierosser/medium',devDependencies:{'@types/gl-matrix':'^2.2.34','@types/webgl2':'^0.0.1','babel-cli':'^6.6.5','babel-eslint':'^7.2.3','babel-loader':'^7.0.0','babel-plugin-module-resolver':'^2.7.0','babel-plugin-transform-class-properties':'^6.24.1','babel-preset-env':'^1.4.0','babili-webpack-plugin':'^0.0.11',concurrently:'^3.1.0',eslint:'^3.19.0','eslint-config-airbnb':'^14.1.0','eslint-config-prettier':'^1.7.0','eslint-plugin-compat':'^1.0.2','eslint-plugin-import':'^2.2.0','eslint-plugin-jsx-a11y':'^4.0.0','eslint-plugin-prettier':'^2.0.1','eslint-plugin-react':'^6.10.3','eslint-plugin-redux-saga':'^0.3.0',husky:'^0.13.3',install:'^0.9.6','json-loader':'^0.5.4','live-server':'^1.2.0',prettier:'^1.2.2','pug-cli':'^1.0.0-alpha6','redux-saga':'^0.15.0','ts-loader':'^2.0.1',tslint:'^5.0.0',typedoc:'^0.6.0',typescript:'^2.3.2',webpack:'^2.2.1'},dependencies:{'@types/dat-gui':'^0.6.2','bezier-js':'^2.2.3','dat-gui':'^0.5.0','gl-matrix':'^2.3.2',happens:'^0.6.0','parse-hdr':'^1.0.0','query-string':'^4.3.4',shelljs:'^0.7.7','simplex-noise':'^2.3.0',uuid:'^3.0.1','webgl-obj-loader':'^0.1.1'}}},function(h){function I(H,W,Z,K,Q,J){function $(xe){var pe=0;do xe[pe++]=H[K];while(++K<ce&&pe<xe.length);return pe}function ee(xe,pe,ge){var he=0;do xe[pe+he++]=H[K];while(++K<ce&&he<ge);return he}function ae(xe,pe,ge,he){var ve=4*he,Ee=ee(pe,ge,ve);if(Ee<ve)throw new Error('Error reading raw pixels: got '+Ee+' bytes, expected '+ve)}for(var ie=[,,,,],re=null,ue=[,,],ce=H.length,oe,ne,se;0<J;){if($(ie)<ie.length)throw new Error('Error reading bytes: expected '+ie.length);if(2!=ie[0]||2!=ie[1]||0!=(128&ie[2]))return W[Z++]=ie[0],W[Z++]=ie[1],W[Z++]=ie[2],W[Z++]=ie[3],void ae(H,W,Z,Q*J-1);if(((255&ie[2])<<8|255&ie[3])!=Q)throw new Error('Wrong scanline width '+((255&ie[2])<<8|255&ie[3])+', expected '+Q);null==re&&(re=Array(4*Q)),oe=0;for(var me=0;4>me;me++)for(ne=(me+1)*Q;oe<ne;){if($(ue)<ue.length)throw new Error('Error reading 2-byte buffer');if(128<(255&ue[0])){if(se=(255&ue[0])-128,0==se||se>ne-oe)throw new Error('Bad scanline data');for(;0<se--;)re[oe++]=ue[1]}else{if(se=255&ue[0],0==se||se>ne-oe)throw new Error('Bad scanline data');if(re[oe++]=ue[1],0<--se){if(ee(re,oe,se)<se)throw new Error('Error reading non-run data');oe+=se}}}for(var me=0;me<Q;me++)W[Z+0]=re[me],W[Z+1]=re[me+Q],W[Z+2]=re[me+2*Q],W[Z+3]=re[me+3*Q],Z+=4;J--}}h.exports=function(H){function W(){var ye='';do{var Fe=H[Z];if(Fe==Q){++Z;break}ye+=String.fromCharCode(Fe)}while(++Z<K);return ye}H instanceof ArrayBuffer&&(H=new Uint8Array(H));for(var Z=0,K=H.length,Q=10,J=0,$=0,ee=1,ae=1,ie=!1,re=0;20>re;re++){var oe=W(),ne;if(ne=oe.match('#\\?RADIANCE'));else if(ne=oe.match('FORMAT=32-bit_rle_rgbe'))ie=!0;else if(ne=oe.match('EXPOSURE=\\s*([0-9]*[.][0-9]*)'))ee=+ne[1];else if(ne=oe.match('#.*'));else if(ne=oe.match('-Y ([0-9]+) \\+X ([0-9]+)')){$=+ne[1],J=+ne[2];break}}if(!ie)throw new Error('File is not run length encoded!');var se=new Uint8Array(4*(J*$)),ue=J,ce=$;I(H,se,0,Z,ue,ce);for(var me=new Float32Array(4*(J*$)),xe=0;xe<se.length;xe+=4){var pe=se[xe+0]/255,ge=se[xe+1]/255,he=se[xe+2]/255,ve=se[xe+3],Ee=_Mathpow(2,ve-128);pe*=Ee,ge*=Ee,he*=Ee;var _e=xe;me[_e+0]=pe,me[_e+1]=ge,me[_e+2]=he,me[_e+3]=1}return{shape:[J,$],exposure:ee,gamma:ae,data:me}}},function(h){for(var I=[],N=0;256>N;++N)I[N]=(N+256).toString(16).substr(1);h.exports=function(P,O){var X=O||0,V=I;return V[P[X++]]+V[P[X++]]+V[P[X++]]+V[P[X++]]+'-'+V[P[X++]]+V[P[X++]]+'-'+V[P[X++]]+V[P[X++]]+'-'+V[P[X++]]+V[P[X++]]+'-'+V[P[X++]]+V[P[X++]]+V[P[X++]]+V[P[X++]]+V[P[X++]]+V[P[X++]]}},function(h,F,T){(function(I){var N,P=I.crypto||I.msCrypto;if(P&&P.getRandomValues){var O=new Uint8Array(16);N=function(){return P.getRandomValues(O),O}}if(!N){var X=Array(16);N=function(){for(var V=0,Y;16>V;V++)0==(3&V)&&(Y=4294967296*Math.random()),X[V]=255&Y>>>((3&V)<<3);return X}}h.exports=N}).call(F,T(93))},function(h,F,T){var N=T(90),P=T(89),O=N(),X=[1|O[0],O[1],O[2],O[3],O[4],O[5]],V=16383&(O[6]<<8|O[7]),Y=0,G=0;h.exports=function(H,W,Z){var K=W&&Z||0,Q=W||[];H=H||{};var J=void 0===H.clockseq?V:H.clockseq,$=void 0===H.msecs?new Date().getTime():H.msecs,ee=void 0===H.nsecs?G+1:H.nsecs,ae=$-Y+(ee-G)/1e4;if(0>ae&&void 0===H.clockseq&&(J=16383&J+1),(0>ae||$>Y)&&void 0===H.nsecs&&(ee=0),1e4<=ee)throw new Error('uuid.v1(): Can\'t create more than 10M uuids/sec');Y=$,G=ee,V=J,$+=1.22192928e13;var ie=(1e4*(268435455&$)+ee)%4294967296;Q[K++]=255&ie>>>24,Q[K++]=255&ie>>>16,Q[K++]=255&ie>>>8,Q[K++]=255&ie;var re=268435455&1e4*($/4294967296);Q[K++]=255&re>>>8,Q[K++]=255&re,Q[K++]=16|15&re>>>24,Q[K++]=255&re>>>16,Q[K++]=128|J>>>8,Q[K++]=255&J;for(var oe=H.node||X,ne=0;6>ne;++ne)Q[K+ne]=oe[ne];return W?W:P(Q)}},function(h){(function(I){'use strict';var N={};h.exports=N,N.Mesh=function(X){var V=[],Y=[],G=[],H={};H.verts=[],H.norms=[],H.textures=[],H.hashindices={},H.indices=[],H.index=0;for(var W=X.split('\n'),Z=/^v\s/,K=/^vn\s/,Q=/^vt\s/,J=/^f\s/,$=/\s+/,ee=0;ee<W.length;ee++){var ae=W[ee].trim(),ie=ae.split($);if(ie.shift(),Z.test(ae))V.push.apply(V,ie);else if(K.test(ae))Y.push.apply(Y,ie);else if(Q.test(ae))G.push.apply(G,ie);else if(J.test(ae))for(var re=!1,oe=0,ne=ie.length;oe<ne;oe++){if(3!==oe||re||(oe=2,re=!0),ie[oe]in H.hashindices)H.indices.push(H.hashindices[ie[oe]]);else{var se=ie[oe].split('/');H.verts.push(+V[3*(se[0]-1)+0]),H.verts.push(+V[3*(se[0]-1)+1]),H.verts.push(+V[3*(se[0]-1)+2]),G.length&&(H.textures.push(+G[2*(se[1]-1)+0]),H.textures.push(+G[2*(se[1]-1)+1])),H.norms.push(+Y[3*(se[2]-1)+0]),H.norms.push(+Y[3*(se[2]-1)+1]),H.norms.push(+Y[3*(se[2]-1)+2]),H.hashindices[ie[oe]]=H.index,H.indices.push(H.index),H.index+=1}3===oe&&re&&H.indices.push(H.hashindices[ie[0]])}}this.vertices=H.verts,this.vertexNormals=H.norms,this.textures=H.textures,this.indices=H.indices};var P=function(){var X=this;this.xmlhttp=new XMLHttpRequest,this.get=function(V,Y){X.xmlhttp.onreadystatechange=function(){4===X.xmlhttp.readyState&&Y(X.xmlhttp.responseText,X.xmlhttp.status)},X.xmlhttp.open('GET',V,!0),X.xmlhttp.send()}};N.downloadMeshes=function(X,V,Y){var G=Object.keys(X).length,H=!1;for(var W in Y===I&&(Y={}),X)X.hasOwnProperty(W)&&new P().get(X[W],function(Z){return function(K,Q){if(200===Q?Y[Z]=new N.Mesh(K):(H=!0,console.error('An error has occurred and the mesh "'+Z+'" could not be downloaded.')),G--,0===G){if(H)throw console.error('An error has occurred and one or meshes has not been downloaded. The execution of the script has terminated.'),'';V(Y)}}}(W))};var O=function(X,V,Y,G){var H=X.createBuffer(),W=V===X.ARRAY_BUFFER?Float32Array:Uint16Array;return X.bindBuffer(V,H),X.bufferData(V,new W(Y),X.STATIC_DRAW),H.itemSize=G,H.numItems=Y.length/G,H};N.initMeshBuffers=function(X,V){V.normalBuffer=O(X,X.ARRAY_BUFFER,V.vertexNormals,3),V.textureBuffer=O(X,X.ARRAY_BUFFER,V.textures,2),V.vertexBuffer=O(X,X.ARRAY_BUFFER,V.vertices,3),V.indexBuffer=O(X,X.ELEMENT_ARRAY_BUFFER,V.indices,1)},N.deleteMeshBuffers=function(X,V){X.deleteBuffer(V.normalBuffer),X.deleteBuffer(V.textureBuffer),X.deleteBuffer(V.vertexBuffer),X.deleteBuffer(V.indexBuffer)}})()},function(h){var T=function(){return this}();try{T=T||Function('return this')()||(1,eval)('this')}catch(I){'object'==typeof window&&(T=window)}h.exports=T}]);